var e=Object.defineProperty,s=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,t=(s,a,l)=>a in s?e(s,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):s[a]=l,o=(e,o)=>{for(var r in o||(o={}))a.call(o,r)&&t(e,r,o[r]);if(s)for(var r of s(o))l.call(o,r)&&t(e,r,o[r]);return e},r=(e,s,a)=>new Promise((l,t)=>{var o=e=>{try{n(a.next(e))}catch(s){t(s)}},r=e=>{try{n(a.throw(e))}catch(s){t(s)}},n=e=>e.done?l(e.value):Promise.resolve(e.value).then(o,r);n((a=a.apply(e,s)).next())});import{y as n}from"./api-BHu6TLr6.js";import{z as i,Z as d,b as u,w as c,A as m,C as p,X as b,L as f,M as _,al as y,Q as g,P as v,B as h,aF as k,R as x,a8 as w,u as q,ag as S,r as U,l as j,S as C,F as O,J as V,O as I,aG as P,aH as D,aI as E,aJ as F,aK as R}from"./vue-BMWQU0Ry.js";import{_ as B}from"./page-aianalysisenhanced.vue-9uq21fmn.js";const L={class:"company-info-form"},T={class:"form-grid"},A={class:"form-group"},$={key:0,class:"form-error"},J={class:"form-group"},M={key:0,class:"form-error"},Y={class:"form-group"},G={key:0,class:"form-error"},z={class:"form-group"},H={key:0,class:"form-error"},K={class:"form-group"},N={key:0,class:"form-error"},Q={class:"form-group"},X={key:0,class:"form-error"},Z={class:"form-group full-width"},W={key:0,class:"form-error"},ee={class:"form-actions"},se=["disabled"],ae=["disabled"],le={key:0,class:"loading-spinner"},te=B(i({__name:"CompanyInfoForm",props:{companyInfo:{},loading:{type:Boolean,default:!1}},emits:["update"],setup(e,{emit:s}){const a=e,l=s,t=d({name:"",address:"",phone:"",email:"",website:"",logo_url:"",tax_number:""}),r=d({}),n=u(()=>t.name.trim().length>0&&0===Object.keys(r).length),i=()=>{a.companyInfo&&Object.assign(t,{name:a.companyInfo.name||"",address:a.companyInfo.address||"",phone:a.companyInfo.phone||"",email:a.companyInfo.email||"",website:a.companyInfo.website||"",logo_url:a.companyInfo.logo_url||"",tax_number:a.companyInfo.tax_number||""})},k=(e,s)=>{switch(e){case"name":s.trim()?s.length>200?r[e]="公司名称不能超过200个字符":delete r[e]:r[e]="公司名称不能为空";break;case"email":s&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s)?r[e]="请输入有效的邮箱地址":delete r[e];break;case"website":case"logo_url":s&&!/^https?:\/\/.+\..+/.test(s)?r[e]="请输入有效的URL地址":delete r[e];break;case"phone":s&&s.length>50?r[e]="电话号码不能超过50个字符":delete r[e];break;case"tax_number":s&&s.length>100?r[e]="税号不能超过100个字符":delete r[e];break;default:delete r[e]}};c(()=>t.name,e=>k("name",e)),c(()=>t.email,e=>k("email",e)),c(()=>t.website,e=>k("website",e)),c(()=>t.logo_url,e=>k("logo_url",e)),c(()=>t.phone,e=>k("phone",e)),c(()=>t.tax_number,e=>k("tax_number",e)),c(()=>a.companyInfo,()=>{i()},{immediate:!0,deep:!0});const x=()=>{Object.keys(t).forEach(e=>{k(e,t[e])}),n.value&&l("update",o({},t))},w=()=>{i(),Object.keys(r).forEach(e=>{delete r[e]})};return(e,s)=>(h(),m("div",L,[s[14]||(s[14]=p("h3",{class:"form-title"},"公司信息",-1)),s[15]||(s[15]=p("p",{class:"form-description"}," 配置公司基本信息，这些信息将显示在报价单和其他文档中。 ",-1)),p("form",{onSubmit:b(x,["prevent"]),class:"form"},[p("div",T,[p("div",A,[s[7]||(s[7]=p("label",{for:"company-name",class:"form-label required"}," 公司名称 ",-1)),f(p("input",{id:"company-name","onUpdate:modelValue":s[0]||(s[0]=e=>t.name=e),type:"text",required:"",class:"form-input",placeholder:"请输入公司名称"},null,512),[[y,t.name]]),r.name?(h(),m("div",$,g(r.name),1)):_("",!0)]),p("div",J,[s[8]||(s[8]=p("label",{for:"company-email",class:"form-label"}," 公司邮箱 ",-1)),f(p("input",{id:"company-email","onUpdate:modelValue":s[1]||(s[1]=e=>t.email=e),type:"email",class:"form-input",placeholder:"请输入公司邮箱"},null,512),[[y,t.email]]),r.email?(h(),m("div",M,g(r.email),1)):_("",!0)]),p("div",Y,[s[9]||(s[9]=p("label",{for:"company-phone",class:"form-label"}," 联系电话 ",-1)),f(p("input",{id:"company-phone","onUpdate:modelValue":s[2]||(s[2]=e=>t.phone=e),type:"tel",class:"form-input",placeholder:"请输入联系电话"},null,512),[[y,t.phone]]),r.phone?(h(),m("div",G,g(r.phone),1)):_("",!0)]),p("div",z,[s[10]||(s[10]=p("label",{for:"company-website",class:"form-label"}," 公司网站 ",-1)),f(p("input",{id:"company-website","onUpdate:modelValue":s[3]||(s[3]=e=>t.website=e),type:"url",class:"form-input",placeholder:"https://www.example.com"},null,512),[[y,t.website]]),r.website?(h(),m("div",H,g(r.website),1)):_("",!0)]),p("div",K,[s[11]||(s[11]=p("label",{for:"tax-number",class:"form-label"}," 税号 ",-1)),f(p("input",{id:"tax-number","onUpdate:modelValue":s[4]||(s[4]=e=>t.tax_number=e),type:"text",class:"form-input",placeholder:"请输入税号"},null,512),[[y,t.tax_number]]),r.tax_number?(h(),m("div",N,g(r.tax_number),1)):_("",!0)]),p("div",Q,[s[12]||(s[12]=p("label",{for:"logo-url",class:"form-label"}," 公司Logo URL ",-1)),f(p("input",{id:"logo-url","onUpdate:modelValue":s[5]||(s[5]=e=>t.logo_url=e),type:"url",class:"form-input",placeholder:"https://www.example.com/logo.png"},null,512),[[y,t.logo_url]]),r.logo_url?(h(),m("div",X,g(r.logo_url),1)):_("",!0)])]),p("div",Z,[s[13]||(s[13]=p("label",{for:"company-address",class:"form-label"}," 公司地址 ",-1)),f(p("textarea",{id:"company-address","onUpdate:modelValue":s[6]||(s[6]=e=>t.address=e),rows:"3",class:"form-textarea",placeholder:"请输入完整的公司地址"},null,512),[[y,t.address]]),r.address?(h(),m("div",W,g(r.address),1)):_("",!0)]),p("div",ee,[p("button",{type:"button",onClick:w,disabled:e.loading,class:"reset-button"}," 重置 ",8,se),p("button",{type:"submit",disabled:e.loading||!n.value,class:"submit-button"},[e.loading?(h(),m("span",le)):_("",!0),v(" "+g(e.loading?"保存中...":"保存更改"),1)],8,ae)])],32)]))}}),[["__scopeId","data-v-6328706b"]]),oe=[{code:"USD",name:"US Dollar",symbol:"$"},{code:"EUR",name:"Euro",symbol:"€"},{code:"GBP",name:"British Pound",symbol:"£"},{code:"JPY",name:"Japanese Yen",symbol:"¥"},{code:"CNY",name:"Chinese Yuan",symbol:"¥"},{code:"CAD",name:"Canadian Dollar",symbol:"C$"},{code:"AUD",name:"Australian Dollar",symbol:"A$"}],re={class:"system-config-form"},ne={class:"form-grid"},ie={class:"form-group"},de=["value"],ue={key:0,class:"form-error"},ce={class:"form-group"},me={key:0,class:"form-error"},pe={class:"form-group"},be={key:0,class:"form-error"},fe={class:"form-actions"},_e=["disabled"],ye=["disabled"],ge={key:0,class:"loading-spinner"},ve=B(i({__name:"SystemConfigForm",props:{systemConfig:{},loading:{type:Boolean,default:!1}},emits:["update"],setup(e,{emit:s}){const a=e,l=s,t=oe,r=d({default_currency:"USD",default_tax_rate:0,quote_validity_days:30}),n=d({}),i=u(()=>r.default_currency&&r.quote_validity_days>0&&0===Object.keys(n).length),S=()=>{a.systemConfig&&Object.assign(r,{default_currency:a.systemConfig.default_currency||"USD",default_tax_rate:a.systemConfig.default_tax_rate||0,quote_validity_days:a.systemConfig.quote_validity_days||30})},U=(e,s)=>{switch(e){case"default_currency":s?delete n[e]:n[e]="请选择默认货币";break;case"default_tax_rate":s<0||s>100?n[e]="税率必须在0-100之间":delete n[e];break;case"quote_validity_days":!s||s<1||s>365?n[e]="有效期必须在1-365天之间":delete n[e];break;default:delete n[e]}};c(()=>r.default_currency,e=>U("default_currency",e)),c(()=>r.default_tax_rate,e=>U("default_tax_rate",e)),c(()=>r.quote_validity_days,e=>U("quote_validity_days",e)),c(()=>a.systemConfig,()=>{S()},{immediate:!0,deep:!0});const j=()=>{Object.keys(r).forEach(e=>{U(e,r[e])}),i.value&&l("update",o({},r))},C=()=>{S(),Object.keys(n).forEach(e=>{delete n[e]})};return(e,s)=>(h(),m("div",re,[s[6]||(s[6]=p("h3",{class:"form-title"},"系统配置",-1)),s[7]||(s[7]=p("p",{class:"form-description"}," 配置系统的基本参数，包括默认货币、税率等。 ",-1)),p("form",{onSubmit:b(j,["prevent"]),class:"form"},[p("div",ne,[p("div",ie,[s[3]||(s[3]=p("label",{for:"default-currency",class:"form-label required"}," 默认货币 ",-1)),f(p("select",{id:"default-currency","onUpdate:modelValue":s[0]||(s[0]=e=>r.default_currency=e),required:"",class:"form-select"},[(h(!0),m(x,null,w(q(t),e=>(h(),m("option",{key:e.code,value:e.code},g(e.code)+" - "+g(e.name)+" ("+g(e.symbol)+") ",9,de))),128))],512),[[k,r.default_currency]]),n.default_currency?(h(),m("div",ue,g(n.default_currency),1)):_("",!0)]),p("div",ce,[s[4]||(s[4]=p("label",{for:"default-tax-rate",class:"form-label"}," 默认税率 (%) ",-1)),f(p("input",{id:"default-tax-rate","onUpdate:modelValue":s[1]||(s[1]=e=>r.default_tax_rate=e),type:"number",min:"0",max:"100",step:"0.01",class:"form-input",placeholder:"0.00"},null,512),[[y,r.default_tax_rate,void 0,{number:!0}]]),n.default_tax_rate?(h(),m("div",me,g(n.default_tax_rate),1)):_("",!0)]),p("div",pe,[s[5]||(s[5]=p("label",{for:"quote-validity-days",class:"form-label required"}," 报价单有效期 (天) ",-1)),f(p("input",{id:"quote-validity-days","onUpdate:modelValue":s[2]||(s[2]=e=>r.quote_validity_days=e),type:"number",min:"1",max:"365",required:"",class:"form-input",placeholder:"30"},null,512),[[y,r.quote_validity_days,void 0,{number:!0}]]),n.quote_validity_days?(h(),m("div",be,g(n.quote_validity_days),1)):_("",!0)])]),p("div",fe,[p("button",{type:"button",onClick:C,disabled:e.loading,class:"reset-button"}," 重置 ",8,_e),p("button",{type:"submit",disabled:e.loading||!i.value,class:"submit-button"},[e.loading?(h(),m("span",ge)):_("",!0),v(" "+g(e.loading?"保存中...":"保存更改"),1)],8,ye)])],32)]))}}),[["__scopeId","data-v-049249cb"]]),he={class:"pdf-settings-form"},ke={class:"form-grid"},xe={class:"form-group"},we={class:"color-input-wrapper"},qe={key:0,class:"form-error"},Se={class:"form-group"},Ue={class:"checkbox-wrapper"},je={class:"form-group full-width"},Ce={key:0,class:"form-error"},Oe={class:"form-actions"},Ve=["disabled"],Ie=["disabled"],Pe={key:0,class:"loading-spinner"},De=B(i({__name:"PDFSettingsForm",props:{pdfSettings:{},loading:{type:Boolean,default:!1}},emits:["update"],setup(e,{emit:s}){const a=e,l=s,t=d({header_color:"#2563eb",footer_text:"",show_logo:!0}),r=d({}),n=u(()=>t.header_color&&0===Object.keys(r).length),i=()=>{var e;a.pdfSettings&&Object.assign(t,{header_color:a.pdfSettings.header_color||"#2563eb",footer_text:a.pdfSettings.footer_text||"",show_logo:null==(e=a.pdfSettings.show_logo)||e})},k=(e,s)=>{"header_color"===e?s?/^#[0-9A-Fa-f]{6}$/.test(s)?delete r[e]:r[e]="请输入有效的颜色代码":r[e]="请选择标题颜色":delete r[e]};c(()=>t.header_color,e=>k("header_color",e)),c(()=>a.pdfSettings,()=>{i()},{immediate:!0,deep:!0});const x=()=>{k("header_color",t.header_color),n.value&&l("update",o({},t))},w=()=>{i(),Object.keys(r).forEach(e=>{delete r[e]})};return(e,s)=>(h(),m("div",he,[s[8]||(s[8]=p("h3",{class:"form-title"},"PDF设置",-1)),s[9]||(s[9]=p("p",{class:"form-description"}," 配置PDF文档的样式和显示选项。 ",-1)),p("form",{onSubmit:b(x,["prevent"]),class:"form"},[p("div",ke,[p("div",xe,[s[4]||(s[4]=p("label",{for:"header-color",class:"form-label required"}," 标题颜色 ",-1)),p("div",we,[f(p("input",{id:"header-color","onUpdate:modelValue":s[0]||(s[0]=e=>t.header_color=e),type:"color",required:"",class:"form-color-input"},null,512),[[y,t.header_color]]),f(p("input",{"onUpdate:modelValue":s[1]||(s[1]=e=>t.header_color=e),type:"text",class:"form-input color-text-input",placeholder:"#2563eb"},null,512),[[y,t.header_color]])]),r.header_color?(h(),m("div",qe,g(r.header_color),1)):_("",!0)]),p("div",Se,[s[6]||(s[6]=p("label",{class:"form-label"}," 显示Logo ",-1)),p("div",Ue,[f(p("input",{id:"show-logo","onUpdate:modelValue":s[2]||(s[2]=e=>t.show_logo=e),type:"checkbox",class:"form-checkbox"},null,512),[[S,t.show_logo]]),s[5]||(s[5]=p("label",{for:"show-logo",class:"checkbox-label"}," 在PDF中显示公司Logo ",-1))])])]),p("div",je,[s[7]||(s[7]=p("label",{for:"footer-text",class:"form-label"}," 页脚文本 ",-1)),f(p("textarea",{id:"footer-text","onUpdate:modelValue":s[3]||(s[3]=e=>t.footer_text=e),rows:"3",class:"form-textarea",placeholder:"请输入页脚文本（可选）"},null,512),[[y,t.footer_text]]),r.footer_text?(h(),m("div",Ce,g(r.footer_text),1)):_("",!0)]),p("div",Oe,[p("button",{type:"button",onClick:w,disabled:e.loading,class:"reset-button"}," 重置 ",8,Ve),p("button",{type:"submit",disabled:e.loading||!n.value,class:"submit-button"},[e.loading?(h(),m("span",Pe)):_("",!0),v(" "+g(e.loading?"保存中...":"保存更改"),1)],8,Ie)])],32)]))}}),[["__scopeId","data-v-a5c73096"]]),Ee={class:"email-settings-form"},Fe={class:"form-group full-width"},Re={class:"checkbox-wrapper"},Be={key:0,class:"smtp-config"},Le={class:"form-grid"},Te={class:"form-group"},Ae={key:0,class:"form-error"},$e={class:"form-group"},Je={key:0,class:"form-error"},Me={class:"form-group"},Ye={key:0,class:"form-error"},Ge={class:"form-group"},ze={key:0,class:"form-error"},He={class:"form-group"},Ke={class:"checkbox-wrapper"},Ne={class:"form-actions"},Qe=["disabled"],Xe={key:0,class:"loading-spinner"},Ze={class:"action-group"},We=["disabled"],es=["disabled"],ss={key:0,class:"loading-spinner"},as=B(i({__name:"EmailSettingsForm",props:{emailSettings:{},loading:{type:Boolean,default:!1}},emits:["update","test"],setup(e,{emit:s}){const a=e,l=s,t=d({smtp_enabled:!1,smtp_host:"",smtp_port:587,smtp_username:"",smtp_password:"",smtp_use_tls:!0}),n=d({}),i=U(!1),k=u(()=>!t.smtp_enabled||t.smtp_host&&t.smtp_port&&0===Object.keys(n).length),x=u(()=>t.smtp_enabled&&t.smtp_host&&t.smtp_port),w=()=>{var e,s;a.emailSettings&&Object.assign(t,{smtp_enabled:null!=(e=a.emailSettings.smtp_enabled)&&e,smtp_host:a.emailSettings.smtp_host||"",smtp_port:a.emailSettings.smtp_port||587,smtp_username:a.emailSettings.smtp_username||"",smtp_password:a.emailSettings.smtp_password||"",smtp_use_tls:null==(s=a.emailSettings.smtp_use_tls)||s})},q=(e,s)=>{if(t.smtp_enabled)switch(e){case"smtp_host":s?delete n[e]:n[e]="请输入SMTP服务器地址";break;case"smtp_port":!s||s<1||s>65535?n[e]="端口必须在1-65535之间":delete n[e];break;default:delete n[e]}else delete n[e]};c(()=>t.smtp_enabled,()=>{t.smtp_enabled||Object.keys(n).forEach(e=>{delete n[e]})}),c(()=>t.smtp_host,e=>q("smtp_host",e)),c(()=>t.smtp_port,e=>q("smtp_port",e)),c(()=>a.emailSettings,()=>{w()},{immediate:!0,deep:!0});const j=()=>{t.smtp_enabled&&(q("smtp_host",t.smtp_host),q("smtp_port",t.smtp_port)),k.value&&l("update",o({},t))},C=()=>r(this,null,function*(){i.value=!0;try{l("test")}finally{setTimeout(()=>{i.value=!1},1e3)}}),O=()=>{w(),Object.keys(n).forEach(e=>{delete n[e]})};return(e,s)=>(h(),m("div",Ee,[s[12]||(s[12]=p("h3",{class:"form-title"},"邮件设置",-1)),s[13]||(s[13]=p("p",{class:"form-description"}," 配置SMTP邮件服务器，用于发送报价单和系统通知。 ",-1)),p("form",{onSubmit:b(j,["prevent"]),class:"form"},[p("div",Fe,[p("div",Re,[f(p("input",{id:"smtp-enabled","onUpdate:modelValue":s[0]||(s[0]=e=>t.smtp_enabled=e),type:"checkbox",class:"form-checkbox"},null,512),[[S,t.smtp_enabled]]),s[6]||(s[6]=p("label",{for:"smtp-enabled",class:"checkbox-label"}," 启用邮件功能 ",-1))])]),t.smtp_enabled?(h(),m("div",Be,[p("div",Le,[p("div",Te,[s[7]||(s[7]=p("label",{for:"smtp-host",class:"form-label required"}," SMTP服务器 ",-1)),f(p("input",{id:"smtp-host","onUpdate:modelValue":s[1]||(s[1]=e=>t.smtp_host=e),type:"text",required:"",class:"form-input",placeholder:"smtp.gmail.com"},null,512),[[y,t.smtp_host]]),n.smtp_host?(h(),m("div",Ae,g(n.smtp_host),1)):_("",!0)]),p("div",$e,[s[8]||(s[8]=p("label",{for:"smtp-port",class:"form-label required"}," 端口 ",-1)),f(p("input",{id:"smtp-port","onUpdate:modelValue":s[2]||(s[2]=e=>t.smtp_port=e),type:"number",min:"1",max:"65535",required:"",class:"form-input",placeholder:"587"},null,512),[[y,t.smtp_port,void 0,{number:!0}]]),n.smtp_port?(h(),m("div",Je,g(n.smtp_port),1)):_("",!0)]),p("div",Me,[s[9]||(s[9]=p("label",{for:"smtp-username",class:"form-label"}," 用户名 ",-1)),f(p("input",{id:"smtp-username","onUpdate:modelValue":s[3]||(s[3]=e=>t.smtp_username=e),type:"text",class:"form-input",placeholder:"your-email@gmail.com"},null,512),[[y,t.smtp_username]]),n.smtp_username?(h(),m("div",Ye,g(n.smtp_username),1)):_("",!0)]),p("div",Ge,[s[10]||(s[10]=p("label",{for:"smtp-password",class:"form-label"}," 密码 ",-1)),f(p("input",{id:"smtp-password","onUpdate:modelValue":s[4]||(s[4]=e=>t.smtp_password=e),type:"password",class:"form-input",placeholder:"应用专用密码"},null,512),[[y,t.smtp_password]]),n.smtp_password?(h(),m("div",ze,g(n.smtp_password),1)):_("",!0)])]),p("div",He,[p("div",Ke,[f(p("input",{id:"smtp-use-tls","onUpdate:modelValue":s[5]||(s[5]=e=>t.smtp_use_tls=e),type:"checkbox",class:"form-checkbox"},null,512),[[S,t.smtp_use_tls]]),s[11]||(s[11]=p("label",{for:"smtp-use-tls",class:"checkbox-label"}," 使用TLS加密连接 ",-1))])])])):_("",!0),p("div",Ne,[t.smtp_enabled?(h(),m("button",{key:0,type:"button",onClick:C,disabled:e.loading||!x.value,class:"test-button"},[i.value?(h(),m("span",Xe)):_("",!0),v(" "+g(i.value?"测试中...":"测试连接"),1)],8,Qe)):_("",!0),p("div",Ze,[p("button",{type:"button",onClick:O,disabled:e.loading,class:"reset-button"}," 重置 ",8,We),p("button",{type:"submit",disabled:e.loading||!k.value,class:"submit-button"},[e.loading?(h(),m("span",ss)):_("",!0),v(" "+g(e.loading?"保存中...":"保存更改"),1)],8,es)])])],32)]))}}),[["__scopeId","data-v-77f20d5b"]]),ls={class:"business-rules-form"},ts={class:"rules-grid"},os={class:"rule-group"},rs={class:"rule-header"},ns={class:"checkbox-wrapper"},is={class:"rule-group"},ds={class:"rule-header"},us={class:"checkbox-wrapper"},cs={class:"rule-group"},ms={class:"discount-input-wrapper"},ps={key:0,class:"form-error"},bs={class:"form-actions"},fs=["disabled"],_s=["disabled"],ys={key:0,class:"loading-spinner"},gs=B(i({__name:"BusinessRulesForm",props:{businessRules:{},loading:{type:Boolean,default:!1}},emits:["update"],setup(e,{emit:s}){const a=e,l=s,t=d({auto_quote_numbering:!0,require_customer_approval:!1,max_discount_percentage:20}),r=d({}),n=u(()=>t.max_discount_percentage>=0&&t.max_discount_percentage<=100&&0===Object.keys(r).length),i=()=>{var e,s,l;a.businessRules&&Object.assign(t,{auto_quote_numbering:null==(e=a.businessRules.auto_quote_numbering)||e,require_customer_approval:null!=(s=a.businessRules.require_customer_approval)&&s,max_discount_percentage:null!=(l=a.businessRules.max_discount_percentage)?l:20})},k=(e,s)=>{"max_discount_percentage"===e&&(s<0||s>100)?r[e]="折扣百分比必须在0-100之间":delete r[e]};c(()=>t.max_discount_percentage,e=>k("max_discount_percentage",e)),c(()=>a.businessRules,()=>{i()},{immediate:!0,deep:!0});const x=()=>{k("max_discount_percentage",t.max_discount_percentage),n.value&&l("update",o({},t))},w=()=>{i(),Object.keys(r).forEach(e=>{delete r[e]})};return(e,s)=>(h(),m("div",ls,[s[11]||(s[11]=p("h3",{class:"form-title"},"业务规则",-1)),s[12]||(s[12]=p("p",{class:"form-description"}," 配置系统的业务逻辑和规则，影响报价流程和用户权限。 ",-1)),p("form",{onSubmit:b(x,["prevent"]),class:"form"},[p("div",ts,[p("div",os,[p("div",rs,[p("div",ns,[f(p("input",{id:"auto-quote-numbering","onUpdate:modelValue":s[0]||(s[0]=e=>t.auto_quote_numbering=e),type:"checkbox",class:"form-checkbox"},null,512),[[S,t.auto_quote_numbering]]),s[3]||(s[3]=p("label",{for:"auto-quote-numbering",class:"rule-title"}," 自动生成报价单号 ",-1))])]),s[4]||(s[4]=p("p",{class:"rule-description"}," 启用后，系统将自动为新的报价单分配唯一编号。 ",-1))]),p("div",is,[p("div",ds,[p("div",us,[f(p("input",{id:"require-customer-approval","onUpdate:modelValue":s[1]||(s[1]=e=>t.require_customer_approval=e),type:"checkbox",class:"form-checkbox"},null,512),[[S,t.require_customer_approval]]),s[5]||(s[5]=p("label",{for:"require-customer-approval",class:"rule-title"}," 需要客户确认 ",-1))])]),s[6]||(s[6]=p("p",{class:"rule-description"}," 启用后，报价单需要客户确认后才能生效。 ",-1))]),p("div",cs,[s[8]||(s[8]=p("div",{class:"rule-header"},[p("label",{for:"max-discount",class:"rule-title"}," 最大折扣百分比 ")],-1)),p("div",ms,[f(p("input",{id:"max-discount","onUpdate:modelValue":s[2]||(s[2]=e=>t.max_discount_percentage=e),type:"number",min:"0",max:"100",step:"0.01",required:"",class:"form-input discount-input",placeholder:"20.00"},null,512),[[y,t.max_discount_percentage,void 0,{number:!0}]]),s[7]||(s[7]=p("span",{class:"discount-unit"},"%",-1))]),s[9]||(s[9]=p("p",{class:"rule-description"}," 设置用户可以应用的最大折扣百分比。 ",-1)),r.max_discount_percentage?(h(),m("div",ps,g(r.max_discount_percentage),1)):_("",!0)])]),s[10]||(s[10]=p("div",{class:"additional-rules"},[p("h4",{class:"section-title"},"高级设置"),p("div",{class:"info-box"},[p("p",null,"更多业务规则和权限控制功能正在开发中...")])],-1)),p("div",bs,[p("button",{type:"button",onClick:w,disabled:e.loading,class:"reset-button"}," 重置 ",8,fs),p("button",{type:"submit",disabled:e.loading||!n.value,class:"submit-button"},[e.loading?(h(),m("span",ys)):_("",!0),v(" "+g(e.loading?"保存中...":"保存更改"),1)],8,_s)])],32)]))}}),[["__scopeId","data-v-c5b81320"]]),vs={class:"settings-page"},hs={key:0,class:"loading-container"},ks={key:1,class:"error-container"},xs={class:"error-message"},ws={key:2,class:"settings-content"},qs={class:"settings-tabs"},Ss=["onClick"],Us={class:"tab-content"},js={key:0,class:"tab-panel"},Cs={key:1,class:"tab-panel"},Os={key:2,class:"tab-panel"},Vs={key:3,class:"tab-panel"},Is={key:4,class:"tab-panel"},Ps={class:"settings-actions"},Ds=["disabled"],Es={class:"action-buttons"},Fs=["disabled"],Rs=i({__name:"Settings",setup(e){const s=U(null),a=U(!1),l=U(!1),t=U(null),o=U(""),i=U("success"),d=U("company"),u=[{key:"company",label:"公司信息",icon:P},{key:"system",label:"系统配置",icon:D},{key:"pdf",label:"PDF设置",icon:E},{key:"email",label:"邮件设置",icon:F},{key:"business",label:"业务规则",icon:R}],c=(e=!1)=>r(this,null,function*(){a.value=!0,t.value=null;try{s.value=yield n.getSettings(e)}catch(l){t.value=l.message||"加载设置失败"}finally{a.value=!1}}),b=e=>r(this,null,function*(){yield S({company_info:e})}),f=e=>r(this,null,function*(){yield S({system_config:e})}),y=e=>r(this,null,function*(){yield S({pdf_settings:e})}),k=e=>r(this,null,function*(){yield S({email_settings:e})}),q=e=>r(this,null,function*(){yield S({business_rules:e})}),S=e=>r(this,null,function*(){l.value=!0;try{s.value=yield n.updateSettings(e),T("设置更新成功","success")}catch(a){T(a.message||"更新设置失败","error")}finally{l.value=!1}}),B=()=>r(this,null,function*(){l.value=!0;try{const e=yield n.testEmailSettings();T(e.message||"邮件测试成功","success")}catch(e){T(e.message||"邮件测试失败","error")}finally{l.value=!1}}),L=()=>r(this,null,function*(){if(confirm("确定要重置为默认设置吗？此操作不可恢复。")){l.value=!0;try{s.value=yield n.resetSettings(),T("设置已重置为默认值","success")}catch(e){T(e.message||"重置设置失败","error")}finally{l.value=!1}}}),T=(e,s)=>{o.value=e,i.value=s,setTimeout(()=>{o.value=""},5e3)};return j(()=>{c()}),(e,r)=>{var n,S,U,j,P;return h(),m("div",vs,[r[3]||(r[3]=p("div",{class:"settings-header"},[p("h1",{class:"settings-title"},"系统设置"),p("p",{class:"settings-subtitle"},"管理系统配置和公司信息")],-1)),a.value?(h(),m("div",hs,r[1]||(r[1]=[p("div",{class:"loading-spinner"},null,-1),p("p",null,"加载设置中...",-1)]))):t.value?(h(),m("div",ks,[p("div",xs,[r[2]||(r[2]=p("h3",null,"加载失败",-1)),p("p",null,g(t.value),1),p("button",{onClick:c,class:"retry-button"},"重试")])])):(h(),m("div",ws,[p("div",qs,[(h(),m(x,null,w(u,e=>p("button",{key:e.key,onClick:s=>d.value=e.key,class:O(["tab-button",{active:d.value===e.key}])},[(h(),V(I(e.icon),{class:"tab-icon"})),v(" "+g(e.label),1)],10,Ss)),64))]),p("div",Us,["company"===d.value?(h(),m("div",js,[C(te,{"company-info":null==(n=s.value)?void 0:n.company_info,loading:l.value,onUpdate:b},null,8,["company-info","loading"])])):_("",!0),"system"===d.value?(h(),m("div",Cs,[C(ve,{"system-config":null==(S=s.value)?void 0:S.system_config,loading:l.value,onUpdate:f},null,8,["system-config","loading"])])):_("",!0),"pdf"===d.value?(h(),m("div",Os,[C(De,{"pdf-settings":null==(U=s.value)?void 0:U.pdf_settings,loading:l.value,onUpdate:y},null,8,["pdf-settings","loading"])])):_("",!0),"email"===d.value?(h(),m("div",Vs,[C(as,{"email-settings":null==(j=s.value)?void 0:j.email_settings,loading:l.value,onUpdate:k,onTest:B},null,8,["email-settings","loading"])])):_("",!0),"business"===d.value?(h(),m("div",Is,[C(gs,{"business-rules":null==(P=s.value)?void 0:P.business_rules,loading:l.value,onUpdate:q},null,8,["business-rules","loading"])])):_("",!0)]),p("div",Ps,[p("button",{onClick:L,disabled:l.value,class:"reset-button"}," 重置为默认值 ",8,Ds),p("div",Es,[p("button",{onClick:r[0]||(r[0]=e=>c(!0)),disabled:l.value,class:"refresh-button"}," 刷新 ",8,Fs)])])])),o.value?(h(),m("div",{key:3,class:O(["message",i.value])},g(o.value),3)):_("",!0)])}}});export{Rs as _};
