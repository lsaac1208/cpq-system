var Oe=Object.defineProperty,Qe=Object.defineProperties;var Xe=Object.getOwnPropertyDescriptors;var Pe=Object.getOwnPropertySymbols;var Ge=Object.prototype.hasOwnProperty,We=Object.prototype.propertyIsEnumerable;var Ee=(R,k,b)=>k in R?Oe(R,k,{enumerable:!0,configurable:!0,writable:!0,value:b}):R[k]=b,ae=(R,k)=>{for(var b in k||(k={}))Ge.call(k,b)&&Ee(R,b,k[b]);if(Pe)for(var b of Pe(k))We.call(k,b)&&Ee(R,b,k[b]);return R},we=(R,k)=>Qe(R,Xe(k)),a=(R,k)=>Oe(R,"name",{value:k,configurable:!0});var ee=(R,k,b)=>new Promise((U,$)=>{var S=P=>{try{n(b.next(P))}catch(E){$(E)}},i=P=>{try{n(b.throw(P))}catch(E){$(E)}},n=P=>P.done?U(P.value):Promise.resolve(P.value).then(S,i);n((b=b.apply(R,k)).next())});import{h as Fe,s as q,_ as oe}from"./index-CoBZUWE1.js";/* empty css                    *//* empty css                *//* empty css                *//* empty css                  *//* empty css                 *//* empty css                        */import"./el-tooltip-l0sNRNKZ.js";/* empty css                     *//* empty css                  *//* empty css                          *//* empty css                    *//* empty css                 */import"./el-form-item-l0sNRNKZ.js";import{x as ne,r as T,X as ze,c as ve,w as Re,j as ie,y as V,A as e,J as Ae,K as se,Q as t,u as j,I as s,P as W,a6 as Y,H as te,M as m,O as r,z as g,a4 as Ye,D as Ze,t as et}from"./vendor-vue-XfLkFKXI.js";import{W as ce,A as tt,X as ge,Y as fe,T as qe,ak as Be,d as de,j as ue,b as pe,b1 as st,b2 as Ce,a0 as Me,O as ye,af as Le,ag as je,V as $e,al as Ie,b3 as lt,am as at,b4 as ot,J as nt,B as it,a as be,ae as re,M as Ve,p as rt,b5 as dt,q as ut,r as ct,N as ke,a$ as pt,S as Ne,c as Te,R as He,b6 as xe,b7 as Ue,I as De,b8 as mt,P as _t,aJ as vt,b9 as gt,ba as ft,ah as yt,bb as bt,bc as ht}from"./vendor-ui-CE-ZhXxH.js";/* empty css                      *//* empty css               *//* empty css                        *//* empty css                         *//* empty css                        *//* empty css                       *//* empty css                  */import"./vendor-pdf-BeW0Xq92.js";import"./vendor-utils-B8vW8fJV.js";const Je="/prompt-optimization",wt=a(R=>Fe.post("".concat(Je,"/optimize"),R),"getOptimizationSuggestions"),$t=a(R=>Fe.get("".concat(Je,"/templates"),{params:R}),"getPromptTemplates"),zt={class:"template-selector"},Ct={class:"selector-header"},Vt={class:"template-list"},kt={key:0,class:"empty-state"},Tt=["onClick"],xt={class:"template-header"},Ut={class:"template-name"},St={class:"template-badges"},Pt={class:"template-description"},Et={class:"template-content-preview"},Ot={class:"template-tags"},Rt={key:0,class:"more-tags"},It={class:"template-stats"},Dt={class:"stat-item"},Ft={class:"stat-item"},At={class:"stat-item"},qt={class:"template-meta"},Bt={class:"created-at"},Mt={class:"version"},Lt={key:0,class:"pagination-container"},jt={class:"selector-actions"},Nt=ne({__name:"TemplateSelector",emits:["template-selected","close"],setup(R,{emit:k}){const b=k,U=T(!1),$=T(""),S=T(""),i=T(""),n=T(null),P=T([]),E=T([]),F=T([]),h=ze({page:1,per_page:10,total:0,pages:0}),H=ve(()=>{let y=P.value;if($.value){const o=$.value.toLowerCase();y=y.filter(l=>l.name.toLowerCase().includes(o)||l.description.toLowerCase().includes(o)||l.template_content.toLowerCase().includes(o))}return S.value&&(y=y.filter(o=>o.category===S.value)),i.value&&(y=y.filter(o=>o.tags.includes(i.value))),y}),O=a(()=>ee(this,null,function*(){try{U.value=!0;const y=ae(ae({page:h.page,per_page:h.per_page},S.value&&{category:S.value}),i.value&&{tag:i.value}),o=yield $t(y);if(o.success)P.value=o.templates,E.value=o.categories,F.value=o.popular_tags,Object.assign(h,o.pagination);else throw new Error("加载模板失败")}catch(y){q.error("加载模板失败")}finally{U.value=!1}}),"loadTemplates"),I=a(y=>{n.value=y},"selectTemplate"),u=a(()=>{n.value&&b("template-selected",n.value)},"confirmSelection"),p=a(()=>{$.value="",S.value="",i.value="",h.page=1,O()},"clearFilters"),B=a(y=>{h.per_page=y,h.page=1,O()},"handleSizeChange"),f=a(y=>{h.page=y,O()},"handleCurrentChange"),c=a((y,o)=>y.length<=o?y:y.substring(0,o)+"...","truncateText"),J=a(y=>new Date(y).toLocaleDateString("zh-CN"),"formatDate");return Re([S,i],()=>{h.page=1,O()}),Re($,()=>{}),ie(()=>{O()}),(y,o)=>{const l=ce,M=fe,L=ge,v=de,_=Be,d=ue,Q=pe,D=Ce,X=Me,Z=qe;return g(),V("div",zt,[e("div",Ct,[t(l,{modelValue:$.value,"onUpdate:modelValue":o[0]||(o[0]=w=>$.value=w),placeholder:"搜索模板...","prefix-icon":j(tt),style:{width:"300px"},clearable:""},null,8,["modelValue","prefix-icon"]),t(L,{modelValue:S.value,"onUpdate:modelValue":o[1]||(o[1]=w=>S.value=w),placeholder:"选择分类",clearable:"",style:{width:"200px","margin-left":"15px"}},{default:s(()=>[(g(!0),V(W,null,Y(E.value,w=>(g(),te(M,{key:w,label:w,value:w},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),t(L,{modelValue:i.value,"onUpdate:modelValue":o[2]||(o[2]=w=>i.value=w),placeholder:"选择标签",clearable:"",style:{width:"200px","margin-left":"15px"}},{default:s(()=>[(g(!0),V(W,null,Y(F.value,w=>(g(),te(M,{key:w,label:w,value:w},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),Ae((g(),V("div",Vt,[H.value.length===0?(g(),V("div",kt,[t(_,{description:"未找到匹配的模板"},{default:s(()=>[t(v,{type:"primary",onClick:p},{default:s(()=>o[6]||(o[6]=[m("清除筛选条件",-1)])),_:1,__:[6]})]),_:1})])):se("",!0),(g(!0),V(W,null,Y(H.value,w=>(g(),V("div",{key:w.id,class:"template-item",onClick:a(N=>I(w),"onClick")},[e("div",xt,[e("h4",Ut,r(w.name),1),e("div",St,[t(d,{size:"small",type:"info"},{default:s(()=>[m(r(w.category),1)]),_:2},1024),w.is_public?(g(),te(d,{key:0,size:"small",type:"success"},{default:s(()=>o[7]||(o[7]=[m("公开",-1)])),_:1,__:[7]})):(g(),te(d,{key:1,size:"small",type:"warning"},{default:s(()=>o[8]||(o[8]=[m("私有",-1)])),_:1,__:[8]}))])]),e("p",Pt,r(w.description),1),e("div",Et,[e("code",null,r(c(w.template_content,200)),1)]),e("div",Ot,[(g(!0),V(W,null,Y(w.tags.slice(0,3),N=>(g(),te(d,{key:N,size:"small",effect:"plain"},{default:s(()=>[m(r(N),1)]),_:2},1024))),128)),w.tags.length>3?(g(),V("span",Rt," +"+r(w.tags.length-3),1)):se("",!0)]),e("div",It,[e("span",Dt,[t(Q,null,{default:s(()=>[t(j(st))]),_:1}),m(" 使用 "+r(w.usage_count)+" 次 ",1)]),e("span",Ft,[t(D,{modelValue:w.average_rating,"onUpdate:modelValue":a(N=>w.average_rating=N,"onUpdate:modelValue"),disabled:"","show-score":"",max:5,size:"small"},null,8,["modelValue","onUpdate:modelValue"])]),e("span",At," 成功率 "+r((w.success_rate*100).toFixed(0))+"% ",1)]),e("div",qt,[e("span",Bt," 创建于 "+r(J(w.created_at)),1),e("span",Mt,"v"+r(w.version),1)])],8,Tt))),128))])),[[Z,U.value]]),h.total>0?(g(),V("div",Lt,[t(X,{"current-page":h.page,"onUpdate:currentPage":o[3]||(o[3]=w=>h.page=w),"page-size":h.per_page,"onUpdate:pageSize":o[4]||(o[4]=w=>h.per_page=w),"page-sizes":[10,20,50],total:h.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:B,onCurrentChange:f},null,8,["current-page","page-size","total"])])):se("",!0),e("div",jt,[t(v,{onClick:o[5]||(o[5]=w=>y.$emit("close"))},{default:s(()=>o[9]||(o[9]=[m("取消",-1)])),_:1,__:[9]}),t(v,{type:"primary",disabled:!n.value,onClick:u},{default:s(()=>o[10]||(o[10]=[m(" 选择模板 ",-1)])),_:1,__:[10]},8,["disabled"])])])}}}),Ht=oe(Nt,[["__scopeId","data-v-7efe0985"]]),Jt={class:"prompt-optimizer"},Kt={class:"historical-data-section"},Qt={class:"section-header"},Xt={key:0,class:"empty-state"},Gt={class:"case-header"},Wt={class:"case-title"},Yt={class:"case-meta"},Zt={class:"historical-data-section"},es={class:"section-header"},ts={key:0,class:"empty-state"},ss={class:"case-header"},ls={class:"case-title"},as={class:"case-meta"},os={class:"weight-config"},ns={class:"weight-item"},is={class:"weight-item"},rs={class:"weight-item"},ds={class:"weight-item"},us={class:"action-buttons"},cs={class:"examples"},ps=["onClick"],ms=ne({__name:"PromptOptimizer",emits:["optimization-success","optimization-error"],setup(R,{emit:k}){const b=k,U=T(),$=T(!1),S=T(!1),i=ze({current_prompt:"",historical_data:{success_cases:[],failure_cases:[]},optimization_goals:[],target_domain:"",priority_weights:{accuracy:.3,clarity:.3,efficiency:.2,user_satisfaction:.2}}),n=T({}),P={current_prompt:[{required:!0,message:"请输入当前Prompt",trigger:"blur"},{min:10,message:"Prompt至少需要10个字符",trigger:"blur"}],optimization_goals:[{required:!0,message:"请选择至少一个优化目标",trigger:"change"}]},E=ve(()=>i.current_prompt.trim().length>=10&&i.optimization_goals.length>0),F=[{title:"产品文档分析",description:"用于分析产品规格文档的Prompt优化示例",domain:"product_analysis",data:{current_prompt:"请分析以下产品文档，提取产品名称、规格参数、价格信息和主要特性",optimization_goals:["accuracy","consistency"],target_domain:"product_analysis"}},{title:"数据提取优化",description:"提升结构化数据提取准确性的示例",domain:"data_extraction",data:{current_prompt:"从文档中提取结构化数据，包括表格、列表和关键信息",optimization_goals:["accuracy","efficiency"],target_domain:"data_extraction"}},{title:"质量评估增强",description:"改进内容质量评估的Prompt示例",domain:"quality_assessment",data:{current_prompt:"评估文档质量，包括完整性、准确性和一致性",optimization_goals:["clarity","user_satisfaction"],target_domain:"quality_assessment"}}],h=a(()=>{i.historical_data.success_cases.push({prompt:"",result_quality:5,user_feedback:"",metadata:{}})},"addSuccessCase"),H=a(o=>{i.historical_data.success_cases.splice(o,1)},"removeSuccessCase"),O=a(()=>{const o=i.historical_data.failure_cases.length;i.historical_data.failure_cases.push({prompt:"",issues:[],user_feedback:"",metadata:{}}),n.value[o]=""},"addFailureCase"),I=a(o=>{i.historical_data.failure_cases.splice(o,1),delete n.value[o]},"removeFailureCase"),u=a(o=>{var M;const l=(M=n.value[o])==null?void 0:M.trim();l&&(i.historical_data.failure_cases[o].issues.push(l),n.value[o]="")},"addIssue"),p=a((o,l)=>{i.historical_data.failure_cases[o].issues.splice(l,1)},"removeIssue"),B=a(()=>ee(this,null,function*(){if(U.value)try{yield U.value.validate(),$.value=!0;const o=yield wt(i);if(o.success)b("optimization-success",o),q.success("Prompt优化完成！");else throw new Error(o.error||"优化失败")}catch(o){const l=o instanceof Error?o.message:"优化过程中发生错误";b("optimization-error",l),q.error(l)}finally{$.value=!1}}),"startOptimization"),f=a(()=>{U.value&&re.confirm("确定要重置表单吗？所有输入的数据将丢失。","确认重置",{type:"warning"}).then(()=>{var o;(o=U.value)==null||o.resetFields(),i.historical_data.success_cases=[],i.historical_data.failure_cases=[],i.optimization_goals=[],i.target_domain="",n.value={},q.success("表单已重置")}).catch(()=>{})},"resetForm"),c=a(()=>{S.value=!0},"loadTemplate"),J=a(o=>{re.confirm("确定要加载此示例吗？当前表单数据将被替换。","确认加载示例",{type:"info"}).then(()=>{Object.assign(i,ae(ae({},i),o.data)),q.success("已加载示例：".concat(o.title))}).catch(()=>{})},"loadExample"),y=a(o=>{i.current_prompt=o.template_content,o.category&&(i.target_domain=o.category),S.value=!1,q.success("已加载模板：".concat(o.name))},"handleTemplateSelected");return ie(()=>{n.value={}}),(o,l)=>{const M=ce,L=je,v=de,_=Be,d=Ce,Q=ue,D=at,X=lt,Z=fe,w=ge,N=ot,x=pe,G=Le,le=ye,he=be;return g(),V("div",Jt,[t(le,{class:"optimizer-card"},{header:s(()=>l[9]||(l[9]=[e("div",{class:"card-header"},[e("h3",null,"智能Prompt优化"),e("p",null,"输入当前Prompt和历史数据，获得AI驱动的优化建议")],-1)])),default:s(()=>[t(G,{ref_key:"formRef",ref:U,model:i,rules:P,"label-width":"120px",class:"optimizer-form"},{default:s(()=>[t(L,{label:"当前Prompt",prop:"current_prompt",required:""},{default:s(()=>[t(M,{modelValue:i.current_prompt,"onUpdate:modelValue":l[0]||(l[0]=z=>i.current_prompt=z),type:"textarea",rows:6,placeholder:"请输入需要优化的Prompt...","show-word-limit":"",maxlength:"2000"},null,8,["modelValue"]),l[10]||(l[10]=e("div",{class:"form-tip"}," 提示：详细描述当前使用的Prompt，包括指令、参数和期望的输出格式 ",-1))]),_:1,__:[10]}),t(L,{label:"成功案例"},{default:s(()=>[e("div",Kt,[e("div",Qt,[l[12]||(l[12]=e("span",null,"历史成功案例",-1)),t(v,{type:"primary",size:"small",onClick:h,icon:j($e)},{default:s(()=>l[11]||(l[11]=[m(" 添加案例 ",-1)])),_:1,__:[11]},8,["icon"])]),i.historical_data.success_cases.length===0?(g(),V("div",Xt,[t(_,{description:"暂无成功案例，点击上方按钮添加"},{default:s(()=>[t(v,{type:"primary",onClick:h},{default:s(()=>l[13]||(l[13]=[m("添加成功案例",-1)])),_:1,__:[13]})]),_:1})])):se("",!0),(g(!0),V(W,null,Y(i.historical_data.success_cases,(z,K)=>(g(),V("div",{key:"success-".concat(K),class:"case-item success-case"},[e("div",Gt,[e("span",Wt,"成功案例 #"+r(K+1),1),t(v,{type:"danger",size:"small",text:"",onClick:a(A=>H(K),"onClick"),icon:j(Ie)},null,8,["onClick","icon"])]),t(M,{modelValue:z.prompt,"onUpdate:modelValue":a(A=>z.prompt=A,"onUpdate:modelValue"),type:"textarea",rows:3,placeholder:"输入成功的Prompt...",class:"case-input"},null,8,["modelValue","onUpdate:modelValue"]),e("div",Yt,[t(d,{modelValue:z.result_quality,"onUpdate:modelValue":a(A=>z.result_quality=A,"onUpdate:modelValue"),max:5,"show-score":"","text-color":"#ff9900","score-template":"质量: {value}"},null,8,["modelValue","onUpdate:modelValue"]),t(M,{modelValue:z.user_feedback,"onUpdate:modelValue":a(A=>z.user_feedback=A,"onUpdate:modelValue"),placeholder:"用户反馈...",size:"small",style:{width:"200px","margin-left":"15px"}},null,8,["modelValue","onUpdate:modelValue"])])]))),128))])]),_:1}),t(L,{label:"失败案例"},{default:s(()=>[e("div",Zt,[e("div",es,[l[15]||(l[15]=e("span",null,"历史失败案例",-1)),t(v,{type:"warning",size:"small",onClick:O,icon:j($e)},{default:s(()=>l[14]||(l[14]=[m(" 添加案例 ",-1)])),_:1,__:[14]},8,["icon"])]),i.historical_data.failure_cases.length===0?(g(),V("div",ts,[t(_,{description:"暂无失败案例，点击上方按钮添加"},{default:s(()=>[t(v,{type:"warning",onClick:O},{default:s(()=>l[16]||(l[16]=[m("添加失败案例",-1)])),_:1,__:[16]})]),_:1})])):se("",!0),(g(!0),V(W,null,Y(i.historical_data.failure_cases,(z,K)=>(g(),V("div",{key:"failure-".concat(K),class:"case-item failure-case"},[e("div",ss,[e("span",ls,"失败案例 #"+r(K+1),1),t(v,{type:"danger",size:"small",text:"",onClick:a(A=>I(K),"onClick"),icon:j(Ie)},null,8,["onClick","icon"])]),t(M,{modelValue:z.prompt,"onUpdate:modelValue":a(A=>z.prompt=A,"onUpdate:modelValue"),type:"textarea",rows:3,placeholder:"输入失败的Prompt...",class:"case-input"},null,8,["modelValue","onUpdate:modelValue"]),e("div",as,[(g(!0),V(W,null,Y(z.issues,(A,me)=>(g(),te(Q,{key:me,type:"danger",size:"small",closable:"",onClose:a(Se=>p(K,me),"onClose"),style:{"margin-right":"5px"}},{default:s(()=>[m(r(A),1)]),_:2},1032,["onClose"]))),128)),t(M,{modelValue:n.value[K],"onUpdate:modelValue":a(A=>n.value[K]=A,"onUpdate:modelValue"),placeholder:"添加问题...",size:"small",style:{width:"120px","margin-right":"10px"},onKeyup:Ye(A=>u(K),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"]),t(v,{size:"small",type:"primary",text:"",onClick:a(A=>u(K),"onClick")},{default:s(()=>l[17]||(l[17]=[m(" 添加问题 ",-1)])),_:2,__:[17]},1032,["onClick"])]),t(M,{modelValue:z.user_feedback,"onUpdate:modelValue":a(A=>z.user_feedback=A,"onUpdate:modelValue"),placeholder:"用户反馈...",size:"small",style:{"margin-top":"10px"}},null,8,["modelValue","onUpdate:modelValue"])]))),128))])]),_:1}),t(L,{label:"优化目标",prop:"optimization_goals",required:""},{default:s(()=>[t(X,{modelValue:i.optimization_goals,"onUpdate:modelValue":l[1]||(l[1]=z=>i.optimization_goals=z),class:"goal-checkboxes"},{default:s(()=>[t(D,{label:"accuracy"},{default:s(()=>l[18]||(l[18]=[m("提升准确性",-1)])),_:1,__:[18]}),t(D,{label:"clarity"},{default:s(()=>l[19]||(l[19]=[m("增强清晰度",-1)])),_:1,__:[19]}),t(D,{label:"efficiency"},{default:s(()=>l[20]||(l[20]=[m("提高效率",-1)])),_:1,__:[20]}),t(D,{label:"user_satisfaction"},{default:s(()=>l[21]||(l[21]=[m("用户满意度",-1)])),_:1,__:[21]}),t(D,{label:"consistency"},{default:s(()=>l[22]||(l[22]=[m("保持一致性",-1)])),_:1,__:[22]}),t(D,{label:"robustness"},{default:s(()=>l[23]||(l[23]=[m("增强鲁棒性",-1)])),_:1,__:[23]})]),_:1},8,["modelValue"])]),_:1}),t(L,{label:"目标领域"},{default:s(()=>[t(w,{modelValue:i.target_domain,"onUpdate:modelValue":l[2]||(l[2]=z=>i.target_domain=z),placeholder:"选择应用领域",clearable:"",style:{width:"200px"}},{default:s(()=>[t(Z,{label:"产品分析",value:"product_analysis"}),t(Z,{label:"文档解析",value:"document_parsing"}),t(Z,{label:"数据提取",value:"data_extraction"}),t(Z,{label:"质量评估",value:"quality_assessment"}),t(Z,{label:"内容生成",value:"content_generation"}),t(Z,{label:"通用分析",value:"general_analysis"})]),_:1},8,["modelValue"])]),_:1}),t(L,{label:"权重配置"},{default:s(()=>[e("div",os,[e("div",ns,[l[24]||(l[24]=e("span",null,"准确性",-1)),t(N,{modelValue:i.priority_weights.accuracy,"onUpdate:modelValue":l[3]||(l[3]=z=>i.priority_weights.accuracy=z),min:0,max:1,step:.1,"show-stops":"","show-input":"","input-size":"small",style:{width:"300px"}},null,8,["modelValue"])]),e("div",is,[l[25]||(l[25]=e("span",null,"清晰度",-1)),t(N,{modelValue:i.priority_weights.clarity,"onUpdate:modelValue":l[4]||(l[4]=z=>i.priority_weights.clarity=z),min:0,max:1,step:.1,"show-stops":"","show-input":"","input-size":"small",style:{width:"300px"}},null,8,["modelValue"])]),e("div",rs,[l[26]||(l[26]=e("span",null,"效率",-1)),t(N,{modelValue:i.priority_weights.efficiency,"onUpdate:modelValue":l[5]||(l[5]=z=>i.priority_weights.efficiency=z),min:0,max:1,step:.1,"show-stops":"","show-input":"","input-size":"small",style:{width:"300px"}},null,8,["modelValue"])]),e("div",ds,[l[27]||(l[27]=e("span",null,"用户满意度",-1)),t(N,{modelValue:i.priority_weights.user_satisfaction,"onUpdate:modelValue":l[6]||(l[6]=z=>i.priority_weights.user_satisfaction=z),min:0,max:1,step:.1,"show-stops":"","show-input":"","input-size":"small",style:{width:"300px"}},null,8,["modelValue"])])])]),_:1}),t(L,null,{default:s(()=>[e("div",us,[t(v,{type:"primary",size:"large",loading:$.value,onClick:B,disabled:!E.value},{icon:s(()=>[t(x,null,{default:s(()=>[t(j(nt))]),_:1})]),default:s(()=>[l[28]||(l[28]=m(" 开始优化 ",-1))]),_:1,__:[28]},8,["loading","disabled"]),t(v,{size:"large",onClick:f},{default:s(()=>l[29]||(l[29]=[m(" 重置表单 ",-1)])),_:1,__:[29]}),t(v,{type:"success",size:"large",onClick:c},{icon:s(()=>[t(x,null,{default:s(()=>[t(j(it))]),_:1})]),default:s(()=>[l[30]||(l[30]=m(" 加载模板 ",-1))]),_:1,__:[30]})])]),_:1})]),_:1},8,["model"])]),_:1}),t(le,{class:"example-card"},{header:s(()=>l[31]||(l[31]=[e("h3",null,"快速示例",-1)])),default:s(()=>[e("div",cs,[(g(),V(W,null,Y(F,z=>e("div",{key:z.title,class:"example-item",onClick:a(K=>J(z),"onClick")},[e("h4",null,r(z.title),1),e("p",null,r(z.description),1),t(Q,{size:"small",type:"info"},{default:s(()=>[m(r(z.domain),1)]),_:2},1024)],8,ps)),64))])]),_:1}),t(he,{modelValue:S.value,"onUpdate:modelValue":l[8]||(l[8]=z=>S.value=z),title:"选择Prompt模板",width:"70%"},{default:s(()=>[t(Ht,{onTemplateSelected:y,onClose:l[7]||(l[7]=z=>S.value=!1)})]),_:1},8,["modelValue"])])}}}),_s=oe(ms,[["__scopeId","data-v-0dec8c74"]]),vs={class:"prompt-template-manager"},gs={class:"manager-header"},fs={class:"templates-list"},ys={class:"template-header"},bs={class:"template-name"},hs={class:"template-content"},ws={class:"template-meta"},$s={class:"template-usage"},zs={class:"template-description"},Cs={class:"template-preview"},Vs={class:"template-stats"},ks={class:"stat-item"},Ts={class:"stat-value"},xs={class:"stat-item"},Us={class:"stat-value"},Ss={class:"template-actions"},Ps={class:"dialog-footer"},Es=ne({__name:"PromptTemplateManager",emits:["template-saved","template-used"],setup(R,{emit:k}){const b=k,U=T(!1),$=T(null),S=T(!1),i=T(),n=ze({name:"",type:"",description:"",content:"",expectedOutput:""}),P={name:[{required:!0,message:"请输入模板名称",trigger:"blur"}],type:[{required:!0,message:"请选择模板类型",trigger:"change"}],description:[{required:!0,message:"请输入模板描述",trigger:"blur"}],content:[{required:!0,message:"请输入Prompt内容",trigger:"blur"},{min:50,message:"Prompt内容至少50个字符",trigger:"blur"}]},E=T([{id:1,name:"产品规格提取模板",type:"产品信息提取",description:"专门用于提取产品技术规格和基本信息的模板",content:'请分析以下产品文档，提取产品的基本信息、技术规格、产品特性等关键信息。\n\n文档内容：{document}\n\n请按照以下JSON格式返回结果：\n{\n  "basic_info": {\n    "name": "产品名称",\n    "code": "产品代码",\n    "category": "产品类别"\n  },\n  "specifications": {},\n  "features": []\n}',expectedOutput:"JSON格式的产品信息",usageCount:156,successRate:94,avgTime:45.2},{id:2,name:"文档质量评估模板",type:"质量评估",description:"评估文档的完整性、准确性和可用性",content:"请对以下文档进行质量评估，从完整性、准确性、可读性等维度进行分析。\n\n文档内容：{document}\n\n评估要求：{requirements}\n\n请提供详细的评估报告和改进建议。",expectedOutput:"质量评估报告和改进建议",usageCount:89,successRate:87,avgTime:62.1},{id:3,name:"技术文档分类模板",type:"文档分类",description:"自动识别和分类技术文档类型",content:"请分析以下文档并确定其类型和类别。\n\n文档内容：{document}\n\n上下文信息：{context}\n\n请判断文档类型并提供分类依据。",expectedOutput:"文档分类结果和分类依据",usageCount:234,successRate:91,avgTime:28.5}]),F=a(f=>({产品信息提取:"primary",质量评估:"success",文档分类:"warning",技术规格分析:"info",综合分析:"danger"})[f]||"info","getTypeColor"),h=a(f=>{const[c,J]=f.split("-"),y=E.value.find(o=>o.id===parseInt(J));if(y)switch(c){case"edit":O(y);break;case"copy":I(y);break;case"delete":u(y);break}},"handleCommand"),H=a(f=>{b("template-used",f),q.success("已应用模板：".concat(f.name))},"useTemplate"),O=a(f=>{$.value=f,Object.assign(n,f),U.value=!0},"editTemplate"),I=a(f=>{const c=we(ae({},f),{id:Date.now(),name:"".concat(f.name," - 副本"),usageCount:0});E.value.push(c),q.success("模板复制成功")},"copyTemplate"),u=a(f=>ee(this,null,function*(){try{yield re.confirm('确定要删除模板"'.concat(f.name,'"吗？此操作不可恢复。'),"确认删除",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning"});const c=E.value.findIndex(J=>J.id===f.id);c>-1&&(E.value.splice(c,1),q.success("模板删除成功"))}catch(c){}}),"deleteTemplate"),p=a(()=>ee(this,null,function*(){if(i.value)try{if(yield i.value.validate(),S.value=!0,yield new Promise(f=>setTimeout(f,1e3)),$.value)Object.assign($.value,n),q.success("模板更新成功");else{const f=we(ae({},n),{id:Date.now(),usageCount:0,successRate:0,avgTime:0});E.value.push(f),q.success("模板创建成功")}b("template-saved"),U.value=!1,B()}catch(f){}finally{S.value=!1}}),"saveTemplate"),B=a(()=>{$.value=null,Object.assign(n,{name:"",type:"",description:"",content:"",expectedOutput:""}),i.value&&i.value.clearValidate()},"resetForm");return ie(()=>{}),(f,c)=>{const J=pe,y=de,o=ct,l=ut,M=rt,L=ue,v=ce,_=ye,d=ke,Q=Ve,D=je,X=fe,Z=ge,w=Le,N=be;return g(),V("div",vs,[e("div",gs,[c[9]||(c[9]=e("h3",null,"Prompt模板管理",-1)),c[10]||(c[10]=e("p",null,"管理和编辑AI分析的Prompt模板，提升分析效果",-1)),t(y,{type:"primary",onClick:c[0]||(c[0]=x=>U.value=!0)},{default:s(()=>[t(J,null,{default:s(()=>[t(j($e))]),_:1}),c[8]||(c[8]=m(" 新建模板 ",-1))]),_:1,__:[8]})]),e("div",fs,[t(Q,{gutter:20},{default:s(()=>[(g(!0),V(W,null,Y(E.value,x=>(g(),te(d,{key:x.id,span:8},{default:s(()=>[t(_,{class:"template-card",shadow:"hover"},{header:s(()=>[e("div",ys,[e("span",bs,r(x.name),1),t(M,{onCommand:h},{dropdown:s(()=>[t(l,null,{default:s(()=>[t(o,{command:"edit-".concat(x.id)},{default:s(()=>c[11]||(c[11]=[m(" 编辑 ",-1)])),_:2,__:[11]},1032,["command"]),t(o,{command:"copy-".concat(x.id)},{default:s(()=>c[12]||(c[12]=[m(" 复制 ",-1)])),_:2,__:[12]},1032,["command"]),t(o,{command:"delete-".concat(x.id),divided:""},{default:s(()=>c[13]||(c[13]=[m(" 删除 ",-1)])),_:2,__:[13]},1032,["command"])]),_:2},1024)]),default:s(()=>[t(y,{text:"",size:"small"},{default:s(()=>[t(J,null,{default:s(()=>[t(j(dt))]),_:1})]),_:1})]),_:2},1024)])]),default:s(()=>[e("div",hs,[e("div",ws,[t(L,{type:F(x.type),size:"small"},{default:s(()=>[m(r(x.type),1)]),_:2},1032,["type"]),e("span",$s,"使用次数: "+r(x.usageCount),1)]),e("div",zs,r(x.description),1),e("div",Cs,[t(v,{modelValue:x.content,"onUpdate:modelValue":a(G=>x.content=G,"onUpdate:modelValue"),type:"textarea",rows:3,readonly:"",resize:"none"},null,8,["modelValue","onUpdate:modelValue"])]),e("div",Vs,[e("div",ks,[c[14]||(c[14]=e("span",{class:"stat-label"},"成功率:",-1)),e("span",Ts,r(x.successRate)+"%",1)]),e("div",xs,[c[15]||(c[15]=e("span",{class:"stat-label"},"平均时长:",-1)),e("span",Us,r(x.avgTime)+"s",1)])]),e("div",Ss,[t(y,{size:"small",onClick:a(G=>H(x),"onClick")},{default:s(()=>c[16]||(c[16]=[m(" 使用模板 ",-1)])),_:2,__:[16]},1032,["onClick"]),t(y,{size:"small",type:"primary",onClick:a(G=>O(x),"onClick")},{default:s(()=>c[17]||(c[17]=[m(" 编辑 ",-1)])),_:2,__:[17]},1032,["onClick"])])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),t(N,{modelValue:U.value,"onUpdate:modelValue":c[7]||(c[7]=x=>U.value=x),title:$.value?"编辑模板":"新建模板",width:"60%",onClose:B},{footer:s(()=>[e("span",Ps,[t(y,{onClick:c[6]||(c[6]=x=>U.value=!1)},{default:s(()=>c[18]||(c[18]=[m("取消",-1)])),_:1,__:[18]}),t(y,{type:"primary",onClick:p,loading:S.value},{default:s(()=>[m(r($.value?"更新":"创建"),1)]),_:1},8,["loading"])])]),default:s(()=>[t(w,{ref_key:"templateFormRef",ref:i,model:n,rules:P,"label-width":"100px"},{default:s(()=>[t(D,{label:"模板名称",prop:"name"},{default:s(()=>[t(v,{modelValue:n.name,"onUpdate:modelValue":c[1]||(c[1]=x=>n.name=x),placeholder:"请输入模板名称"},null,8,["modelValue"])]),_:1}),t(D,{label:"模板类型",prop:"type"},{default:s(()=>[t(Z,{modelValue:n.type,"onUpdate:modelValue":c[2]||(c[2]=x=>n.type=x),placeholder:"请选择模板类型"},{default:s(()=>[t(X,{label:"产品信息提取",value:"product_extraction"}),t(X,{label:"技术规格分析",value:"specification_analysis"}),t(X,{label:"文档分类",value:"document_classification"}),t(X,{label:"质量评估",value:"quality_assessment"}),t(X,{label:"综合分析",value:"comprehensive_analysis"})]),_:1},8,["modelValue"])]),_:1}),t(D,{label:"模板描述",prop:"description"},{default:s(()=>[t(v,{modelValue:n.description,"onUpdate:modelValue":c[3]||(c[3]=x=>n.description=x),type:"textarea",rows:3,placeholder:"请输入模板描述"},null,8,["modelValue"])]),_:1}),t(D,{label:"Prompt内容",prop:"content"},{default:s(()=>[t(v,{modelValue:n.content,"onUpdate:modelValue":c[4]||(c[4]=x=>n.content=x),type:"textarea",rows:8,placeholder:"请输入Prompt内容，支持变量：{document}, {context}, {requirements}"},null,8,["modelValue"])]),_:1}),t(D,{label:"预期输出"},{default:s(()=>[t(v,{modelValue:n.expectedOutput,"onUpdate:modelValue":c[5]||(c[5]=x=>n.expectedOutput=x),type:"textarea",rows:4,placeholder:"描述预期的输出格式和内容"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),Os=oe(Es,[["__scopeId","data-v-d2d0c1e5"]]),Rs={class:"optimization-history"},Is={class:"filters"},Ds={class:"prompt-preview"},Fs={class:"score-display"},As={class:"pagination"},qs={key:0,class:"record-detail"},Bs={class:"info-section"},Ms={class:"info-item"},Ls={class:"info-item"},js={class:"info-item"},Ns={class:"score"},Hs={class:"info-item"},Js={class:"suggestions-list"},Ks={class:"suggestion-type"},Qs={class:"suggestion-content"},Xs={class:"suggestion-impact"},Gs=ne({__name:"OptimizationHistory",emits:["record-selected"],setup(R,{emit:k}){const b=k,U=T(!1),$=T(""),S=T(""),i=T([]),n=T(1),P=T(20),E=T(0),F=T(!1),h=T(null),H=T([{id:1,original_prompt:"请分析以下产品文档，提取产品的基本信息、技术规格、产品特性等关键信息。",optimized_prompt:"请仔细分析以下产品文档，系统性地提取并整理产品的基本信息（名称、型号、代码）、详细技术规格（性能参数、技术指标）、以及产品特性（功能亮点、应用场景）等关键信息。请确保信息的准确性和完整性。",optimization_type:"结构优化",improvement_score:85,status:"success",created_at:"2024-08-16 14:30:25",suggestions_applied:[{type:"清晰度",title:"增强指令明确性",description:'在原始prompt基础上增加了"系统性地"、"详细"等修饰词，使指令更加明确',expected_impact:25},{type:"完整性",title:"补充质量要求",description:'添加了"确保信息的准确性和完整性"的质量要求',expected_impact:20}]},{id:2,original_prompt:"对文档进行质量评估",optimized_prompt:"请对以下文档进行全面的质量评估，从内容完整性、信息准确性、结构清晰度、语言规范性四个维度进行系统分析，并提供具体的评分依据和改进建议。",optimization_type:"语义增强",improvement_score:92,status:"success",created_at:"2024-08-15 09:15:12",suggestions_applied:[{type:"具体化",title:"明确评估维度",description:'将模糊的"质量评估"具体化为四个明确的评估维度',expected_impact:40},{type:"输出规范",title:"规范输出要求",description:"要求提供评分依据和改进建议，使输出更加有价值",expected_impact:30}]},{id:3,original_prompt:"分析文档类型",optimized_prompt:"请分析以下文档内容，基于文档的结构特征、内容主题、专业术语使用情况等因素，准确识别文档类型（如：产品说明书、技术规范、用户手册、测试报告等），并说明判断依据。",optimization_type:"上下文增强",improvement_score:78,status:"processing",created_at:"2024-08-16 16:20:08",suggestions_applied:[{type:"方法论",title:"增加分析方法",description:"提供了具体的分析维度：结构特征、内容主题、专业术语",expected_impact:35}]}]),O=ve(()=>{let _=H.value;$.value&&(_=_.filter(D=>D.original_prompt.toLowerCase().includes($.value.toLowerCase())||D.optimized_prompt.toLowerCase().includes($.value.toLowerCase()))),S.value&&(_=_.filter(D=>D.status===S.value)),E.value=_.length;const d=(n.value-1)*P.value,Q=d+P.value;return _.slice(d,Q)}),I=a((_,d)=>_.length<=d?_:_.substring(0,d)+"...","truncateText"),u=a(_=>({结构优化:"primary",语义增强:"success",上下文增强:"warning",性能优化:"info"})[_]||"info","getTypeColor"),p=a(_=>_>=80?"#67C23A":_>=60?"#E6A23C":"#F56C6C","getScoreColor"),B=a(_=>({success:"success",processing:"warning",failed:"danger"})[_]||"info","getStatusType"),f=a(_=>({success:"优化成功",processing:"优化中",failed:"优化失败"})[_]||_,"getStatusText"),c=a(()=>{n.value=1},"handleSearch"),J=a(()=>{n.value=1},"handleDateChange"),y=a(_=>{P.value=_,n.value=1},"handleSizeChange"),o=a(_=>{n.value=_},"handleCurrentChange"),l=a(()=>ee(this,null,function*(){U.value=!0;try{yield new Promise(_=>setTimeout(_,1e3)),q.success("历史记录已刷新")}catch(_){q.error("刷新失败")}finally{U.value=!1}}),"refreshHistory"),M=a(_=>{h.value=_,F.value=!0,b("record-selected",_)},"viewRecord"),L=a(_=>{q.success("已应用优化记录 #".concat(_.id," 的Prompt"))},"applyOptimization"),v=a(_=>ee(this,null,function*(){try{yield re.confirm("确定要删除优化记录 #".concat(_.id," 吗？此操作不可恢复。"),"确认删除",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning"});const d=H.value.findIndex(Q=>Q.id===_.id);d>-1&&(H.value.splice(d,1),q.success("删除成功"))}catch(d){}}),"deleteRecord");return ie(()=>{l()}),(_,d)=>{const Q=ce,D=ke,X=fe,Z=ge,w=pt,N=de,x=Ve,G=Ne,le=ue,he=Te,z=He,K=Me,A=Ue,me=xe,Se=be,Ke=qe;return g(),V("div",Rs,[d[17]||(d[17]=e("div",{class:"history-header"},[e("h3",null,"优化历史"),e("p",null,"查看历史Prompt优化记录和效果对比")],-1)),e("div",Is,[t(x,{gutter:16},{default:s(()=>[t(D,{span:6},{default:s(()=>[t(Q,{modelValue:$.value,"onUpdate:modelValue":d[0]||(d[0]=C=>$.value=C),placeholder:"搜索优化记录...",clearable:"",onChange:c},null,8,["modelValue"])]),_:1}),t(D,{span:4},{default:s(()=>[t(Z,{modelValue:S.value,"onUpdate:modelValue":d[1]||(d[1]=C=>S.value=C),placeholder:"状态",clearable:""},{default:s(()=>[t(X,{label:"全部",value:""}),t(X,{label:"优化成功",value:"success"}),t(X,{label:"优化中",value:"processing"}),t(X,{label:"优化失败",value:"failed"})]),_:1},8,["modelValue"])]),_:1}),t(D,{span:6},{default:s(()=>[t(w,{modelValue:i.value,"onUpdate:modelValue":d[2]||(d[2]=C=>i.value=C),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",onChange:J},null,8,["modelValue"])]),_:1}),t(D,{span:4},{default:s(()=>[t(N,{type:"primary",onClick:l},{default:s(()=>d[9]||(d[9]=[m("刷新",-1)])),_:1,__:[9]})]),_:1})]),_:1})]),Ae((g(),te(z,{data:O.value},{default:s(()=>[t(G,{prop:"id",label:"ID",width:"80"}),t(G,{prop:"original_prompt",label:"原始Prompt","min-width":"300"},{default:s(C=>[e("div",Ds,r(I(C.row.original_prompt,100)),1)]),_:1}),t(G,{prop:"optimization_type",label:"优化类型",width:"120"},{default:s(C=>[t(le,{type:u(C.row.optimization_type),size:"small"},{default:s(()=>[m(r(C.row.optimization_type),1)]),_:2},1032,["type"])]),_:1}),t(G,{prop:"improvement_score",label:"改进评分",width:"100"},{default:s(C=>[e("div",Fs,[t(he,{type:"circle",percentage:C.row.improvement_score,width:40,"stroke-width":6,color:p(C.row.improvement_score)},null,8,["percentage","color"])])]),_:1}),t(G,{prop:"status",label:"状态",width:"100"},{default:s(C=>[t(le,{type:B(C.row.status)},{default:s(()=>[m(r(f(C.row.status)),1)]),_:2},1032,["type"])]),_:1}),t(G,{prop:"created_at",label:"创建时间",width:"180"}),t(G,{label:"操作",width:"200"},{default:s(C=>[t(N,{size:"small",onClick:a(_e=>M(C.row),"onClick")},{default:s(()=>d[10]||(d[10]=[m(" 查看详情 ",-1)])),_:2,__:[10]},1032,["onClick"]),t(N,{size:"small",type:"primary",onClick:a(_e=>L(C.row),"onClick")},{default:s(()=>d[11]||(d[11]=[m(" 应用优化 ",-1)])),_:2,__:[11]},1032,["onClick"]),t(N,{size:"small",type:"danger",onClick:a(_e=>v(C.row),"onClick")},{default:s(()=>d[12]||(d[12]=[m(" 删除 ",-1)])),_:2,__:[12]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[Ke,U.value]]),e("div",As,[t(K,{"current-page":n.value,"onUpdate:currentPage":d[3]||(d[3]=C=>n.value=C),"page-size":P.value,"onUpdate:pageSize":d[4]||(d[4]=C=>P.value=C),total:E.value,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:y,onCurrentChange:o},null,8,["current-page","page-size","total"])]),t(Se,{modelValue:F.value,"onUpdate:modelValue":d[7]||(d[7]=C=>F.value=C),title:"优化记录详情",width:"80%",onClose:d[8]||(d[8]=C=>h.value=null)},{default:s(()=>[h.value?(g(),V("div",qs,[t(me,null,{default:s(()=>[t(A,{label:"基本信息",name:"basic"},{default:s(()=>[e("div",Bs,[e("div",Ms,[d[13]||(d[13]=e("label",null,"优化ID:",-1)),e("span",null,r(h.value.id),1)]),e("div",Ls,[d[14]||(d[14]=e("label",null,"优化类型:",-1)),t(le,{type:u(h.value.optimization_type)},{default:s(()=>[m(r(h.value.optimization_type),1)]),_:1},8,["type"])]),e("div",js,[d[15]||(d[15]=e("label",null,"改进评分:",-1)),e("span",Ns,r(h.value.improvement_score)+"%",1)]),e("div",Hs,[d[16]||(d[16]=e("label",null,"创建时间:",-1)),e("span",null,r(h.value.created_at),1)])])]),_:1}),t(A,{label:"原始Prompt",name:"original"},{default:s(()=>[t(Q,{modelValue:h.value.original_prompt,"onUpdate:modelValue":d[5]||(d[5]=C=>h.value.original_prompt=C),type:"textarea",rows:10,readonly:""},null,8,["modelValue"])]),_:1}),t(A,{label:"优化后Prompt",name:"optimized"},{default:s(()=>[t(Q,{modelValue:h.value.optimized_prompt,"onUpdate:modelValue":d[6]||(d[6]=C=>h.value.optimized_prompt=C),type:"textarea",rows:10,readonly:""},null,8,["modelValue"])]),_:1}),t(A,{label:"优化建议",name:"suggestions"},{default:s(()=>[e("div",Js,[(g(!0),V(W,null,Y(h.value.suggestions_applied,(C,_e)=>(g(),V("div",{key:_e,class:"suggestion-item"},[e("div",Ks,[t(le,{size:"small"},{default:s(()=>[m(r(C.type),1)]),_:2},1024)]),e("div",Qs,[e("h4",null,r(C.title),1),e("p",null,r(C.description),1),e("div",Xs,[e("span",null,"预期影响: "+r(C.expected_impact)+"%",1)])])]))),128))])]),_:1})]),_:1})])):se("",!0)]),_:1},8,["modelValue"])])}}}),Ws=oe(Gs,[["__scopeId","data-v-94aaf5b3"]]),Ys={class:"optimization-metrics"},Zs={class:"metrics-summary"},el={class:"metric-item"},tl={class:"metric-content"},sl={class:"metric-value"},ll={class:"metric-item"},al={class:"metric-content"},ol={class:"metric-value"},nl={class:"metric-item"},il={class:"metric-content"},rl={class:"metric-value"},dl={class:"metric-item"},ul={class:"metric-content"},cl={class:"metric-value"},pl={class:"charts-section"},ml={class:"chart-container"},_l={class:"chart-placeholder"},vl={class:"chart-container"},gl={class:"chart-placeholder"},fl={class:"chart-container"},yl={class:"chart-placeholder"},bl={class:"detailed-stats"},hl={class:"stats-header"},wl={class:"improvement-score"},$l=ne({__name:"OptimizationMetrics",setup(R){const k=T({totalOptimizations:456,avgImprovement:73.8,avgOptimizationTime:28.5,successRate:87.2}),b=T([{category:"结构优化",count:159,avgImprovement:78.5,avgTime:25.2,successRate:89,userSatisfaction:4.2,lastUsed:"2024-08-16 16:30:25"},{category:"语义增强",count:128,avgImprovement:82.3,avgTime:32.1,successRate:91,userSatisfaction:4.5,lastUsed:"2024-08-16 15:45:12"},{category:"上下文增强",count:100,avgImprovement:67.1,avgTime:28.8,successRate:83,userSatisfaction:4,lastUsed:"2024-08-16 14:20:08"},{category:"性能优化",count:69,avgImprovement:65.4,avgTime:35.3,successRate:85,userSatisfaction:4.1,lastUsed:"2024-08-16 13:15:45"}]),U=a(i=>({结构优化:"primary",语义增强:"success",上下文增强:"warning",性能优化:"info"})[i]||"info","getCategoryColor"),$=a(i=>i>=85?"#67C23A":i>=70?"#409EFF":i>=50?"#E6A23C":"#F56C6C","getProgressColor"),S=a(()=>{q.success("统计数据导出功能开发中...")},"exportStats");return ie(()=>{}),(i,n)=>{const P=pe,E=ye,F=ke,h=Ve,H=de,O=ue,I=Ne,u=Te,p=Ce,B=He;return g(),V("div",Ys,[n[15]||(n[15]=e("div",{class:"metrics-header"},[e("h3",null,"优化效果统计"),e("p",null,"Prompt优化的整体效果分析和性能指标")],-1)),e("div",Zs,[t(h,{gutter:20},{default:s(()=>[t(F,{span:6},{default:s(()=>[t(E,{class:"metric-card"},{default:s(()=>[e("div",el,[t(P,{class:"metric-icon"},{default:s(()=>[t(j(De))]),_:1}),e("div",tl,[e("div",sl,r(k.value.totalOptimizations),1),n[0]||(n[0]=e("div",{class:"metric-label"},"总优化次数",-1))])])]),_:1})]),_:1}),t(F,{span:6},{default:s(()=>[t(E,{class:"metric-card"},{default:s(()=>[e("div",ll,[t(P,{class:"metric-icon success"},{default:s(()=>[t(j(mt))]),_:1}),e("div",al,[e("div",ol,r(k.value.avgImprovement)+"%",1),n[1]||(n[1]=e("div",{class:"metric-label"},"平均改进度",-1))])])]),_:1})]),_:1}),t(F,{span:6},{default:s(()=>[t(E,{class:"metric-card"},{default:s(()=>[e("div",nl,[t(P,{class:"metric-icon warning"},{default:s(()=>[t(j(_t))]),_:1}),e("div",il,[e("div",rl,r(k.value.avgOptimizationTime)+"s",1),n[2]||(n[2]=e("div",{class:"metric-label"},"平均优化时长",-1))])])]),_:1})]),_:1}),t(F,{span:6},{default:s(()=>[t(E,{class:"metric-card"},{default:s(()=>[e("div",dl,[t(P,{class:"metric-icon info"},{default:s(()=>[t(j(vt))]),_:1}),e("div",ul,[e("div",cl,r(k.value.successRate)+"%",1),n[3]||(n[3]=e("div",{class:"metric-label"},"优化成功率",-1))])])]),_:1})]),_:1})]),_:1})]),e("div",pl,[t(h,{gutter:20},{default:s(()=>[t(F,{span:12},{default:s(()=>[t(E,null,{header:s(()=>n[4]||(n[4]=[e("h4",null,"优化类型分布",-1)])),default:s(()=>[e("div",ml,[e("div",_l,[t(P,null,{default:s(()=>[t(j(gt))]),_:1}),n[5]||(n[5]=e("p",null,"优化类型饼图",-1)),n[6]||(n[6]=e("div",{class:"chart-data"},[e("div",{class:"data-item"},[e("span",{class:"data-dot",style:{"background-color":"#409EFF"}}),e("span",null,"结构优化: 35%")]),e("div",{class:"data-item"},[e("span",{class:"data-dot",style:{"background-color":"#67C23A"}}),e("span",null,"语义增强: 28%")]),e("div",{class:"data-item"},[e("span",{class:"data-dot",style:{"background-color":"#E6A23C"}}),e("span",null,"上下文增强: 22%")]),e("div",{class:"data-item"},[e("span",{class:"data-dot",style:{"background-color":"#F56C6C"}}),e("span",null,"性能优化: 15%")])],-1))])])]),_:1})]),_:1}),t(F,{span:12},{default:s(()=>[t(E,null,{header:s(()=>n[7]||(n[7]=[e("h4",null,"改进效果分布",-1)])),default:s(()=>[e("div",vl,[e("div",gl,[t(P,null,{default:s(()=>[t(j(ft))]),_:1}),n[8]||(n[8]=e("p",null,"改进效果柱状图",-1)),n[9]||(n[9]=e("div",{class:"bar-chart-data"},[e("div",{class:"bar-item"},[e("div",{class:"bar-label"},"优秀(80-100%)"),e("div",{class:"bar-container"},[e("div",{class:"bar-fill",style:{width:"65%","background-color":"#67C23A"}}),e("span",{class:"bar-value"},"65%")])]),e("div",{class:"bar-item"},[e("div",{class:"bar-label"},"良好(60-79%)"),e("div",{class:"bar-container"},[e("div",{class:"bar-fill",style:{width:"25%","background-color":"#409EFF"}}),e("span",{class:"bar-value"},"25%")])]),e("div",{class:"bar-item"},[e("div",{class:"bar-label"},"一般(40-59%)"),e("div",{class:"bar-container"},[e("div",{class:"bar-fill",style:{width:"8%","background-color":"#E6A23C"}}),e("span",{class:"bar-value"},"8%")])]),e("div",{class:"bar-item"},[e("div",{class:"bar-label"},"较差(<40%)"),e("div",{class:"bar-container"},[e("div",{class:"bar-fill",style:{width:"2%","background-color":"#F56C6C"}}),e("span",{class:"bar-value"},"2%")])])],-1))])])]),_:1})]),_:1})]),_:1}),t(h,{gutter:20,style:{"margin-top":"20px"}},{default:s(()=>[t(F,{span:24},{default:s(()=>[t(E,null,{header:s(()=>n[10]||(n[10]=[e("h4",null,"优化趋势",-1)])),default:s(()=>[e("div",fl,[e("div",yl,[t(P,null,{default:s(()=>[t(j(De))]),_:1}),n[11]||(n[11]=e("p",null,"优化次数和成功率趋势图",-1)),n[12]||(n[12]=e("div",{class:"trend-data"},[e("div",{class:"trend-line"},[e("span",null,"优化次数呈稳定上升趋势，近30天平均每天4.2次优化")]),e("div",{class:"trend-line"},[e("span",null,"优化成功率保持在85%以上，整体质量稳定")]),e("div",{class:"trend-line"},[e("span",null,"用户满意度评分平均4.3/5.0，持续改善中")])],-1))])])]),_:1})]),_:1})]),_:1})]),e("div",bl,[t(E,null,{header:s(()=>[e("div",hl,[n[14]||(n[14]=e("h4",null,"分类统计详情",-1)),t(H,{size:"small",onClick:S},{default:s(()=>n[13]||(n[13]=[m("导出数据",-1)])),_:1,__:[13]})])]),default:s(()=>[t(B,{data:b.value},{default:s(()=>[t(I,{prop:"category",label:"优化类型",width:"150"},{default:s(f=>[t(O,{type:U(f.row.category)},{default:s(()=>[m(r(f.row.category),1)]),_:2},1032,["type"])]),_:1}),t(I,{prop:"count",label:"次数",width:"100"}),t(I,{prop:"avgImprovement",label:"平均改进度",width:"120"},{default:s(f=>[e("span",wl,r(f.row.avgImprovement)+"%",1)]),_:1}),t(I,{prop:"avgTime",label:"平均时长(s)",width:"120"}),t(I,{prop:"successRate",label:"成功率",width:"100"},{default:s(f=>[t(u,{percentage:f.row.successRate,"stroke-width":8,color:$(f.row.successRate)},null,8,["percentage","color"])]),_:1}),t(I,{prop:"userSatisfaction",label:"用户满意度",width:"120"},{default:s(f=>[t(p,{modelValue:f.row.userSatisfaction,"onUpdate:modelValue":a(c=>f.row.userSatisfaction=c,"onUpdate:modelValue"),max:5,disabled:"",size:"small","show-score":"","text-color":"#ff9900"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(I,{prop:"lastUsed",label:"最近使用",width:"180"})]),_:1},8,["data"])]),_:1})])])}}}),zl=oe($l,[["__scopeId","data-v-ca120e05"]]),Cl={class:"optimization-result"},Vl={class:"result-header"},kl={class:"result-title"},Tl={class:"result-meta"},xl={class:"suggestions-section"},Ul={class:"suggestions-header"},Sl={class:"suggestion-stats"},Pl={class:"suggestions-list"},El={class:"suggestion-header"},Ol={class:"suggestion-type"},Rl={class:"impact-score"},Il={class:"suggestion-toggle"},Dl={class:"suggestion-content"},Fl={class:"suggestion-description"},Al={class:"suggestion-details"},ql={class:"detail-item"},Bl={class:"code-block"},Ml={class:"detail-item"},Ll={class:"code-block improved"},jl={class:"detail-item"},Nl={class:"expected-effect"},Hl={class:"optimized-section"},Jl={class:"prompt-comparison"},Kl={class:"prompt-block"},Ql={class:"prompt-arrow"},Xl={class:"prompt-block"},Gl={class:"improvement-summary"},Wl={class:"improvement-stats"},Yl={class:"stat-item"},Zl={class:"stat-item"},ea={class:"stat-item"},ta={class:"risk-section"},sa={class:"risk-overview"},la={class:"risk-level"},aa={class:"risk-description"},oa={key:0,class:"risk-factors"},na={class:"factor-header"},ia={class:"factor-score"},ra={class:"factor-description"},da={key:1,class:"mitigation-suggestions"},ua={class:"mitigation-list"},ca={class:"result-actions"},pa=ne({__name:"OptimizationResult",props:{result:{}},emits:["apply-suggestions","save-template","close"],setup(R,{emit:k}){const b=R,U=k,$=T("suggestions"),S=T("请分析以下产品文档，提取产品的基本信息、技术规格、产品特性等关键信息。"),i=ve(()=>b.result.suggestions.filter(u=>u.selected)),n=a(u=>({清晰度:"primary",完整性:"success",具体化:"warning",结构化:"info",上下文:"danger"})[u]||"info","getSuggestionTypeColor"),P=a(u=>u>=80?"#67C23A":u>=60?"#E6A23C":"#F56C6C","getScoreColor"),E=a(u=>({low:"success",medium:"warning",high:"danger"})[u]||"info","getRiskTypeColor"),F=a(u=>({low:"低风险",medium:"中等风险",high:"高风险"})[u]||u,"getRiskText"),h=a(()=>{if(i.value.length===0)return 0;const u=i.value.reduce((p,B)=>p+B.impact_score,0);return Math.round(u/i.value.length*10)},"calculateExpectedImprovement"),H=a(()=>{},"updateSelectedSuggestions"),O=a(()=>ee(this,null,function*(){if(i.value.length===0){q.warning("请至少选择一条优化建议");return}try{yield re.confirm("确定要应用选中的 ".concat(i.value.length," 条优化建议吗？"),"确认应用",{confirmButtonText:"应用",cancelButtonText:"取消",type:"warning"}),U("apply-suggestions",b.result.optimized_prompt)}catch(u){}}),"applySuggestions"),I=a(()=>ee(this,null,function*(){try{yield re.prompt("请输入模板名称","保存为模板",{confirmButtonText:"保存",cancelButtonText:"取消",inputPattern:/\S+/,inputErrorMessage:"模板名称不能为空"});const u={name:"基于优化结果的模板",content:b.result.optimized_prompt,type:"optimized",description:"基于优化ID ".concat(b.result.optimization_id," 生成的模板")};U("save-template",u)}catch(u){}}),"saveAsTemplate");return ie(()=>{b.result.suggestions.forEach(u=>{u.impact_score>=8&&(u.selected=!0)})}),(u,p)=>{const B=ue,f=yt,c=Ue,J=ce,y=pe,o=Te,l=ye,M=xe,L=de;return g(),V("div",Cl,[e("div",Vl,[e("div",kl,[p[4]||(p[4]=e("h3",null,"优化结果",-1)),t(B,{type:u.result.success?"success":"danger",size:"large"},{default:s(()=>[m(r(u.result.success?"优化成功":"优化失败"),1)]),_:1},8,["type"])]),e("div",Tl,[e("span",null,"优化ID: "+r(u.result.optimization_id),1),e("span",null,"改进评分: "+r(u.result.improvement_score)+"%",1),e("span",null,"处理时长: "+r(u.result.metadata.analysis_duration)+"s",1)])]),t(M,{modelValue:$.value,"onUpdate:modelValue":p[2]||(p[2]=v=>$.value=v),class:"result-tabs"},{default:s(()=>[t(c,{label:"优化建议",name:"suggestions"},{default:s(()=>[e("div",xl,[e("div",Ul,[e("h4",null,"AI生成的优化建议 ("+r(u.result.suggestions.length)+"条)",1),e("div",Sl,[t(B,{type:"danger",size:"small"},{default:s(()=>[m(" 高影响: "+r(u.result.metadata.high_impact_suggestions)+"条 ",1)]),_:1})])]),e("div",Pl,[(g(!0),V(W,null,Y(u.result.suggestions,(v,_)=>(g(),V("div",{key:_,class:Ze(["suggestion-card",{"high-impact":v.impact_score>=8}])},[e("div",El,[e("div",Ol,[t(B,{type:n(v.type),size:"small"},{default:s(()=>[m(r(v.type),1)]),_:2},1032,["type"]),e("span",Rl," 影响力: "+r(v.impact_score)+"/10 ",1)]),e("div",Il,[t(f,{modelValue:v.selected,"onUpdate:modelValue":a(d=>v.selected=d,"onUpdate:modelValue"),onChange:H},null,8,["modelValue","onUpdate:modelValue"])])]),e("div",Dl,[e("h5",null,r(v.title),1),e("p",Fl,r(v.description),1),e("div",Al,[e("div",ql,[p[5]||(p[5]=e("label",null,"原始文本:",-1)),e("code",Bl,r(v.original_text),1)]),e("div",Ml,[p[6]||(p[6]=e("label",null,"建议修改:",-1)),e("code",Ll,r(v.suggested_text),1)]),e("div",jl,[p[7]||(p[7]=e("label",null,"预期效果:",-1)),e("span",Nl,r(v.expected_improvement),1)])])])],2))),128))])])]),_:1}),t(c,{label:"优化结果",name:"optimized"},{default:s(()=>[e("div",Hl,[e("div",Jl,[e("div",Kl,[p[8]||(p[8]=e("h4",null,"原始Prompt",-1)),t(J,{modelValue:S.value,"onUpdate:modelValue":p[0]||(p[0]=v=>S.value=v),type:"textarea",rows:8,readonly:"",class:"prompt-textarea"},null,8,["modelValue"])]),e("div",Ql,[t(y,{size:"24"},{default:s(()=>[t(j(bt))]),_:1})]),e("div",Xl,[p[9]||(p[9]=e("h4",null,"优化后Prompt",-1)),t(J,{modelValue:u.result.optimized_prompt,"onUpdate:modelValue":p[1]||(p[1]=v=>u.result.optimized_prompt=v),type:"textarea",rows:8,readonly:"",class:"prompt-textarea optimized"},null,8,["modelValue"])])]),e("div",Gl,[t(l,null,{header:s(()=>p[10]||(p[10]=[e("h4",null,"改进摘要",-1)])),default:s(()=>[e("div",Wl,[e("div",Yl,[p[11]||(p[11]=e("label",null,"改进评分:",-1)),t(o,{percentage:u.result.improvement_score,color:P(u.result.improvement_score),"stroke-width":8},null,8,["percentage","color"])]),e("div",Zl,[p[12]||(p[12]=e("label",null,"应用建议:",-1)),e("span",null,r(i.value.length)+"/"+r(u.result.suggestions.length)+" 条",1)]),e("div",ea,[p[13]||(p[13]=e("label",null,"预期提升:",-1)),e("span",null,r(h())+"%",1)])])]),_:1})])])]),_:1}),t(c,{label:"风险评估",name:"risk"},{default:s(()=>[e("div",ta,[e("div",sa,[t(l,null,{header:s(()=>p[14]||(p[14]=[e("h4",null,"整体风险评估",-1)])),default:s(()=>[e("div",la,[t(B,{type:E(u.result.risk_assessment.overall_risk),size:"large"},{default:s(()=>[m(r(F(u.result.risk_assessment.overall_risk)),1)]),_:1},8,["type"]),e("p",aa," 基于优化内容和历史数据，该优化的风险级别为"+r(F(u.result.risk_assessment.overall_risk)),1)])]),_:1})]),u.result.risk_assessment.risk_factors.length>0?(g(),V("div",oa,[p[15]||(p[15]=e("h4",null,"风险因子",-1)),(g(!0),V(W,null,Y(u.result.risk_assessment.risk_factors,(v,_)=>(g(),V("div",{key:_,class:"risk-factor-item"},[e("div",na,[t(B,{type:E(v.level),size:"small"},{default:s(()=>[m(r(v.category),1)]),_:2},1032,["type"]),e("span",ia,r(v.score)+"/10",1)]),e("p",ra,r(v.description),1)]))),128))])):se("",!0),u.result.risk_assessment.mitigation_suggestions.length>0?(g(),V("div",da,[p[16]||(p[16]=e("h4",null,"风险缓解建议",-1)),e("ul",ua,[(g(!0),V(W,null,Y(u.result.risk_assessment.mitigation_suggestions,(v,_)=>(g(),V("li",{key:_,class:"mitigation-item"},r(v),1))),128))])])):se("",!0)])]),_:1})]),_:1},8,["modelValue"]),e("div",ca,[t(L,{onClick:p[3]||(p[3]=v=>u.$emit("close"))},{default:s(()=>p[17]||(p[17]=[m(" 关闭 ",-1)])),_:1,__:[17]}),t(L,{type:"info",onClick:I},{default:s(()=>p[18]||(p[18]=[m(" 保存为模板 ",-1)])),_:1,__:[18]}),t(L,{type:"primary",onClick:O,disabled:i.value.length===0},{default:s(()=>[m(" 应用选中建议 ("+r(i.value.length)+") ",1)]),_:1},8,["disabled"])])])}}}),ma=oe(pa,[["__scopeId","data-v-f759e493"]]),_a={class:"prompt-optimization"},va=ne({__name:"PromptOptimization",setup(R){const k=T("optimize"),b=T(!1),U=T(null),$=T(0);et("refreshTrigger",$);const S=a(O=>{U.value=O,b.value=!0,ht({title:"优化完成",message:"成功生成 ".concat(O.suggestions.length," 条优化建议"),type:"success",duration:4e3}),$.value++},"handleOptimizationSuccess"),i=a(O=>{q.error("优化失败: ".concat(O))},"handleOptimizationError"),n=a(O=>{q.success('模板 "'.concat(O.name,'" 保存成功')),$.value++},"handleTemplateSaved"),P=a(O=>{U.value={success:!0,optimization_id:O.id,suggestions:[],optimized_prompt:O.optimized_prompt,improvement_score:O.improvement_score,risk_assessment:{overall_risk:"low",risk_factors:[],mitigation_suggestions:[]},metadata:{analysis_duration:0,total_suggestions:O.suggestions_applied.length,high_impact_suggestions:0}},b.value=!0},"handleRecordSelected"),E=a(O=>{q.success("优化建议已应用"),b.value=!1,$.value++},"handleApplySuggestions"),F=a(O=>{q.success("已保存为模板"),k.value="templates",b.value=!1,$.value++},"handleSaveAsTemplate"),h=a(()=>{b.value=!1,U.value=null},"handleCloseDialog"),H=a(()=>{$.value++},"loadTemplates");return ie(()=>{q.info("Prompt优化系统已就绪，请选择功能开始使用")}),(O,I)=>{const u=Ue,p=xe,B=be;return g(),V("div",_a,[I[2]||(I[2]=e("div",{class:"page-header"},[e("h1",null,"Prompt优化管理"),e("p",{class:"page-description"},"基于历史数据优化AI提示词，提升分析准确性和用户满意度")],-1)),t(p,{modelValue:k.value,"onUpdate:modelValue":I[0]||(I[0]=f=>k.value=f),class:"optimization-tabs"},{default:s(()=>[t(u,{label:"智能优化",name:"optimize"},{default:s(()=>[t(_s,{onOptimizationSuccess:S,onOptimizationError:i})]),_:1}),t(u,{label:"模板管理",name:"templates"},{default:s(()=>[t(Os,{onTemplateSaved:n,onTemplateDeleted:H})]),_:1}),t(u,{label:"优化历史",name:"history"},{default:s(()=>[t(Ws,{onRecordSelected:P})]),_:1}),t(u,{label:"效果统计",name:"metrics"},{default:s(()=>[t(zl)]),_:1})]),_:1},8,["modelValue"]),t(B,{modelValue:b.value,"onUpdate:modelValue":I[1]||(I[1]=f=>b.value=f),title:"优化结果详情",width:"80%","before-close":h},{default:s(()=>[U.value?(g(),te(ma,{key:0,result:U.value,onApplySuggestions:E,onSaveTemplate:F},null,8,["result"])):se("",!0)]),_:1},8,["modelValue"])])}}}),La=oe(va,[["__scopeId","data-v-098081ab"]]);export{La as default};
