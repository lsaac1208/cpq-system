var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,o=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t,n=(e,a)=>{for(var l in a||(a={}))s.call(a,l)&&o(e,l,a[l]);if(t)for(var l of t(a))i.call(a,l)&&o(e,l,a[l]);return e},r=(e,t)=>a(e,l(t)),c=(e,a,l)=>new Promise((t,s)=>{var i=e=>{try{n(l.next(e))}catch(a){s(a)}},o=e=>{try{n(l.throw(e))}catch(a){s(a)}},n=e=>e.done?t(e.value):Promise.resolve(e.value).then(i,o);n((l=l.apply(e,a)).next())});import{i as u,U as d,j as p,u as m,_ as v,I as _,a as g,f,d as y,W as h,be as b,a2 as w,E as V,y as z,z as k,p as x,v as C,C as U,D as P,F as O,G as T,o as I,a3 as S,b as j,g as R,aS as q,bf as A,aU as E,aV as F,h as D,Y as L,$ as B,t as M,a1 as J,ag as K,ah as N,a7 as $,bg as G,a6 as H,m as Q,aP as W,bh as Y,S as Z,bi as X,ai as ee}from"./element-plus-DR0qywX_.js";import{s as ae}from"./utils-BjNHK8wL.js";import{z as le,r as te,Z as se,b as ie,w as oe,l as ne,A as re,C as ce,L as ue,M as de,S as pe,u as me,K as ve,R as _e,a8 as ge,J as fe,P as ye,Q as he,B as be,a6 as we,F as Ve,x as ze}from"./vue-BMWQU0Ry.js";import{w as ke,x as xe}from"./api-BHu6TLr6.js";import{_ as Ce}from"./page-aianalysisenhanced.vue-9uq21fmn.js";const Ue={class:"template-selector"},Pe={class:"selector-header"},Oe={class:"template-list"},Te={key:0,class:"empty-state"},Ie=["onClick"],Se={class:"template-header"},je={class:"template-name"},Re={class:"template-badges"},qe={class:"template-description"},Ae={class:"template-content-preview"},Ee={class:"template-tags"},Fe={key:0,class:"more-tags"},De={class:"template-stats"},Le={class:"stat-item"},Be={class:"stat-item"},Me={class:"stat-item"},Je={class:"template-meta"},Ke={class:"created-at"},Ne={class:"version"},$e={key:0,class:"pagination-container"},Ge={class:"selector-actions"},He=Ce(le({__name:"TemplateSelector",emits:["template-selected","close"],setup(e,{emit:a}){const l=a,t=te(!1),s=te(""),i=te(""),o=te(""),r=te(null),V=te([]),z=te([]),k=te([]),x=se({page:1,per_page:10,total:0,pages:0}),C=ie(()=>{let e=V.value;if(s.value){const a=s.value.toLowerCase();e=e.filter(e=>e.name.toLowerCase().includes(a)||e.description.toLowerCase().includes(a)||e.template_content.toLowerCase().includes(a))}return i.value&&(e=e.filter(e=>e.category===i.value)),o.value&&(e=e.filter(e=>e.tags.includes(o.value))),e}),U=()=>c(this,null,function*(){try{t.value=!0;const e=n(n({page:x.page,per_page:x.per_page},i.value&&{category:i.value}),o.value&&{tag:o.value}),a=yield ke(e);if(!a.success)throw new Error("加载模板失败");V.value=a.templates,z.value=a.categories,k.value=a.popular_tags,Object.assign(x,a.pagination)}catch(e){ae.error("加载模板失败")}finally{t.value=!1}}),P=()=>{r.value&&l("template-selected",r.value)},O=()=>{s.value="",i.value="",o.value="",x.page=1,U()},T=e=>{x.per_page=e,x.page=1,U()},I=e=>{x.page=e,U()};return oe([i,o],()=>{x.page=1,U()}),oe(s,()=>{}),ne(()=>{U()}),(e,a)=>{const l=u,n=m,c=p,V=g,U=_,S=f,j=y,R=b,q=w,A=v;return be(),re("div",Ue,[ce("div",Pe,[pe(l,{modelValue:s.value,"onUpdate:modelValue":a[0]||(a[0]=e=>s.value=e),placeholder:"搜索模板...","prefix-icon":me(d),style:{width:"300px"},clearable:""},null,8,["modelValue","prefix-icon"]),pe(c,{modelValue:i.value,"onUpdate:modelValue":a[1]||(a[1]=e=>i.value=e),placeholder:"选择分类",clearable:"",style:{width:"200px","margin-left":"15px"}},{default:ve(()=>[(be(!0),re(_e,null,ge(z.value,e=>(be(),fe(n,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),pe(c,{modelValue:o.value,"onUpdate:modelValue":a[2]||(a[2]=e=>o.value=e),placeholder:"选择标签",clearable:"",style:{width:"200px","margin-left":"15px"}},{default:ve(()=>[(be(!0),re(_e,null,ge(k.value,e=>(be(),fe(n,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),ue((be(),re("div",Oe,[0===C.value.length?(be(),re("div",Te,[pe(U,{description:"未找到匹配的模板"},{default:ve(()=>[pe(V,{type:"primary",onClick:O},{default:ve(()=>a[6]||(a[6]=[ye("清除筛选条件",-1)])),_:1,__:[6]})]),_:1})])):de("",!0),(be(!0),re(_e,null,ge(C.value,e=>{return be(),re("div",{key:e.id,class:"template-item",onClick:a=>(e=>{r.value=e})(e)},[ce("div",Se,[ce("h4",je,he(e.name),1),ce("div",Re,[pe(S,{size:"small",type:"info"},{default:ve(()=>[ye(he(e.category),1)]),_:2},1024),e.is_public?(be(),fe(S,{key:0,size:"small",type:"success"},{default:ve(()=>a[7]||(a[7]=[ye("公开",-1)])),_:1,__:[7]})):(be(),fe(S,{key:1,size:"small",type:"warning"},{default:ve(()=>a[8]||(a[8]=[ye("私有",-1)])),_:1,__:[8]}))])]),ce("p",qe,he(e.description),1),ce("div",Ae,[ce("code",null,he((t=e.template_content,t.length<=200?t:t.substring(0,200)+"...")),1)]),ce("div",Ee,[(be(!0),re(_e,null,ge(e.tags.slice(0,3),e=>(be(),fe(S,{key:e,size:"small",effect:"plain"},{default:ve(()=>[ye(he(e),1)]),_:2},1024))),128)),e.tags.length>3?(be(),re("span",Fe," +"+he(e.tags.length-3),1)):de("",!0)]),ce("div",De,[ce("span",Le,[pe(j,null,{default:ve(()=>[pe(me(h))]),_:1}),ye(" 使用 "+he(e.usage_count)+" 次 ",1)]),ce("span",Be,[pe(R,{modelValue:e.average_rating,"onUpdate:modelValue":a=>e.average_rating=a,disabled:"","show-score":"",max:5,size:"small"},null,8,["modelValue","onUpdate:modelValue"])]),ce("span",Me," 成功率 "+he((100*e.success_rate).toFixed(0))+"% ",1)]),ce("div",Je,[ce("span",Ke," 创建于 "+he((l=e.created_at,new Date(l).toLocaleDateString("zh-CN"))),1),ce("span",Ne,"v"+he(e.version),1)])],8,Ie);var l,t}),128))])),[[A,t.value]]),x.total>0?(be(),re("div",$e,[pe(q,{"current-page":x.page,"onUpdate:currentPage":a[3]||(a[3]=e=>x.page=e),"page-size":x.per_page,"onUpdate:pageSize":a[4]||(a[4]=e=>x.per_page=e),"page-sizes":[10,20,50],total:x.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:T,onCurrentChange:I},null,8,["current-page","page-size","total"])])):de("",!0),ce("div",Ge,[pe(V,{onClick:a[5]||(a[5]=a=>e.$emit("close"))},{default:ve(()=>a[9]||(a[9]=[ye("取消",-1)])),_:1,__:[9]}),pe(V,{type:"primary",disabled:!r.value,onClick:P},{default:ve(()=>a[10]||(a[10]=[ye(" 选择模板 ",-1)])),_:1,__:[10]},8,["disabled"])])])}}}),[["__scopeId","data-v-7efe0985"]]),Qe={class:"prompt-optimizer"},We={class:"historical-data-section"},Ye={class:"section-header"},Ze={key:0,class:"empty-state"},Xe={class:"case-header"},ea={class:"case-title"},aa={class:"case-meta"},la={class:"historical-data-section"},ta={class:"section-header"},sa={key:0,class:"empty-state"},ia={class:"case-header"},oa={class:"case-title"},na={class:"case-meta"},ra={class:"weight-config"},ca={class:"weight-item"},ua={class:"weight-item"},da={class:"weight-item"},pa={class:"weight-item"},ma={class:"action-buttons"},va={class:"examples"},_a=["onClick"],ga=Ce(le({__name:"PromptOptimizer",emits:["optimization-success","optimization-error"],setup(e,{emit:a}){const l=a,t=te(),s=te(!1),i=te(!1),o=se({current_prompt:"",historical_data:{success_cases:[],failure_cases:[]},optimization_goals:[],target_domain:"",priority_weights:{accuracy:.3,clarity:.3,efficiency:.2,user_satisfaction:.2}}),r=te({}),d={current_prompt:[{required:!0,message:"请输入当前Prompt",trigger:"blur"},{min:10,message:"Prompt至少需要10个字符",trigger:"blur"}],optimization_goals:[{required:!0,message:"请选择至少一个优化目标",trigger:"change"}]},v=ie(()=>o.current_prompt.trim().length>=10&&o.optimization_goals.length>0),h=[{title:"产品文档分析",description:"用于分析产品规格文档的Prompt优化示例",domain:"product_analysis",data:{current_prompt:"请分析以下产品文档，提取产品名称、规格参数、价格信息和主要特性",optimization_goals:["accuracy","consistency"],target_domain:"product_analysis"}},{title:"数据提取优化",description:"提升结构化数据提取准确性的示例",domain:"data_extraction",data:{current_prompt:"从文档中提取结构化数据，包括表格、列表和关键信息",optimization_goals:["accuracy","efficiency"],target_domain:"data_extraction"}},{title:"质量评估增强",description:"改进内容质量评估的Prompt示例",domain:"quality_assessment",data:{current_prompt:"评估文档质量，包括完整性、准确性和一致性",optimization_goals:["clarity","user_satisfaction"],target_domain:"quality_assessment"}}],w=()=>{o.historical_data.success_cases.push({prompt:"",result_quality:5,user_feedback:"",metadata:{}})},R=()=>{const e=o.historical_data.failure_cases.length;o.historical_data.failure_cases.push({prompt:"",issues:[],user_feedback:"",metadata:{}}),r.value[e]=""},q=e=>{var a;const l=null==(a=r.value[e])?void 0:a.trim();l&&(o.historical_data.failure_cases[e].issues.push(l),r.value[e]="")},A=()=>c(this,null,function*(){if(t.value)try{yield t.value.validate(),s.value=!0;const e=yield xe(o);if(!e.success)throw new Error(e.error||"优化失败");l("optimization-success",e),ae.success("Prompt优化完成！")}catch(e){const a=e instanceof Error?e.message:"优化过程中发生错误";l("optimization-error",a),ae.error(a)}finally{s.value=!1}}),E=()=>{t.value&&j.confirm("确定要重置表单吗？所有输入的数据将丢失。","确认重置",{type:"warning"}).then(()=>{var e;null==(e=t.value)||e.resetFields(),o.historical_data.success_cases=[],o.historical_data.failure_cases=[],o.optimization_goals=[],o.target_domain="",r.value={},ae.success("表单已重置")}).catch(()=>{})},F=()=>{i.value=!0},D=e=>{o.current_prompt=e.template_content,e.category&&(o.target_domain=e.category),i.value=!1,ae.success("已加载模板：".concat(e.name))};return ne(()=>{r.value={}}),(e,a)=>{const l=u,c=k,L=g,B=_,M=b,J=f,K=P,N=U,$=m,G=p,H=O,Q=y,W=z,Y=V,Z=S;return be(),re("div",Qe,[pe(Y,{class:"optimizer-card"},{header:ve(()=>a[9]||(a[9]=[ce("div",{class:"card-header"},[ce("h3",null,"智能Prompt优化"),ce("p",null,"输入当前Prompt和历史数据，获得AI驱动的优化建议")],-1)])),default:ve(()=>[pe(W,{ref_key:"formRef",ref:t,model:o,rules:d,"label-width":"120px",class:"optimizer-form"},{default:ve(()=>[pe(c,{label:"当前Prompt",prop:"current_prompt",required:""},{default:ve(()=>[pe(l,{modelValue:o.current_prompt,"onUpdate:modelValue":a[0]||(a[0]=e=>o.current_prompt=e),type:"textarea",rows:6,placeholder:"请输入需要优化的Prompt...","show-word-limit":"",maxlength:"2000"},null,8,["modelValue"]),a[10]||(a[10]=ce("div",{class:"form-tip"}," 提示：详细描述当前使用的Prompt，包括指令、参数和期望的输出格式 ",-1))]),_:1,__:[10]}),pe(c,{label:"成功案例"},{default:ve(()=>[ce("div",We,[ce("div",Ye,[a[12]||(a[12]=ce("span",null,"历史成功案例",-1)),pe(L,{type:"primary",size:"small",onClick:w,icon:me(x)},{default:ve(()=>a[11]||(a[11]=[ye(" 添加案例 ",-1)])),_:1,__:[11]},8,["icon"])]),0===o.historical_data.success_cases.length?(be(),re("div",Ze,[pe(B,{description:"暂无成功案例，点击上方按钮添加"},{default:ve(()=>[pe(L,{type:"primary",onClick:w},{default:ve(()=>a[13]||(a[13]=[ye("添加成功案例",-1)])),_:1,__:[13]})]),_:1})])):de("",!0),(be(!0),re(_e,null,ge(o.historical_data.success_cases,(e,a)=>(be(),re("div",{key:"success-".concat(a),class:"case-item success-case"},[ce("div",Xe,[ce("span",ea,"成功案例 #"+he(a+1),1),pe(L,{type:"danger",size:"small",text:"",onClick:e=>(e=>{o.historical_data.success_cases.splice(e,1)})(a),icon:me(C)},null,8,["onClick","icon"])]),pe(l,{modelValue:e.prompt,"onUpdate:modelValue":a=>e.prompt=a,type:"textarea",rows:3,placeholder:"输入成功的Prompt...",class:"case-input"},null,8,["modelValue","onUpdate:modelValue"]),ce("div",aa,[pe(M,{modelValue:e.result_quality,"onUpdate:modelValue":a=>e.result_quality=a,max:5,"show-score":"","text-color":"#ff9900","score-template":"质量: {value}"},null,8,["modelValue","onUpdate:modelValue"]),pe(l,{modelValue:e.user_feedback,"onUpdate:modelValue":a=>e.user_feedback=a,placeholder:"用户反馈...",size:"small",style:{width:"200px","margin-left":"15px"}},null,8,["modelValue","onUpdate:modelValue"])])]))),128))])]),_:1}),pe(c,{label:"失败案例"},{default:ve(()=>[ce("div",la,[ce("div",ta,[a[15]||(a[15]=ce("span",null,"历史失败案例",-1)),pe(L,{type:"warning",size:"small",onClick:R,icon:me(x)},{default:ve(()=>a[14]||(a[14]=[ye(" 添加案例 ",-1)])),_:1,__:[14]},8,["icon"])]),0===o.historical_data.failure_cases.length?(be(),re("div",sa,[pe(B,{description:"暂无失败案例，点击上方按钮添加"},{default:ve(()=>[pe(L,{type:"warning",onClick:R},{default:ve(()=>a[16]||(a[16]=[ye("添加失败案例",-1)])),_:1,__:[16]})]),_:1})])):de("",!0),(be(!0),re(_e,null,ge(o.historical_data.failure_cases,(e,t)=>(be(),re("div",{key:"failure-".concat(t),class:"case-item failure-case"},[ce("div",ia,[ce("span",oa,"失败案例 #"+he(t+1),1),pe(L,{type:"danger",size:"small",text:"",onClick:e=>(e=>{o.historical_data.failure_cases.splice(e,1),delete r.value[e]})(t),icon:me(C)},null,8,["onClick","icon"])]),pe(l,{modelValue:e.prompt,"onUpdate:modelValue":a=>e.prompt=a,type:"textarea",rows:3,placeholder:"输入失败的Prompt...",class:"case-input"},null,8,["modelValue","onUpdate:modelValue"]),ce("div",na,[(be(!0),re(_e,null,ge(e.issues,(e,a)=>(be(),fe(J,{key:a,type:"danger",size:"small",closable:"",onClose:e=>((e,a)=>{o.historical_data.failure_cases[e].issues.splice(a,1)})(t,a),style:{"margin-right":"5px"}},{default:ve(()=>[ye(he(e),1)]),_:2},1032,["onClose"]))),128)),pe(l,{modelValue:r.value[t],"onUpdate:modelValue":e=>r.value[t]=e,placeholder:"添加问题...",size:"small",style:{width:"120px","margin-right":"10px"},onKeyup:we(e=>q(t),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"]),pe(L,{size:"small",type:"primary",text:"",onClick:e=>q(t)},{default:ve(()=>a[17]||(a[17]=[ye(" 添加问题 ",-1)])),_:2,__:[17]},1032,["onClick"])]),pe(l,{modelValue:e.user_feedback,"onUpdate:modelValue":a=>e.user_feedback=a,placeholder:"用户反馈...",size:"small",style:{"margin-top":"10px"}},null,8,["modelValue","onUpdate:modelValue"])]))),128))])]),_:1}),pe(c,{label:"优化目标",prop:"optimization_goals",required:""},{default:ve(()=>[pe(N,{modelValue:o.optimization_goals,"onUpdate:modelValue":a[1]||(a[1]=e=>o.optimization_goals=e),class:"goal-checkboxes"},{default:ve(()=>[pe(K,{label:"accuracy"},{default:ve(()=>a[18]||(a[18]=[ye("提升准确性",-1)])),_:1,__:[18]}),pe(K,{label:"clarity"},{default:ve(()=>a[19]||(a[19]=[ye("增强清晰度",-1)])),_:1,__:[19]}),pe(K,{label:"efficiency"},{default:ve(()=>a[20]||(a[20]=[ye("提高效率",-1)])),_:1,__:[20]}),pe(K,{label:"user_satisfaction"},{default:ve(()=>a[21]||(a[21]=[ye("用户满意度",-1)])),_:1,__:[21]}),pe(K,{label:"consistency"},{default:ve(()=>a[22]||(a[22]=[ye("保持一致性",-1)])),_:1,__:[22]}),pe(K,{label:"robustness"},{default:ve(()=>a[23]||(a[23]=[ye("增强鲁棒性",-1)])),_:1,__:[23]})]),_:1},8,["modelValue"])]),_:1}),pe(c,{label:"目标领域"},{default:ve(()=>[pe(G,{modelValue:o.target_domain,"onUpdate:modelValue":a[2]||(a[2]=e=>o.target_domain=e),placeholder:"选择应用领域",clearable:"",style:{width:"200px"}},{default:ve(()=>[pe($,{label:"产品分析",value:"product_analysis"}),pe($,{label:"文档解析",value:"document_parsing"}),pe($,{label:"数据提取",value:"data_extraction"}),pe($,{label:"质量评估",value:"quality_assessment"}),pe($,{label:"内容生成",value:"content_generation"}),pe($,{label:"通用分析",value:"general_analysis"})]),_:1},8,["modelValue"])]),_:1}),pe(c,{label:"权重配置"},{default:ve(()=>[ce("div",ra,[ce("div",ca,[a[24]||(a[24]=ce("span",null,"准确性",-1)),pe(H,{modelValue:o.priority_weights.accuracy,"onUpdate:modelValue":a[3]||(a[3]=e=>o.priority_weights.accuracy=e),min:0,max:1,step:.1,"show-stops":"","show-input":"","input-size":"small",style:{width:"300px"}},null,8,["modelValue"])]),ce("div",ua,[a[25]||(a[25]=ce("span",null,"清晰度",-1)),pe(H,{modelValue:o.priority_weights.clarity,"onUpdate:modelValue":a[4]||(a[4]=e=>o.priority_weights.clarity=e),min:0,max:1,step:.1,"show-stops":"","show-input":"","input-size":"small",style:{width:"300px"}},null,8,["modelValue"])]),ce("div",da,[a[26]||(a[26]=ce("span",null,"效率",-1)),pe(H,{modelValue:o.priority_weights.efficiency,"onUpdate:modelValue":a[5]||(a[5]=e=>o.priority_weights.efficiency=e),min:0,max:1,step:.1,"show-stops":"","show-input":"","input-size":"small",style:{width:"300px"}},null,8,["modelValue"])]),ce("div",pa,[a[27]||(a[27]=ce("span",null,"用户满意度",-1)),pe(H,{modelValue:o.priority_weights.user_satisfaction,"onUpdate:modelValue":a[6]||(a[6]=e=>o.priority_weights.user_satisfaction=e),min:0,max:1,step:.1,"show-stops":"","show-input":"","input-size":"small",style:{width:"300px"}},null,8,["modelValue"])])])]),_:1}),pe(c,null,{default:ve(()=>[ce("div",ma,[pe(L,{type:"primary",size:"large",loading:s.value,onClick:A,disabled:!v.value},{icon:ve(()=>[pe(Q,null,{default:ve(()=>[pe(me(T))]),_:1})]),default:ve(()=>[a[28]||(a[28]=ye(" 开始优化 ",-1))]),_:1,__:[28]},8,["loading","disabled"]),pe(L,{size:"large",onClick:E},{default:ve(()=>a[29]||(a[29]=[ye(" 重置表单 ",-1)])),_:1,__:[29]}),pe(L,{type:"success",size:"large",onClick:F},{icon:ve(()=>[pe(Q,null,{default:ve(()=>[pe(me(I))]),_:1})]),default:ve(()=>[a[30]||(a[30]=ye(" 加载模板 ",-1))]),_:1,__:[30]})])]),_:1})]),_:1},8,["model"])]),_:1}),pe(Y,{class:"example-card"},{header:ve(()=>a[31]||(a[31]=[ce("h3",null,"快速示例",-1)])),default:ve(()=>[ce("div",va,[(be(),re(_e,null,ge(h,e=>ce("div",{key:e.title,class:"example-item",onClick:a=>(e=>{j.confirm("确定要加载此示例吗？当前表单数据将被替换。","确认加载示例",{type:"info"}).then(()=>{Object.assign(o,n(n({},o),e.data)),ae.success("已加载示例：".concat(e.title))}).catch(()=>{})})(e)},[ce("h4",null,he(e.title),1),ce("p",null,he(e.description),1),pe(J,{size:"small",type:"info"},{default:ve(()=>[ye(he(e.domain),1)]),_:2},1024)],8,_a)),64))])]),_:1}),pe(Z,{modelValue:i.value,"onUpdate:modelValue":a[8]||(a[8]=e=>i.value=e),title:"选择Prompt模板",width:"70%"},{default:ve(()=>[pe(He,{onTemplateSelected:D,onClose:a[7]||(a[7]=e=>i.value=!1)})]),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-0dec8c74"]]),fa={class:"prompt-template-manager"},ya={class:"manager-header"},ha={class:"templates-list"},ba={class:"template-header"},wa={class:"template-name"},Va={class:"template-content"},za={class:"template-meta"},ka={class:"template-usage"},xa={class:"template-description"},Ca={class:"template-preview"},Ua={class:"template-stats"},Pa={class:"stat-item"},Oa={class:"stat-value"},Ta={class:"stat-item"},Ia={class:"stat-value"},Sa={class:"template-actions"},ja={class:"dialog-footer"},Ra=Ce(le({__name:"PromptTemplateManager",emits:["template-saved","template-used"],setup(e,{emit:a}){const l=a,t=te(!1),s=te(null),i=te(!1),o=te(),d=se({name:"",type:"",description:"",content:"",expectedOutput:""}),v={name:[{required:!0,message:"请输入模板名称",trigger:"blur"}],type:[{required:!0,message:"请选择模板类型",trigger:"change"}],description:[{required:!0,message:"请输入模板描述",trigger:"blur"}],content:[{required:!0,message:"请输入Prompt内容",trigger:"blur"},{min:50,message:"Prompt内容至少50个字符",trigger:"blur"}]},_=te([{id:1,name:"产品规格提取模板",type:"产品信息提取",description:"专门用于提取产品技术规格和基本信息的模板",content:'请分析以下产品文档，提取产品的基本信息、技术规格、产品特性等关键信息。\n\n文档内容：{document}\n\n请按照以下JSON格式返回结果：\n{\n  "basic_info": {\n    "name": "产品名称",\n    "code": "产品代码",\n    "category": "产品类别"\n  },\n  "specifications": {},\n  "features": []\n}',expectedOutput:"JSON格式的产品信息",usageCount:156,successRate:94,avgTime:45.2},{id:2,name:"文档质量评估模板",type:"质量评估",description:"评估文档的完整性、准确性和可用性",content:"请对以下文档进行质量评估，从完整性、准确性、可读性等维度进行分析。\n\n文档内容：{document}\n\n评估要求：{requirements}\n\n请提供详细的评估报告和改进建议。",expectedOutput:"质量评估报告和改进建议",usageCount:89,successRate:87,avgTime:62.1},{id:3,name:"技术文档分类模板",type:"文档分类",description:"自动识别和分类技术文档类型",content:"请分析以下文档并确定其类型和类别。\n\n文档内容：{document}\n\n上下文信息：{context}\n\n请判断文档类型并提供分类依据。",expectedOutput:"文档分类结果和分类依据",usageCount:234,successRate:91,avgTime:28.5}]),h=e=>{const[a,l]=e.split("-"),t=_.value.find(e=>e.id===parseInt(l));if(t)switch(a){case"edit":b(t);break;case"copy":w(t);break;case"delete":C(t)}},b=e=>{s.value=e,Object.assign(d,e),t.value=!0},w=e=>{const a=r(n({},e),{id:Date.now(),name:"".concat(e.name," - 副本"),usageCount:0});_.value.push(a),ae.success("模板复制成功")},C=e=>c(this,null,function*(){try{yield j.confirm('确定要删除模板"'.concat(e.name,'"吗？此操作不可恢复。'),"确认删除",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning"});const a=_.value.findIndex(a=>a.id===e.id);a>-1&&(_.value.splice(a,1),ae.success("模板删除成功"))}catch(a){}}),U=()=>c(this,null,function*(){if(o.value)try{if(yield o.value.validate(),i.value=!0,yield new Promise(e=>setTimeout(e,1e3)),s.value)Object.assign(s.value,d),ae.success("模板更新成功");else{const e=r(n({},d),{id:Date.now(),usageCount:0,successRate:0,avgTime:0});_.value.push(e),ae.success("模板创建成功")}l("template-saved"),t.value=!1,P()}catch(e){}finally{i.value=!1}}),P=()=>{s.value=null,Object.assign(d,{name:"",type:"",description:"",content:"",expectedOutput:""}),o.value&&o.value.clearValidate()};return ne(()=>{}),(e,a)=>{const n=y,r=g,c=F,w=E,C=q,O=f,T=u,I=V,j=D,L=R,B=k,M=m,J=p,K=z,N=S;return be(),re("div",fa,[ce("div",ya,[a[9]||(a[9]=ce("h3",null,"Prompt模板管理",-1)),a[10]||(a[10]=ce("p",null,"管理和编辑AI分析的Prompt模板，提升分析效果",-1)),pe(r,{type:"primary",onClick:a[0]||(a[0]=e=>t.value=!0)},{default:ve(()=>[pe(n,null,{default:ve(()=>[pe(me(x))]),_:1}),a[8]||(a[8]=ye(" 新建模板 ",-1))]),_:1,__:[8]})]),ce("div",ha,[pe(L,{gutter:20},{default:ve(()=>[(be(!0),re(_e,null,ge(_.value,e=>(be(),fe(j,{key:e.id,span:8},{default:ve(()=>[pe(I,{class:"template-card",shadow:"hover"},{header:ve(()=>[ce("div",ba,[ce("span",wa,he(e.name),1),pe(C,{onCommand:h},{dropdown:ve(()=>[pe(w,null,{default:ve(()=>[pe(c,{command:"edit-".concat(e.id)},{default:ve(()=>a[11]||(a[11]=[ye(" 编辑 ",-1)])),_:2,__:[11]},1032,["command"]),pe(c,{command:"copy-".concat(e.id)},{default:ve(()=>a[12]||(a[12]=[ye(" 复制 ",-1)])),_:2,__:[12]},1032,["command"]),pe(c,{command:"delete-".concat(e.id),divided:""},{default:ve(()=>a[13]||(a[13]=[ye(" 删除 ",-1)])),_:2,__:[13]},1032,["command"])]),_:2},1024)]),default:ve(()=>[pe(r,{text:"",size:"small"},{default:ve(()=>[pe(n,null,{default:ve(()=>[pe(me(A))]),_:1})]),_:1})]),_:2},1024)])]),default:ve(()=>{return[ce("div",Va,[ce("div",za,[pe(O,{type:(t=e.type,{"产品信息提取":"primary","质量评估":"success","文档分类":"warning","技术规格分析":"info","综合分析":"danger"}[t]||"info"),size:"small"},{default:ve(()=>[ye(he(e.type),1)]),_:2},1032,["type"]),ce("span",ka,"使用次数: "+he(e.usageCount),1)]),ce("div",xa,he(e.description),1),ce("div",Ca,[pe(T,{modelValue:e.content,"onUpdate:modelValue":a=>e.content=a,type:"textarea",rows:3,readonly:"",resize:"none"},null,8,["modelValue","onUpdate:modelValue"])]),ce("div",Ua,[ce("div",Pa,[a[14]||(a[14]=ce("span",{class:"stat-label"},"成功率:",-1)),ce("span",Oa,he(e.successRate)+"%",1)]),ce("div",Ta,[a[15]||(a[15]=ce("span",{class:"stat-label"},"平均时长:",-1)),ce("span",Ia,he(e.avgTime)+"s",1)])]),ce("div",Sa,[pe(r,{size:"small",onClick:a=>(e=>{l("template-used",e),ae.success("已应用模板：".concat(e.name))})(e)},{default:ve(()=>a[16]||(a[16]=[ye(" 使用模板 ",-1)])),_:2,__:[16]},1032,["onClick"]),pe(r,{size:"small",type:"primary",onClick:a=>b(e)},{default:ve(()=>a[17]||(a[17]=[ye(" 编辑 ",-1)])),_:2,__:[17]},1032,["onClick"])])])];var t}),_:2},1024)]),_:2},1024))),128))]),_:1})]),pe(N,{modelValue:t.value,"onUpdate:modelValue":a[7]||(a[7]=e=>t.value=e),title:s.value?"编辑模板":"新建模板",width:"60%",onClose:P},{footer:ve(()=>[ce("span",ja,[pe(r,{onClick:a[6]||(a[6]=e=>t.value=!1)},{default:ve(()=>a[18]||(a[18]=[ye("取消",-1)])),_:1,__:[18]}),pe(r,{type:"primary",onClick:U,loading:i.value},{default:ve(()=>[ye(he(s.value?"更新":"创建"),1)]),_:1},8,["loading"])])]),default:ve(()=>[pe(K,{ref_key:"templateFormRef",ref:o,model:d,rules:v,"label-width":"100px"},{default:ve(()=>[pe(B,{label:"模板名称",prop:"name"},{default:ve(()=>[pe(T,{modelValue:d.name,"onUpdate:modelValue":a[1]||(a[1]=e=>d.name=e),placeholder:"请输入模板名称"},null,8,["modelValue"])]),_:1}),pe(B,{label:"模板类型",prop:"type"},{default:ve(()=>[pe(J,{modelValue:d.type,"onUpdate:modelValue":a[2]||(a[2]=e=>d.type=e),placeholder:"请选择模板类型"},{default:ve(()=>[pe(M,{label:"产品信息提取",value:"product_extraction"}),pe(M,{label:"技术规格分析",value:"specification_analysis"}),pe(M,{label:"文档分类",value:"document_classification"}),pe(M,{label:"质量评估",value:"quality_assessment"}),pe(M,{label:"综合分析",value:"comprehensive_analysis"})]),_:1},8,["modelValue"])]),_:1}),pe(B,{label:"模板描述",prop:"description"},{default:ve(()=>[pe(T,{modelValue:d.description,"onUpdate:modelValue":a[3]||(a[3]=e=>d.description=e),type:"textarea",rows:3,placeholder:"请输入模板描述"},null,8,["modelValue"])]),_:1}),pe(B,{label:"Prompt内容",prop:"content"},{default:ve(()=>[pe(T,{modelValue:d.content,"onUpdate:modelValue":a[4]||(a[4]=e=>d.content=e),type:"textarea",rows:8,placeholder:"请输入Prompt内容，支持变量：{document}, {context}, {requirements}"},null,8,["modelValue"])]),_:1}),pe(B,{label:"预期输出"},{default:ve(()=>[pe(T,{modelValue:d.expectedOutput,"onUpdate:modelValue":a[5]||(a[5]=e=>d.expectedOutput=e),type:"textarea",rows:4,placeholder:"描述预期的输出格式和内容"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),[["__scopeId","data-v-d2d0c1e5"]]),qa={class:"optimization-history"},Aa={class:"filters"},Ea={class:"prompt-preview"},Fa={class:"score-display"},Da={class:"pagination"},La={key:0,class:"record-detail"},Ba={class:"info-section"},Ma={class:"info-item"},Ja={class:"info-item"},Ka={class:"info-item"},Na={class:"score"},$a={class:"info-item"},Ga={class:"suggestions-list"},Ha={class:"suggestion-type"},Qa={class:"suggestion-content"},Wa={class:"suggestion-impact"},Ya=Ce(le({__name:"OptimizationHistory",emits:["record-selected"],setup(e,{emit:a}){const l=a,t=te(!1),s=te(""),i=te(""),o=te([]),n=te(1),r=te(20),d=te(0),_=te(!1),y=te(null),h=te([{id:1,original_prompt:"请分析以下产品文档，提取产品的基本信息、技术规格、产品特性等关键信息。",optimized_prompt:"请仔细分析以下产品文档，系统性地提取并整理产品的基本信息（名称、型号、代码）、详细技术规格（性能参数、技术指标）、以及产品特性（功能亮点、应用场景）等关键信息。请确保信息的准确性和完整性。",optimization_type:"结构优化",improvement_score:85,status:"success",created_at:"2024-08-16 14:30:25",suggestions_applied:[{type:"清晰度",title:"增强指令明确性",description:'在原始prompt基础上增加了"系统性地"、"详细"等修饰词，使指令更加明确',expected_impact:25},{type:"完整性",title:"补充质量要求",description:'添加了"确保信息的准确性和完整性"的质量要求',expected_impact:20}]},{id:2,original_prompt:"对文档进行质量评估",optimized_prompt:"请对以下文档进行全面的质量评估，从内容完整性、信息准确性、结构清晰度、语言规范性四个维度进行系统分析，并提供具体的评分依据和改进建议。",optimization_type:"语义增强",improvement_score:92,status:"success",created_at:"2024-08-15 09:15:12",suggestions_applied:[{type:"具体化",title:"明确评估维度",description:'将模糊的"质量评估"具体化为四个明确的评估维度',expected_impact:40},{type:"输出规范",title:"规范输出要求",description:"要求提供评分依据和改进建议，使输出更加有价值",expected_impact:30}]},{id:3,original_prompt:"分析文档类型",optimized_prompt:"请分析以下文档内容，基于文档的结构特征、内容主题、专业术语使用情况等因素，准确识别文档类型（如：产品说明书、技术规范、用户手册、测试报告等），并说明判断依据。",optimization_type:"上下文增强",improvement_score:78,status:"processing",created_at:"2024-08-16 16:20:08",suggestions_applied:[{type:"方法论",title:"增加分析方法",description:"提供了具体的分析维度：结构特征、内容主题、专业术语",expected_impact:35}]}]),b=ie(()=>{let e=h.value;s.value&&(e=e.filter(e=>e.original_prompt.toLowerCase().includes(s.value.toLowerCase())||e.optimized_prompt.toLowerCase().includes(s.value.toLowerCase()))),i.value&&(e=e.filter(e=>e.status===i.value)),d.value=e.length;const a=(n.value-1)*r.value,l=a+r.value;return e.slice(a,l)}),V=e=>({"结构优化":"primary","语义增强":"success","上下文增强":"warning","性能优化":"info"}[e]||"info"),z=e=>({success:"优化成功",processing:"优化中",failed:"优化失败"}[e]||e),k=()=>{n.value=1},x=()=>{n.value=1},C=e=>{r.value=e,n.value=1},U=e=>{n.value=e},P=()=>c(this,null,function*(){t.value=!0;try{yield new Promise(e=>setTimeout(e,1e3)),ae.success("历史记录已刷新")}catch(e){ae.error("刷新失败")}finally{t.value=!1}}),O=e=>c(this,null,function*(){try{yield j.confirm("确定要删除优化记录 #".concat(e.id," 吗？此操作不可恢复。"),"确认删除",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning"});const a=h.value.findIndex(a=>a.id===e.id);a>-1&&(h.value.splice(a,1),ae.success("删除成功"))}catch(a){}});return ne(()=>{P()}),(e,a)=>{const c=u,h=D,T=m,I=p,j=L,q=g,A=R,E=B,F=f,$=M,G=J,H=w,Q=N,W=K,Y=S,Z=v;return be(),re("div",qa,[a[17]||(a[17]=ce("div",{class:"history-header"},[ce("h3",null,"优化历史"),ce("p",null,"查看历史Prompt优化记录和效果对比")],-1)),ce("div",Aa,[pe(A,{gutter:16},{default:ve(()=>[pe(h,{span:6},{default:ve(()=>[pe(c,{modelValue:s.value,"onUpdate:modelValue":a[0]||(a[0]=e=>s.value=e),placeholder:"搜索优化记录...",clearable:"",onChange:k},null,8,["modelValue"])]),_:1}),pe(h,{span:4},{default:ve(()=>[pe(I,{modelValue:i.value,"onUpdate:modelValue":a[1]||(a[1]=e=>i.value=e),placeholder:"状态",clearable:""},{default:ve(()=>[pe(T,{label:"全部",value:""}),pe(T,{label:"优化成功",value:"success"}),pe(T,{label:"优化中",value:"processing"}),pe(T,{label:"优化失败",value:"failed"})]),_:1},8,["modelValue"])]),_:1}),pe(h,{span:6},{default:ve(()=>[pe(j,{modelValue:o.value,"onUpdate:modelValue":a[2]||(a[2]=e=>o.value=e),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",onChange:x},null,8,["modelValue"])]),_:1}),pe(h,{span:4},{default:ve(()=>[pe(q,{type:"primary",onClick:P},{default:ve(()=>a[9]||(a[9]=[ye("刷新",-1)])),_:1,__:[9]})]),_:1})]),_:1})]),ue((be(),fe(G,{data:b.value},{default:ve(()=>[pe(E,{prop:"id",label:"ID",width:"80"}),pe(E,{prop:"original_prompt",label:"原始Prompt","min-width":"300"},{default:ve(e=>{return[ce("div",Ea,he((a=e.row.original_prompt,a.length<=100?a:a.substring(0,100)+"...")),1)];var a}),_:1}),pe(E,{prop:"optimization_type",label:"优化类型",width:"120"},{default:ve(e=>[pe(F,{type:V(e.row.optimization_type),size:"small"},{default:ve(()=>[ye(he(e.row.optimization_type),1)]),_:2},1032,["type"])]),_:1}),pe(E,{prop:"improvement_score",label:"改进评分",width:"100"},{default:ve(e=>{return[ce("div",Fa,[pe($,{type:"circle",percentage:e.row.improvement_score,width:40,"stroke-width":6,color:(a=e.row.improvement_score,a>=80?"#67C23A":a>=60?"#E6A23C":"#F56C6C")},null,8,["percentage","color"])])];var a}),_:1}),pe(E,{prop:"status",label:"状态",width:"100"},{default:ve(e=>{return[pe(F,{type:(a=e.row.status,{success:"success",processing:"warning",failed:"danger"}[a]||"info")},{default:ve(()=>[ye(he(z(e.row.status)),1)]),_:2},1032,["type"])];var a}),_:1}),pe(E,{prop:"created_at",label:"创建时间",width:"180"}),pe(E,{label:"操作",width:"200"},{default:ve(e=>[pe(q,{size:"small",onClick:a=>{return t=e.row,y.value=t,_.value=!0,void l("record-selected",t);var t}},{default:ve(()=>a[10]||(a[10]=[ye(" 查看详情 ",-1)])),_:2,__:[10]},1032,["onClick"]),pe(q,{size:"small",type:"primary",onClick:a=>{return l=e.row,void ae.success("已应用优化记录 #".concat(l.id," 的Prompt"));var l}},{default:ve(()=>a[11]||(a[11]=[ye(" 应用优化 ",-1)])),_:2,__:[11]},1032,["onClick"]),pe(q,{size:"small",type:"danger",onClick:a=>O(e.row)},{default:ve(()=>a[12]||(a[12]=[ye(" 删除 ",-1)])),_:2,__:[12]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[Z,t.value]]),ce("div",Da,[pe(H,{"current-page":n.value,"onUpdate:currentPage":a[3]||(a[3]=e=>n.value=e),"page-size":r.value,"onUpdate:pageSize":a[4]||(a[4]=e=>r.value=e),total:d.value,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:C,onCurrentChange:U},null,8,["current-page","page-size","total"])]),pe(Y,{modelValue:_.value,"onUpdate:modelValue":a[7]||(a[7]=e=>_.value=e),title:"优化记录详情",width:"80%",onClose:a[8]||(a[8]=e=>y.value=null)},{default:ve(()=>[y.value?(be(),re("div",La,[pe(W,null,{default:ve(()=>[pe(Q,{label:"基本信息",name:"basic"},{default:ve(()=>[ce("div",Ba,[ce("div",Ma,[a[13]||(a[13]=ce("label",null,"优化ID:",-1)),ce("span",null,he(y.value.id),1)]),ce("div",Ja,[a[14]||(a[14]=ce("label",null,"优化类型:",-1)),pe(F,{type:V(y.value.optimization_type)},{default:ve(()=>[ye(he(y.value.optimization_type),1)]),_:1},8,["type"])]),ce("div",Ka,[a[15]||(a[15]=ce("label",null,"改进评分:",-1)),ce("span",Na,he(y.value.improvement_score)+"%",1)]),ce("div",$a,[a[16]||(a[16]=ce("label",null,"创建时间:",-1)),ce("span",null,he(y.value.created_at),1)])])]),_:1}),pe(Q,{label:"原始Prompt",name:"original"},{default:ve(()=>[pe(c,{modelValue:y.value.original_prompt,"onUpdate:modelValue":a[5]||(a[5]=e=>y.value.original_prompt=e),type:"textarea",rows:10,readonly:""},null,8,["modelValue"])]),_:1}),pe(Q,{label:"优化后Prompt",name:"optimized"},{default:ve(()=>[pe(c,{modelValue:y.value.optimized_prompt,"onUpdate:modelValue":a[6]||(a[6]=e=>y.value.optimized_prompt=e),type:"textarea",rows:10,readonly:""},null,8,["modelValue"])]),_:1}),pe(Q,{label:"优化建议",name:"suggestions"},{default:ve(()=>[ce("div",Ga,[(be(!0),re(_e,null,ge(y.value.suggestions_applied,(e,a)=>(be(),re("div",{key:a,class:"suggestion-item"},[ce("div",Ha,[pe(F,{size:"small"},{default:ve(()=>[ye(he(e.type),1)]),_:2},1024)]),ce("div",Qa,[ce("h4",null,he(e.title),1),ce("p",null,he(e.description),1),ce("div",Wa,[ce("span",null,"预期影响: "+he(e.expected_impact)+"%",1)])])]))),128))])]),_:1})]),_:1})])):de("",!0)]),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-94aaf5b3"]]),Za={class:"optimization-metrics"},Xa={class:"metrics-summary"},el={class:"metric-item"},al={class:"metric-content"},ll={class:"metric-value"},tl={class:"metric-item"},sl={class:"metric-content"},il={class:"metric-value"},ol={class:"metric-item"},nl={class:"metric-content"},rl={class:"metric-value"},cl={class:"metric-item"},ul={class:"metric-content"},dl={class:"metric-value"},pl={class:"charts-section"},ml={class:"chart-container"},vl={class:"chart-placeholder"},_l={class:"chart-container"},gl={class:"chart-placeholder"},fl={class:"chart-container"},yl={class:"chart-placeholder"},hl={class:"detailed-stats"},bl={class:"stats-header"},wl={class:"improvement-score"},Vl=Ce(le({__name:"OptimizationMetrics",setup(e){const a=te({totalOptimizations:456,avgImprovement:73.8,avgOptimizationTime:28.5,successRate:87.2}),l=te([{category:"结构优化",count:159,avgImprovement:78.5,avgTime:25.2,successRate:89,userSatisfaction:4.2,lastUsed:"2024-08-16 16:30:25"},{category:"语义增强",count:128,avgImprovement:82.3,avgTime:32.1,successRate:91,userSatisfaction:4.5,lastUsed:"2024-08-16 15:45:12"},{category:"上下文增强",count:100,avgImprovement:67.1,avgTime:28.8,successRate:83,userSatisfaction:4,lastUsed:"2024-08-16 14:20:08"},{category:"性能优化",count:69,avgImprovement:65.4,avgTime:35.3,successRate:85,userSatisfaction:4.1,lastUsed:"2024-08-16 13:15:45"}]),t=()=>{ae.success("统计数据导出功能开发中...")};return ne(()=>{}),(e,s)=>{const i=y,o=V,n=D,r=R,c=g,u=f,d=B,p=M,m=b,v=J;return be(),re("div",Za,[s[15]||(s[15]=ce("div",{class:"metrics-header"},[ce("h3",null,"优化效果统计"),ce("p",null,"Prompt优化的整体效果分析和性能指标")],-1)),ce("div",Xa,[pe(r,{gutter:20},{default:ve(()=>[pe(n,{span:6},{default:ve(()=>[pe(o,{class:"metric-card"},{default:ve(()=>[ce("div",el,[pe(i,{class:"metric-icon"},{default:ve(()=>[pe(me($))]),_:1}),ce("div",al,[ce("div",ll,he(a.value.totalOptimizations),1),s[0]||(s[0]=ce("div",{class:"metric-label"},"总优化次数",-1))])])]),_:1})]),_:1}),pe(n,{span:6},{default:ve(()=>[pe(o,{class:"metric-card"},{default:ve(()=>[ce("div",tl,[pe(i,{class:"metric-icon success"},{default:ve(()=>[pe(me(G))]),_:1}),ce("div",sl,[ce("div",il,he(a.value.avgImprovement)+"%",1),s[1]||(s[1]=ce("div",{class:"metric-label"},"平均改进度",-1))])])]),_:1})]),_:1}),pe(n,{span:6},{default:ve(()=>[pe(o,{class:"metric-card"},{default:ve(()=>[ce("div",ol,[pe(i,{class:"metric-icon warning"},{default:ve(()=>[pe(me(H))]),_:1}),ce("div",nl,[ce("div",rl,he(a.value.avgOptimizationTime)+"s",1),s[2]||(s[2]=ce("div",{class:"metric-label"},"平均优化时长",-1))])])]),_:1})]),_:1}),pe(n,{span:6},{default:ve(()=>[pe(o,{class:"metric-card"},{default:ve(()=>[ce("div",cl,[pe(i,{class:"metric-icon info"},{default:ve(()=>[pe(me(Q))]),_:1}),ce("div",ul,[ce("div",dl,he(a.value.successRate)+"%",1),s[3]||(s[3]=ce("div",{class:"metric-label"},"优化成功率",-1))])])]),_:1})]),_:1})]),_:1})]),ce("div",pl,[pe(r,{gutter:20},{default:ve(()=>[pe(n,{span:12},{default:ve(()=>[pe(o,null,{header:ve(()=>s[4]||(s[4]=[ce("h4",null,"优化类型分布",-1)])),default:ve(()=>[ce("div",ml,[ce("div",vl,[pe(i,null,{default:ve(()=>[pe(me(W))]),_:1}),s[5]||(s[5]=ce("p",null,"优化类型饼图",-1)),s[6]||(s[6]=ce("div",{class:"chart-data"},[ce("div",{class:"data-item"},[ce("span",{class:"data-dot",style:{"background-color":"#409EFF"}}),ce("span",null,"结构优化: 35%")]),ce("div",{class:"data-item"},[ce("span",{class:"data-dot",style:{"background-color":"#67C23A"}}),ce("span",null,"语义增强: 28%")]),ce("div",{class:"data-item"},[ce("span",{class:"data-dot",style:{"background-color":"#E6A23C"}}),ce("span",null,"上下文增强: 22%")]),ce("div",{class:"data-item"},[ce("span",{class:"data-dot",style:{"background-color":"#F56C6C"}}),ce("span",null,"性能优化: 15%")])],-1))])])]),_:1})]),_:1}),pe(n,{span:12},{default:ve(()=>[pe(o,null,{header:ve(()=>s[7]||(s[7]=[ce("h4",null,"改进效果分布",-1)])),default:ve(()=>[ce("div",_l,[ce("div",gl,[pe(i,null,{default:ve(()=>[pe(me(Y))]),_:1}),s[8]||(s[8]=ce("p",null,"改进效果柱状图",-1)),s[9]||(s[9]=ce("div",{class:"bar-chart-data"},[ce("div",{class:"bar-item"},[ce("div",{class:"bar-label"},"优秀(80-100%)"),ce("div",{class:"bar-container"},[ce("div",{class:"bar-fill",style:{width:"65%","background-color":"#67C23A"}}),ce("span",{class:"bar-value"},"65%")])]),ce("div",{class:"bar-item"},[ce("div",{class:"bar-label"},"良好(60-79%)"),ce("div",{class:"bar-container"},[ce("div",{class:"bar-fill",style:{width:"25%","background-color":"#409EFF"}}),ce("span",{class:"bar-value"},"25%")])]),ce("div",{class:"bar-item"},[ce("div",{class:"bar-label"},"一般(40-59%)"),ce("div",{class:"bar-container"},[ce("div",{class:"bar-fill",style:{width:"8%","background-color":"#E6A23C"}}),ce("span",{class:"bar-value"},"8%")])]),ce("div",{class:"bar-item"},[ce("div",{class:"bar-label"},"较差(<40%)"),ce("div",{class:"bar-container"},[ce("div",{class:"bar-fill",style:{width:"2%","background-color":"#F56C6C"}}),ce("span",{class:"bar-value"},"2%")])])],-1))])])]),_:1})]),_:1})]),_:1}),pe(r,{gutter:20,style:{"margin-top":"20px"}},{default:ve(()=>[pe(n,{span:24},{default:ve(()=>[pe(o,null,{header:ve(()=>s[10]||(s[10]=[ce("h4",null,"优化趋势",-1)])),default:ve(()=>[ce("div",fl,[ce("div",yl,[pe(i,null,{default:ve(()=>[pe(me($))]),_:1}),s[11]||(s[11]=ce("p",null,"优化次数和成功率趋势图",-1)),s[12]||(s[12]=ce("div",{class:"trend-data"},[ce("div",{class:"trend-line"},[ce("span",null,"优化次数呈稳定上升趋势，近30天平均每天4.2次优化")]),ce("div",{class:"trend-line"},[ce("span",null,"优化成功率保持在85%以上，整体质量稳定")]),ce("div",{class:"trend-line"},[ce("span",null,"用户满意度评分平均4.3/5.0，持续改善中")])],-1))])])]),_:1})]),_:1})]),_:1})]),ce("div",hl,[pe(o,null,{header:ve(()=>[ce("div",bl,[s[14]||(s[14]=ce("h4",null,"分类统计详情",-1)),pe(c,{size:"small",onClick:t},{default:ve(()=>s[13]||(s[13]=[ye("导出数据",-1)])),_:1,__:[13]})])]),default:ve(()=>[pe(v,{data:l.value},{default:ve(()=>[pe(d,{prop:"category",label:"优化类型",width:"150"},{default:ve(e=>{return[pe(u,{type:(a=e.row.category,{"结构优化":"primary","语义增强":"success","上下文增强":"warning","性能优化":"info"}[a]||"info")},{default:ve(()=>[ye(he(e.row.category),1)]),_:2},1032,["type"])];var a}),_:1}),pe(d,{prop:"count",label:"次数",width:"100"}),pe(d,{prop:"avgImprovement",label:"平均改进度",width:"120"},{default:ve(e=>[ce("span",wl,he(e.row.avgImprovement)+"%",1)]),_:1}),pe(d,{prop:"avgTime",label:"平均时长(s)",width:"120"}),pe(d,{prop:"successRate",label:"成功率",width:"100"},{default:ve(e=>{return[pe(p,{percentage:e.row.successRate,"stroke-width":8,color:(a=e.row.successRate,a>=85?"#67C23A":a>=70?"#409EFF":a>=50?"#E6A23C":"#F56C6C")},null,8,["percentage","color"])];var a}),_:1}),pe(d,{prop:"userSatisfaction",label:"用户满意度",width:"120"},{default:ve(e=>[pe(m,{modelValue:e.row.userSatisfaction,"onUpdate:modelValue":a=>e.row.userSatisfaction=a,max:5,disabled:"",size:"small","show-score":"","text-color":"#ff9900"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),pe(d,{prop:"lastUsed",label:"最近使用",width:"180"})]),_:1},8,["data"])]),_:1})])])}}}),[["__scopeId","data-v-ca120e05"]]),zl={class:"optimization-result"},kl={class:"result-header"},xl={class:"result-title"},Cl={class:"result-meta"},Ul={class:"suggestions-section"},Pl={class:"suggestions-header"},Ol={class:"suggestion-stats"},Tl={class:"suggestions-list"},Il={class:"suggestion-header"},Sl={class:"suggestion-type"},jl={class:"impact-score"},Rl={class:"suggestion-toggle"},ql={class:"suggestion-content"},Al={class:"suggestion-description"},El={class:"suggestion-details"},Fl={class:"detail-item"},Dl={class:"code-block"},Ll={class:"detail-item"},Bl={class:"code-block improved"},Ml={class:"detail-item"},Jl={class:"expected-effect"},Kl={class:"optimized-section"},Nl={class:"prompt-comparison"},$l={class:"prompt-block"},Gl={class:"prompt-arrow"},Hl={class:"prompt-block"},Ql={class:"improvement-summary"},Wl={class:"improvement-stats"},Yl={class:"stat-item"},Zl={class:"stat-item"},Xl={class:"stat-item"},et={class:"risk-section"},at={class:"risk-overview"},lt={class:"risk-level"},tt={class:"risk-description"},st={key:0,class:"risk-factors"},it={class:"factor-header"},ot={class:"factor-score"},nt={class:"factor-description"},rt={key:1,class:"mitigation-suggestions"},ct={class:"mitigation-list"},ut={class:"result-actions"},dt=Ce(le({__name:"OptimizationResult",props:{result:{}},emits:["apply-suggestions","save-template","close"],setup(e,{emit:a}){const l=e,t=a,s=te("suggestions"),i=te("请分析以下产品文档，提取产品的基本信息、技术规格、产品特性等关键信息。"),o=ie(()=>l.result.suggestions.filter(e=>e.selected)),n=e=>({low:"success",medium:"warning",high:"danger"}[e]||"info"),r=e=>({low:"低风险",medium:"中等风险",high:"高风险"}[e]||e),d=()=>{if(0===o.value.length)return 0;const e=o.value.reduce((e,a)=>e+a.impact_score,0);return Math.round(e/o.value.length*10)},p=()=>{},m=()=>c(this,null,function*(){if(0!==o.value.length)try{yield j.confirm("确定要应用选中的 ".concat(o.value.length," 条优化建议吗？"),"确认应用",{confirmButtonText:"应用",cancelButtonText:"取消",type:"warning"}),t("apply-suggestions",l.result.optimized_prompt)}catch(e){}else ae.warning("请至少选择一条优化建议")}),v=()=>c(this,null,function*(){try{yield j.prompt("请输入模板名称","保存为模板",{confirmButtonText:"保存",cancelButtonText:"取消",inputPattern:/\S+/,inputErrorMessage:"模板名称不能为空"});const e={name:"基于优化结果的模板",content:l.result.optimized_prompt,type:"optimized",description:"基于优化ID ".concat(l.result.optimization_id," 生成的模板")};t("save-template",e)}catch(e){}});return ne(()=>{l.result.suggestions.forEach(e=>{e.impact_score>=8&&(e.selected=!0)})}),(e,a)=>{const l=f,t=Z,c=N,_=u,h=y,b=M,w=V,z=K,k=g;return be(),re("div",zl,[ce("div",kl,[ce("div",xl,[a[4]||(a[4]=ce("h3",null,"优化结果",-1)),pe(l,{type:e.result.success?"success":"danger",size:"large"},{default:ve(()=>[ye(he(e.result.success?"优化成功":"优化失败"),1)]),_:1},8,["type"])]),ce("div",Cl,[ce("span",null,"优化ID: "+he(e.result.optimization_id),1),ce("span",null,"改进评分: "+he(e.result.improvement_score)+"%",1),ce("span",null,"处理时长: "+he(e.result.metadata.analysis_duration)+"s",1)])]),pe(z,{modelValue:s.value,"onUpdate:modelValue":a[2]||(a[2]=e=>s.value=e),class:"result-tabs"},{default:ve(()=>[pe(c,{label:"优化建议",name:"suggestions"},{default:ve(()=>[ce("div",Ul,[ce("div",Pl,[ce("h4",null,"AI生成的优化建议 ("+he(e.result.suggestions.length)+"条)",1),ce("div",Ol,[pe(l,{type:"danger",size:"small"},{default:ve(()=>[ye(" 高影响: "+he(e.result.metadata.high_impact_suggestions)+"条 ",1)]),_:1})])]),ce("div",Tl,[(be(!0),re(_e,null,ge(e.result.suggestions,(e,s)=>{return be(),re("div",{key:s,class:Ve(["suggestion-card",{"high-impact":e.impact_score>=8}])},[ce("div",Il,[ce("div",Sl,[pe(l,{type:(i=e.type,{"清晰度":"primary","完整性":"success","具体化":"warning","结构化":"info","上下文":"danger"}[i]||"info"),size:"small"},{default:ve(()=>[ye(he(e.type),1)]),_:2},1032,["type"]),ce("span",jl," 影响力: "+he(e.impact_score)+"/10 ",1)]),ce("div",Rl,[pe(t,{modelValue:e.selected,"onUpdate:modelValue":a=>e.selected=a,onChange:p},null,8,["modelValue","onUpdate:modelValue"])])]),ce("div",ql,[ce("h5",null,he(e.title),1),ce("p",Al,he(e.description),1),ce("div",El,[ce("div",Fl,[a[5]||(a[5]=ce("label",null,"原始文本:",-1)),ce("code",Dl,he(e.original_text),1)]),ce("div",Ll,[a[6]||(a[6]=ce("label",null,"建议修改:",-1)),ce("code",Bl,he(e.suggested_text),1)]),ce("div",Ml,[a[7]||(a[7]=ce("label",null,"预期效果:",-1)),ce("span",Jl,he(e.expected_improvement),1)])])])],2);var i}),128))])])]),_:1}),pe(c,{label:"优化结果",name:"optimized"},{default:ve(()=>[ce("div",Kl,[ce("div",Nl,[ce("div",$l,[a[8]||(a[8]=ce("h4",null,"原始Prompt",-1)),pe(_,{modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=e=>i.value=e),type:"textarea",rows:8,readonly:"",class:"prompt-textarea"},null,8,["modelValue"])]),ce("div",Gl,[pe(h,{size:"24"},{default:ve(()=>[pe(me(X))]),_:1})]),ce("div",Hl,[a[9]||(a[9]=ce("h4",null,"优化后Prompt",-1)),pe(_,{modelValue:e.result.optimized_prompt,"onUpdate:modelValue":a[1]||(a[1]=a=>e.result.optimized_prompt=a),type:"textarea",rows:8,readonly:"",class:"prompt-textarea optimized"},null,8,["modelValue"])])]),ce("div",Ql,[pe(w,null,{header:ve(()=>a[10]||(a[10]=[ce("h4",null,"改进摘要",-1)])),default:ve(()=>{return[ce("div",Wl,[ce("div",Yl,[a[11]||(a[11]=ce("label",null,"改进评分:",-1)),pe(b,{percentage:e.result.improvement_score,color:(l=e.result.improvement_score,l>=80?"#67C23A":l>=60?"#E6A23C":"#F56C6C"),"stroke-width":8},null,8,["percentage","color"])]),ce("div",Zl,[a[12]||(a[12]=ce("label",null,"应用建议:",-1)),ce("span",null,he(o.value.length)+"/"+he(e.result.suggestions.length)+" 条",1)]),ce("div",Xl,[a[13]||(a[13]=ce("label",null,"预期提升:",-1)),ce("span",null,he(d())+"%",1)])])];var l}),_:1})])])]),_:1}),pe(c,{label:"风险评估",name:"risk"},{default:ve(()=>[ce("div",et,[ce("div",at,[pe(w,null,{header:ve(()=>a[14]||(a[14]=[ce("h4",null,"整体风险评估",-1)])),default:ve(()=>[ce("div",lt,[pe(l,{type:n(e.result.risk_assessment.overall_risk),size:"large"},{default:ve(()=>[ye(he(r(e.result.risk_assessment.overall_risk)),1)]),_:1},8,["type"]),ce("p",tt," 基于优化内容和历史数据，该优化的风险级别为"+he(r(e.result.risk_assessment.overall_risk)),1)])]),_:1})]),e.result.risk_assessment.risk_factors.length>0?(be(),re("div",st,[a[15]||(a[15]=ce("h4",null,"风险因子",-1)),(be(!0),re(_e,null,ge(e.result.risk_assessment.risk_factors,(e,a)=>(be(),re("div",{key:a,class:"risk-factor-item"},[ce("div",it,[pe(l,{type:n(e.level),size:"small"},{default:ve(()=>[ye(he(e.category),1)]),_:2},1032,["type"]),ce("span",ot,he(e.score)+"/10",1)]),ce("p",nt,he(e.description),1)]))),128))])):de("",!0),e.result.risk_assessment.mitigation_suggestions.length>0?(be(),re("div",rt,[a[16]||(a[16]=ce("h4",null,"风险缓解建议",-1)),ce("ul",ct,[(be(!0),re(_e,null,ge(e.result.risk_assessment.mitigation_suggestions,(e,a)=>(be(),re("li",{key:a,class:"mitigation-item"},he(e),1))),128))])])):de("",!0)])]),_:1})]),_:1},8,["modelValue"]),ce("div",ut,[pe(k,{onClick:a[3]||(a[3]=a=>e.$emit("close"))},{default:ve(()=>a[17]||(a[17]=[ye(" 关闭 ",-1)])),_:1,__:[17]}),pe(k,{type:"info",onClick:v},{default:ve(()=>a[18]||(a[18]=[ye(" 保存为模板 ",-1)])),_:1,__:[18]}),pe(k,{type:"primary",onClick:m,disabled:0===o.value.length},{default:ve(()=>[ye(" 应用选中建议 ("+he(o.value.length)+") ",1)]),_:1},8,["disabled"])])])}}}),[["__scopeId","data-v-f759e493"]]),pt={class:"prompt-optimization"},mt=le({__name:"PromptOptimization",setup(e){const a=te("optimize"),l=te(!1),t=te(null),s=te(0);ze("refreshTrigger",s);const i=e=>{t.value=e,l.value=!0,ee({title:"优化完成",message:"成功生成 ".concat(e.suggestions.length," 条优化建议"),type:"success",duration:4e3}),s.value++},o=e=>{ae.error("优化失败: ".concat(e))},n=e=>{ae.success('模板 "'.concat(e.name,'" 保存成功')),s.value++},r=e=>{t.value={success:!0,optimization_id:e.id,suggestions:[],optimized_prompt:e.optimized_prompt,improvement_score:e.improvement_score,risk_assessment:{overall_risk:"low",risk_factors:[],mitigation_suggestions:[]},metadata:{analysis_duration:0,total_suggestions:e.suggestions_applied.length,high_impact_suggestions:0}},l.value=!0},c=e=>{ae.success("优化建议已应用"),l.value=!1,s.value++},u=e=>{ae.success("已保存为模板"),a.value="templates",l.value=!1,s.value++},d=()=>{l.value=!1,t.value=null},p=()=>{s.value++};return ne(()=>{ae.info("Prompt优化系统已就绪，请选择功能开始使用")}),(e,s)=>{const m=N,v=K,_=S;return be(),re("div",pt,[s[2]||(s[2]=ce("div",{class:"page-header"},[ce("h1",null,"Prompt优化管理"),ce("p",{class:"page-description"},"基于历史数据优化AI提示词，提升分析准确性和用户满意度")],-1)),pe(v,{modelValue:a.value,"onUpdate:modelValue":s[0]||(s[0]=e=>a.value=e),class:"optimization-tabs"},{default:ve(()=>[pe(m,{label:"智能优化",name:"optimize"},{default:ve(()=>[pe(ga,{onOptimizationSuccess:i,onOptimizationError:o})]),_:1}),pe(m,{label:"模板管理",name:"templates"},{default:ve(()=>[pe(Ra,{onTemplateSaved:n,onTemplateDeleted:p})]),_:1}),pe(m,{label:"优化历史",name:"history"},{default:ve(()=>[pe(Ya,{onRecordSelected:r})]),_:1}),pe(m,{label:"效果统计",name:"metrics"},{default:ve(()=>[pe(Vl)]),_:1})]),_:1},8,["modelValue"]),pe(_,{modelValue:l.value,"onUpdate:modelValue":s[1]||(s[1]=e=>l.value=e),title:"优化结果详情",width:"80%","before-close":d},{default:ve(()=>[t.value?(be(),fe(dt,{key:0,result:t.value,onApplySuggestions:c,onSaveTemplate:u},null,8,["result"])):de("",!0)]),_:1},8,["modelValue"])])}}});export{mt as _};
