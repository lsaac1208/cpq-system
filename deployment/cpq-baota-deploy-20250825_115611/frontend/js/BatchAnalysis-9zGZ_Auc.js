var et=Object.defineProperty,yt=Object.defineProperties;var bt=Object.getOwnPropertyDescriptors;var Qe=Object.getOwnPropertySymbols;var ht=Object.prototype.hasOwnProperty,wt=Object.prototype.propertyIsEnumerable;var Ze=(K,z,V)=>z in K?et(K,z,{enumerable:!0,configurable:!0,writable:!0,value:V}):K[z]=V,Fe=(K,z)=>{for(var V in z||(z={}))ht.call(z,V)&&Ze(K,V,z[V]);if(Qe)for(var V of Qe(z))wt.call(z,V)&&Ze(K,V,z[V]);return K},tt=(K,z)=>yt(K,bt(z)),i=(K,z)=>et(K,"name",{value:z,configurable:!0});var Z=(K,z,V)=>new Promise((J,M)=>{var T=D=>{try{w(V.next(D))}catch(R){M(R)}},n=D=>{try{w(V.throw(D))}catch(R){M(R)}},w=D=>D.done?J(D.value):Promise.resolve(D.value).then(T,n);w((V=V.apply(K,z)).next())});import{s as I,_ as ue}from"./index-CoBZUWE1.js";/* empty css                    *//* empty css                *//* empty css                *//* empty css                 *//* empty css                          *//* empty css                    *//* empty css                 *//* empty css                        *//* empty css                  *//* empty css                       *//* empty css                 *//* empty css                   *//* empty css                  *//* empty css               *//* empty css                  *//* empty css                     */import"./el-form-item-l0sNRNKZ.js";import{O as Re,af as $t,M as he,N as we,ag as kt,W as Ue,X as Ee,Y as Be,at as xt,b as Ce,au as Ct,_ as nt,j as je,d as $e,ai as Ve,bd as it,ah as rt,Z as jt,b3 as Vt,am as Mt,as as ze,ae as fe,ar as me,A as Ie,aB as Tt,ak as qe,b1 as Pe,h as Se,c as Ne,al as st,a$ as St,be as ut,T as ct,S as Le,aY as dt,$ as Dt,R as He,a0 as Rt,a as We,aj as Ye,B as _t,bf as Ut,P as pt,I as Et,D as at,H as Bt,ao as Jt,a1 as Ft,a2 as At,l as zt,b0 as It,bg as qt,bh as Pt,b6 as Nt,b7 as Lt,bc as lt}from"./vendor-ui-CE-ZhXxH.js";import{s as Ht,c as ft,r as Ke,g as mt,d as Wt,a as Yt,b as Kt,e as Ot,f as ot,h as Gt}from"./batch-analysis-BMPHoP0O.js";import{x as ce,r as E,X as be,c as ne,w as xe,y as S,Q as e,I as t,K as P,A as a,P as ie,a6 as re,O as f,u as N,M as c,z as y,i as vt,j as ke,S as Je,D as pe,H as se,J as gt,L as De,aC as Xt,am as Qt,V as Ae,t as Zt}from"./vendor-vue-XfLkFKXI.js";/* empty css                 *//* empty css                         *//* empty css                      *//* empty css                        */import"./el-tooltip-l0sNRNKZ.js";/* empty css                      *//* empty css                   *//* empty css                       *//* empty css                        *//* empty css                             *//* empty css                 */import"./vendor-pdf-BeW0Xq92.js";import"./vendor-utils-B8vW8fJV.js";const es={class:"batch-analysis-form"},ts={class:"card-header"},ss={class:"analysis-type-option"},as={class:"option-label"},ls={key:0,class:"option-description"},os={class:"upload-area"},ns={key:0,class:"file-summary"},is={class:"summary-info"},rs={key:0,class:"business-context-section"},us={key:0},cs={key:1},ds={key:2},_s={class:"submit-section"},ps={key:0,class:"cost-estimation"},fs={class:"submit-buttons"},ms=ce({__name:"BatchAnalysisForm",emits:["jobSubmitted","submissionError"],setup(K,{emit:z}){const V=z,J=E(),M=E(),T=[{value:"customer_requirements",label:"客户需求分析",description:"分析客户需求文档，提取技术参数、商务要求等关键信息"},{value:"competitor_analysis",label:"竞品资料分析",description:"分析竞争对手产品资料，提取价格、规格等市场情报"},{value:"project_mining",label:"历史项目挖掘",description:"分析历史项目文档，提取成功模式和最佳实践"},{value:"product_extraction",label:"产品信息提取"},{value:"document_classification",label:"文档分类"},{value:"quality_assessment",label:"质量评估"},{value:"comprehensive",label:"综合分析"}],n=be({documents:[],batch_name:"",description:"",analysis_config:{analysis_type:"customer_requirements",processing_priority:"balanced",auto_retry_failed:!0,max_retries:2,business_context:{industry:"",project_type:"",analysis_focus:[],requirements_type:"mixed",competitor_category:"",project_phase:"planning"},notification_settings:{email_on_completion:!0,email_on_failure:!0,webhook_url:""}}}),w=E([]),D=E(!1),R=ne(()=>["customer_requirements","competitor_analysis","project_mining"].includes(n.analysis_config.analysis_type)),k=i(u=>{if(n.analysis_config.business_context)switch(n.analysis_config.business_context.analysis_focus=[],u){case"customer_requirements":n.analysis_config.business_context.requirements_type="mixed";break;case"competitor_analysis":n.analysis_config.business_context.competitor_category="";break;case"project_mining":n.analysis_config.business_context.project_phase="planning";break}},"handleAnalysisTypeChange"),j={batch_name:[{required:!0,message:"请输入任务名称",trigger:"blur"},{min:2,max:100,message:"任务名称长度在 2 到 100 个字符",trigger:"blur"}],"analysis_config.analysis_type":[{required:!0,message:"请选择分析类型",trigger:"change"}],documents:[{required:!0,message:"请上传至少一个文档文件",trigger:"change"}]},Y=ne(()=>w.value.reduce((u,l)=>u+(l.size||0),0)),H=E(null),ae=i(u=>u<1024?u+" B":u<1024*1024?(u/1024).toFixed(1)+" KB":u<1024*1024*1024?(u/(1024*1024)).toFixed(1)+" MB":(u/(1024*1024*1024)).toFixed(1)+" GB","formatFileSize"),te=i(u=>{if(!["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/plain","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(u.type))return I.error("只支持 PDF、Word、Excel、Text 格式文件"),!1;const x=50*1024*1024;return u.size>x&&I.error("文件大小不能超过 50MB"),!1},"beforeUpload"),O=i((u,l)=>{w.value=l,n.documents=l.map(x=>x.raw).filter(x=>x),W()},"handleFileChange"),Q=i((u,l)=>{w.value=l,n.documents=l.map(x=>x.raw).filter(x=>x),W()},"handleFileRemove"),G=i(()=>{var u;w.value=[],n.documents=[],(u=M.value)==null||u.clearFiles(),H.value=null},"clearFiles"),W=i(()=>{if(w.value.length===0){H.value=null;return}const u=w.value.length,l=.5,x=1.5;H.value={cost:(u*l).toFixed(2),file_count:u,time:Math.ceil(u*x)}},"updateCostEstimation"),X=i(()=>Z(this,null,function*(){var u;if(J.value)try{if(!(yield J.value.validate()))return;if(n.documents.length===0){I.error("请至少上传一个文档文件");return}if((yield fe.confirm("确定提交批量分析任务吗？包含 ".concat(n.documents.length," 个文件，预估费用 ").concat(((u=H.value)==null?void 0:u.cost)||"未知"," 元。"),"确认提交",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"}))!=="confirm")return;D.value=!0;const L=yield Ht(n);if(L.success)I.success("任务提交成功！任务ID: ".concat(L.job_id)),V("jobSubmitted",L.job_id),oe();else throw new Error(L.error||"提交失败")}catch(l){const x=l.message||"提交批量分析任务失败";I.error(x),V("submissionError",x)}finally{D.value=!1}}),"submitAnalysis"),oe=i(()=>{var u;(u=J.value)==null||u.resetFields(),G(),Object.assign(n,{documents:[],batch_name:"",description:"",analysis_config:{analysis_type:"product_extraction",processing_priority:"balanced",auto_retry_failed:!0,max_retries:2,notification_settings:{email_on_completion:!0,email_on_failure:!0,webhook_url:""}}})},"resetForm");return xe(()=>n.documents.length,u=>{J.value&&J.value.validateField("documents")}),(u,l)=>{const x=$e,L=Ue,U=kt,d=we,m=Be,g=Ee,s=he,r=Ce,v=xt,o=nt,_=je,F=it,b=Ve,$=rt,h=jt,C=Mt,ee=Vt,le=ze,A=$t,de=Re;return y(),S("div",es,[e(de,{class:"form-card"},{header:t(()=>[a("div",ts,[l[21]||(l[21]=a("span",null,"批量文档分析配置",-1)),e(x,{text:"",onClick:oe},{default:t(()=>l[20]||(l[20]=[c("重置",-1)])),_:1,__:[20]})])]),default:t(()=>[e(A,{ref_key:"formRef",ref:J,model:n,rules:j,"label-width":"120px","label-position":"left"},{default:t(()=>[e(s,{gutter:20},{default:t(()=>[e(d,{span:12},{default:t(()=>[e(U,{label:"任务名称",prop:"batch_name"},{default:t(()=>[e(L,{modelValue:n.batch_name,"onUpdate:modelValue":l[0]||(l[0]=p=>n.batch_name=p),placeholder:"输入批量分析任务名称",maxlength:"100","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{span:12},{default:t(()=>[e(U,{label:"分析类型",prop:"analysis_config.analysis_type"},{default:t(()=>[e(g,{modelValue:n.analysis_config.analysis_type,"onUpdate:modelValue":l[1]||(l[1]=p=>n.analysis_config.analysis_type=p),placeholder:"选择分析类型",onChange:k},{default:t(()=>[(y(),S(ie,null,re(T,p=>e(m,{key:p.value,label:p.label,value:p.value},{default:t(()=>[a("div",ss,[a("div",as,f(p.label),1),p.description?(y(),S("div",ls,f(p.description),1)):P("",!0)])]),_:2},1032,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(U,{label:"任务描述"},{default:t(()=>[e(L,{modelValue:n.description,"onUpdate:modelValue":l[2]||(l[2]=p=>n.description=p),type:"textarea",rows:3,placeholder:"描述此批量分析任务的目的和要求...",maxlength:"500","show-word-limit":""},null,8,["modelValue"])]),_:1}),e(U,{label:"文档文件",prop:"documents"},{default:t(()=>[a("div",os,[e(v,{ref_key:"uploadRef",ref:M,class:"document-upload","file-list":w.value,"before-upload":te,"on-change":O,"on-remove":Q,"auto-upload":!1,multiple:"",drag:"",accept:".pdf,.doc,.docx,.txt,.xlsx,.xls"},{default:t(()=>[e(r,{class:"upload-icon"},{default:t(()=>[e(N(Ct))]),_:1}),l[22]||(l[22]=a("div",{class:"upload-text"},[a("p",null,[c("拖拽文件到此处，或"),a("em",null,"点击上传")]),a("p",{class:"upload-hint"},"支持 PDF、Word、Excel、Text 格式，单文件最大 50MB")],-1))]),_:1,__:[22]},8,["file-list"]),w.value.length>0?(y(),S("div",ns,[e(o),a("div",is,[e(_,{type:"info"},{default:t(()=>[c("已选择 "+f(w.value.length)+" 个文件",1)]),_:1}),e(_,{type:"warning"},{default:t(()=>[c("总大小 "+f(ae(Y.value)),1)]),_:1}),e(x,{type:"danger",size:"small",onClick:G},{default:t(()=>l[23]||(l[23]=[c("清空",-1)])),_:1,__:[23]})])])):P("",!0)])]),_:1}),e(o,{"content-position":"left"},{default:t(()=>l[24]||(l[24]=[c("分析配置",-1)])),_:1,__:[24]}),e(s,{gutter:20},{default:t(()=>[e(d,{span:8},{default:t(()=>[e(U,{label:"处理优先级"},{default:t(()=>[e(b,{modelValue:n.analysis_config.processing_priority,"onUpdate:modelValue":l[3]||(l[3]=p=>n.analysis_config.processing_priority=p)},{default:t(()=>[e(F,{value:"speed"},{default:t(()=>l[25]||(l[25]=[c("速度优先",-1)])),_:1,__:[25]}),e(F,{value:"accuracy"},{default:t(()=>l[26]||(l[26]=[c("准确性优先",-1)])),_:1,__:[26]}),e(F,{value:"balanced"},{default:t(()=>l[27]||(l[27]=[c("平衡模式",-1)])),_:1,__:[27]})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(d,{span:8},{default:t(()=>[e(U,{label:"自动重试"},{default:t(()=>[e($,{modelValue:n.analysis_config.auto_retry_failed,"onUpdate:modelValue":l[4]||(l[4]=p=>n.analysis_config.auto_retry_failed=p),"active-text":"开启","inactive-text":"关闭"},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{span:8},{default:t(()=>[e(U,{label:"最大重试次数"},{default:t(()=>[e(h,{modelValue:n.analysis_config.max_retries,"onUpdate:modelValue":l[5]||(l[5]=p=>n.analysis_config.max_retries=p),min:0,max:5,disabled:!n.analysis_config.auto_retry_failed},null,8,["modelValue","disabled"])]),_:1})]),_:1})]),_:1}),R.value?(y(),S("div",rs,[e(o,{"content-position":"left"},{default:t(()=>l[28]||(l[28]=[c("业务上下文配置",-1)])),_:1,__:[28]}),n.analysis_config.analysis_type==="customer_requirements"?(y(),S("div",us,[e(s,{gutter:20},{default:t(()=>[e(d,{span:8},{default:t(()=>[e(U,{label:"行业领域"},{default:t(()=>[e(g,{modelValue:n.analysis_config.business_context.industry,"onUpdate:modelValue":l[6]||(l[6]=p=>n.analysis_config.business_context.industry=p),placeholder:"选择行业"},{default:t(()=>[e(m,{label:"制造业",value:"manufacturing"}),e(m,{label:"IT/软件",value:"it_software"}),e(m,{label:"电信",value:"telecommunications"}),e(m,{label:"金融",value:"finance"}),e(m,{label:"能源",value:"energy"}),e(m,{label:"医疗",value:"healthcare"}),e(m,{label:"其他",value:"other"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(d,{span:8},{default:t(()=>[e(U,{label:"需求类型"},{default:t(()=>[e(g,{modelValue:n.analysis_config.business_context.requirements_type,"onUpdate:modelValue":l[7]||(l[7]=p=>n.analysis_config.business_context.requirements_type=p),placeholder:"选择需求类型"},{default:t(()=>[e(m,{label:"技术需求",value:"technical"}),e(m,{label:"功能需求",value:"functional"}),e(m,{label:"商务需求",value:"business"}),e(m,{label:"混合需求",value:"mixed"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(d,{span:8},{default:t(()=>[e(U,{label:"项目类型"},{default:t(()=>[e(L,{modelValue:n.analysis_config.business_context.project_type,"onUpdate:modelValue":l[8]||(l[8]=p=>n.analysis_config.business_context.project_type=p),placeholder:"如：ERP系统、网络设备等"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(U,{label:"分析重点"},{default:t(()=>[e(ee,{modelValue:n.analysis_config.business_context.analysis_focus,"onUpdate:modelValue":l[9]||(l[9]=p=>n.analysis_config.business_context.analysis_focus=p)},{default:t(()=>[e(C,{value:"technical_specs"},{default:t(()=>l[29]||(l[29]=[c("技术规格",-1)])),_:1,__:[29]}),e(C,{value:"budget_analysis"},{default:t(()=>l[30]||(l[30]=[c("预算分析",-1)])),_:1,__:[30]}),e(C,{value:"timeline_requirements"},{default:t(()=>l[31]||(l[31]=[c("时间要求",-1)])),_:1,__:[31]}),e(C,{value:"compliance_standards"},{default:t(()=>l[32]||(l[32]=[c("合规标准",-1)])),_:1,__:[32]}),e(C,{value:"risk_assessment"},{default:t(()=>l[33]||(l[33]=[c("风险评估",-1)])),_:1,__:[33]}),e(C,{value:"decision_factors"},{default:t(()=>l[34]||(l[34]=[c("决策因素",-1)])),_:1,__:[34]})]),_:1},8,["modelValue"])]),_:1})])):P("",!0),n.analysis_config.analysis_type==="competitor_analysis"?(y(),S("div",cs,[e(s,{gutter:20},{default:t(()=>[e(d,{span:12},{default:t(()=>[e(U,{label:"竞品类别"},{default:t(()=>[e(L,{modelValue:n.analysis_config.business_context.competitor_category,"onUpdate:modelValue":l[10]||(l[10]=p=>n.analysis_config.business_context.competitor_category=p),placeholder:"如：网络设备、软件系统等"},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{span:12},{default:t(()=>[e(U,{label:"行业领域"},{default:t(()=>[e(g,{modelValue:n.analysis_config.business_context.industry,"onUpdate:modelValue":l[11]||(l[11]=p=>n.analysis_config.business_context.industry=p),placeholder:"选择行业"},{default:t(()=>[e(m,{label:"制造业",value:"manufacturing"}),e(m,{label:"IT/软件",value:"it_software"}),e(m,{label:"电信",value:"telecommunications"}),e(m,{label:"金融",value:"finance"}),e(m,{label:"能源",value:"energy"}),e(m,{label:"医疗",value:"healthcare"}),e(m,{label:"其他",value:"other"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(U,{label:"分析重点"},{default:t(()=>[e(ee,{modelValue:n.analysis_config.business_context.analysis_focus,"onUpdate:modelValue":l[12]||(l[12]=p=>n.analysis_config.business_context.analysis_focus=p)},{default:t(()=>[e(C,{value:"pricing_analysis"},{default:t(()=>l[35]||(l[35]=[c("价格分析",-1)])),_:1,__:[35]}),e(C,{value:"technical_comparison"},{default:t(()=>l[36]||(l[36]=[c("技术对比",-1)])),_:1,__:[36]}),e(C,{value:"market_position"},{default:t(()=>l[37]||(l[37]=[c("市场定位",-1)])),_:1,__:[37]}),e(C,{value:"feature_analysis"},{default:t(()=>l[38]||(l[38]=[c("功能分析",-1)])),_:1,__:[38]}),e(C,{value:"competitive_advantages"},{default:t(()=>l[39]||(l[39]=[c("竞争优势",-1)])),_:1,__:[39]}),e(C,{value:"weakness_identification"},{default:t(()=>l[40]||(l[40]=[c("弱点识别",-1)])),_:1,__:[40]})]),_:1},8,["modelValue"])]),_:1})])):P("",!0),n.analysis_config.analysis_type==="project_mining"?(y(),S("div",ds,[e(s,{gutter:20},{default:t(()=>[e(d,{span:8},{default:t(()=>[e(U,{label:"项目阶段"},{default:t(()=>[e(g,{modelValue:n.analysis_config.business_context.project_phase,"onUpdate:modelValue":l[13]||(l[13]=p=>n.analysis_config.business_context.project_phase=p),placeholder:"选择项目阶段"},{default:t(()=>[e(m,{label:"规划阶段",value:"planning"}),e(m,{label:"执行阶段",value:"execution"}),e(m,{label:"完成阶段",value:"completion"}),e(m,{label:"评估阶段",value:"evaluation"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(d,{span:8},{default:t(()=>[e(U,{label:"项目类型"},{default:t(()=>[e(L,{modelValue:n.analysis_config.business_context.project_type,"onUpdate:modelValue":l[14]||(l[14]=p=>n.analysis_config.business_context.project_type=p),placeholder:"如：系统集成、产品开发等"},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{span:8},{default:t(()=>[e(U,{label:"行业领域"},{default:t(()=>[e(g,{modelValue:n.analysis_config.business_context.industry,"onUpdate:modelValue":l[15]||(l[15]=p=>n.analysis_config.business_context.industry=p),placeholder:"选择行业"},{default:t(()=>[e(m,{label:"制造业",value:"manufacturing"}),e(m,{label:"IT/软件",value:"it_software"}),e(m,{label:"电信",value:"telecommunications"}),e(m,{label:"金融",value:"finance"}),e(m,{label:"能源",value:"energy"}),e(m,{label:"医疗",value:"healthcare"}),e(m,{label:"其他",value:"other"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(U,{label:"分析重点"},{default:t(()=>[e(ee,{modelValue:n.analysis_config.business_context.analysis_focus,"onUpdate:modelValue":l[16]||(l[16]=p=>n.analysis_config.business_context.analysis_focus=p)},{default:t(()=>[e(C,{value:"success_patterns"},{default:t(()=>l[41]||(l[41]=[c("成功模式",-1)])),_:1,__:[41]}),e(C,{value:"best_practices"},{default:t(()=>l[42]||(l[42]=[c("最佳实践",-1)])),_:1,__:[42]}),e(C,{value:"lessons_learned"},{default:t(()=>l[43]||(l[43]=[c("经验教训",-1)])),_:1,__:[43]}),e(C,{value:"risk_factors"},{default:t(()=>l[44]||(l[44]=[c("风险因素",-1)])),_:1,__:[44]}),e(C,{value:"resource_allocation"},{default:t(()=>l[45]||(l[45]=[c("资源配置",-1)])),_:1,__:[45]}),e(C,{value:"reusable_assets"},{default:t(()=>l[46]||(l[46]=[c("可复用资产",-1)])),_:1,__:[46]})]),_:1},8,["modelValue"])]),_:1})])):P("",!0)])):P("",!0),e(o,{"content-position":"left"},{default:t(()=>l[47]||(l[47]=[c("通知设置",-1)])),_:1,__:[47]}),e(s,{gutter:20},{default:t(()=>[e(d,{span:12},{default:t(()=>[e(U,{label:"完成通知"},{default:t(()=>[e($,{modelValue:n.analysis_config.notification_settings.email_on_completion,"onUpdate:modelValue":l[17]||(l[17]=p=>n.analysis_config.notification_settings.email_on_completion=p),"active-text":"邮件通知","inactive-text":"关闭"},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{span:12},{default:t(()=>[e(U,{label:"失败通知"},{default:t(()=>[e($,{modelValue:n.analysis_config.notification_settings.email_on_failure,"onUpdate:modelValue":l[18]||(l[18]=p=>n.analysis_config.notification_settings.email_on_failure=p),"active-text":"邮件通知","inactive-text":"关闭"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(U,{label:"Webhook URL"},{default:t(()=>[e(L,{modelValue:n.analysis_config.notification_settings.webhook_url,"onUpdate:modelValue":l[19]||(l[19]=p=>n.analysis_config.notification_settings.webhook_url=p),placeholder:"可选：任务完成后的 Webhook 回调地址"},null,8,["modelValue"])]),_:1}),e(o),a("div",_s,[H.value?(y(),S("div",ps,[e(le,{title:"预估费用: ".concat(H.value.cost," 元"),description:"处理 ".concat(H.value.file_count," 个文件，预计 ").concat(H.value.time," 分钟完成"),type:"info","show-icon":"",closable:!1},null,8,["title","description"])])):P("",!0),a("div",fs,[e(x,{onClick:oe},{default:t(()=>l[48]||(l[48]=[c("重置",-1)])),_:1,__:[48]}),e(x,{type:"primary",loading:D.value,disabled:w.value.length===0,onClick:X},{default:t(()=>[c(f(D.value?"提交中...":"提交批量分析"),1)]),_:1},8,["loading","disabled"])])])]),_:1},8,["model"])]),_:1})])}}}),vs=ue(ms,[["__scopeId","data-v-a0a8f954"]]),gs={class:"batch-job-monitor"},ys={class:"monitor-header"},bs={class:"header-actions"},hs={class:"job-filters"},ws={class:"job-summary"},$s={class:"job-list"},ks={key:0,class:"loading-state"},xs={key:1,class:"empty-state"},Cs={key:2,class:"job-cards"},js={class:"card-header"},Vs={class:"job-info"},Ms={class:"job-meta"},Ts={class:"job-time"},Ss={class:"job-actions"},Ds={class:"card-content"},Rs={key:0,class:"job-description"},Us={key:1,class:"progress-section"},Es={class:"progress-info"},Bs={class:"time-info"},Js={key:0,class:"current-file"},Fs={key:1,class:"remaining-time"},As={class:"config-section"},zs={class:"config-item"},Is={class:"value"},qs={class:"config-item"},Ps={class:"value"},Ns={class:"config-item"},Ls={class:"value"},Hs={key:2,class:"error-section"},Ws=ce({__name:"BatchJobMonitor",props:{jobs:{}},emits:["jobCancelled","jobRetried","jobDetails","createNewJob"],setup(K,{emit:z}){const V=K,J=z,M=E(!1),T=E(!1),n=E(!0),w=E(""),D=E("");let R=null;const k=vt("refreshTrigger",E(0)),j=E([]),Y=ne(()=>j.value.filter(s=>["pending","processing"].includes(s.status)).length),H=ne(()=>j.value.filter(s=>s.status==="completed").length),ae=ne(()=>j.value.filter(s=>s.status==="failed").length),te=i(s=>({pending:"info",processing:"warning",completed:"success",failed:"danger",cancelled:"info"})[s]||"info","getStatusTagType"),O=i(s=>({pending:"等待中",processing:"处理中",completed:"已完成",failed:"已失败",cancelled:"已取消"})[s]||s,"getStatusText"),Q=i(s=>({product_extraction:"产品信息提取",document_classification:"文档分类",quality_assessment:"质量评估",comprehensive:"综合分析"})[s]||s,"getAnalysisTypeText"),G=i(s=>({speed:"速度优先",accuracy:"准确性优先",balanced:"平衡模式"})[s]||s,"getPriorityText"),W=i(s=>["pending","processing"].includes(s),"canCancel"),X=i(s=>["failed","cancelled"].includes(s),"canRetry"),oe=i(s=>new Date(s).toLocaleString("zh-CN"),"formatTime"),u=i(s=>s<60?"".concat(s,"秒"):s<3600?"".concat(Math.floor(s/60),"分钟"):"".concat(Math.floor(s/3600),"小时").concat(Math.floor(s%3600/60),"分钟"),"formatDuration"),l=i(()=>{let s=[...V.jobs];if(w.value&&(s=s.filter(r=>r.status===w.value)),D.value){const r=D.value.toLowerCase();s=s.filter(v=>(v.job_name||"任务 #".concat(v.job_id)).toLowerCase().includes(r)||(v.description||"").toLowerCase().includes(r))}j.value=s},"filterJobs"),x=i(()=>Z(this,null,function*(){if(V.jobs.length!==0){T.value=!0;try{yield new Promise(s=>setTimeout(s,500)),I.success("任务列表已刷新")}catch(s){I.error("刷新任务列表失败")}finally{T.value=!1}}}),"refreshJobs"),L=i(s=>{s?U():d()},"handleAutoRefreshChange"),U=i(()=>{R||(R=window.setInterval(()=>{Y.value>0&&x()},5e3))},"startAutoRefresh"),d=i(()=>{R&&(clearInterval(R),R=null)},"stopAutoRefresh"),m=i(s=>Z(this,null,function*(){try{if((yield fe.confirm('确定要取消任务 "'.concat(s.job_name||"#".concat(s.job_id),'" 吗？'),"取消任务",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}))!=="confirm")return;const v=yield ft(s.job_id);if(v.success)I.success("任务已取消"),J("jobCancelled",s.job_id);else throw new Error(v.error||"取消任务失败")}catch(r){r.message!=="cancel"&&I.error(r.message||"取消任务失败")}}),"cancelJob"),g=i(s=>Z(this,null,function*(){try{if((yield fe.confirm('确定要重试任务 "'.concat(s.job_name||"#".concat(s.job_id),'" 吗？'),"重试任务",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"}))!=="confirm")return;const v=yield Ke(s.job_id);if(v.success)I.success("任务已重新提交，新任务ID: ".concat(v.new_job_id)),J("jobRetried",v.new_job_id);else throw new Error(v.error||"重试任务失败")}catch(r){r.message!=="cancel"&&I.error(r.message||"重试任务失败")}}),"retryJob");return xe(()=>V.jobs,()=>{l()},{immediate:!0}),xe(k,()=>{l()}),ke(()=>{n.value&&U()}),Je(()=>{d()}),(s,r)=>{const v=rt,o=$e,_=Be,F=Ee,b=we,$=Ue,h=je,C=he,ee=Tt,le=qe,A=Ne,de=ze;return y(),S("div",gs,[a("div",ys,[r[5]||(r[5]=a("div",{class:"header-info"},[a("h3",null,"任务监控"),a("p",null,"实时监控批量分析任务进度")],-1)),a("div",bs,[e(v,{modelValue:n.value,"onUpdate:modelValue":r[0]||(r[0]=p=>n.value=p),"active-text":"自动刷新","inactive-text":"手动刷新",onChange:L},null,8,["modelValue"]),e(o,{type:"primary",icon:N(me),loading:T.value,onClick:x},{default:t(()=>r[4]||(r[4]=[c(" 刷新 ",-1)])),_:1,__:[4]},8,["icon","loading"])])]),a("div",hs,[e(C,{gutter:15},{default:t(()=>[e(b,{span:6},{default:t(()=>[e(F,{modelValue:w.value,"onUpdate:modelValue":r[1]||(r[1]=p=>w.value=p),placeholder:"状态筛选",clearable:"",onChange:l},{default:t(()=>[e(_,{label:"全部状态",value:""}),e(_,{label:"等待中",value:"pending"}),e(_,{label:"处理中",value:"processing"}),e(_,{label:"已完成",value:"completed"}),e(_,{label:"已失败",value:"failed"}),e(_,{label:"已取消",value:"cancelled"})]),_:1},8,["modelValue"])]),_:1}),e(b,{span:6},{default:t(()=>[e($,{modelValue:D.value,"onUpdate:modelValue":r[2]||(r[2]=p=>D.value=p),placeholder:"搜索任务名称","prefix-icon":N(Ie),clearable:"",onInput:l},null,8,["modelValue","prefix-icon"])]),_:1}),e(b,{span:12},{default:t(()=>[a("div",ws,[e(h,{type:"info"},{default:t(()=>[c("总计: "+f(j.value.length),1)]),_:1}),e(h,{type:"warning"},{default:t(()=>[c("处理中: "+f(Y.value),1)]),_:1}),e(h,{type:"success"},{default:t(()=>[c("已完成: "+f(H.value),1)]),_:1}),e(h,{type:"danger"},{default:t(()=>[c("失败: "+f(ae.value),1)]),_:1})])]),_:1})]),_:1})]),a("div",$s,[M.value&&j.value.length===0?(y(),S("div",ks,[e(ee,{rows:3,animated:""})])):j.value.length===0?(y(),S("div",xs,[e(le,{description:"暂无活跃的批量分析任务"},{default:t(()=>[e(o,{type:"primary",onClick:r[3]||(r[3]=p=>s.$emit("create-new-job"))},{default:t(()=>r[6]||(r[6]=[c(" 创建新任务 ",-1)])),_:1,__:[6]})]),_:1})])):(y(),S("div",Cs,[(y(!0),S(ie,null,re(j.value,p=>(y(),S("div",{key:p.job_id,class:pe(["job-card",["status-".concat(p.status)]])},[a("div",js,[a("div",Vs,[a("h4",null,f(p.job_name||"任务 #".concat(p.job_id)),1),a("div",Ms,[e(h,{type:te(p.status),size:"small"},{default:t(()=>[c(f(O(p.status)),1)]),_:2},1032,["type"]),a("span",Ts,f(oe(p.created_at)),1)])]),a("div",Ss,[e(o,{text:"",icon:N(Pe),onClick:i(ve=>s.$emit("job-details",p),"onClick"),title:"查看详情"},null,8,["icon","onClick"]),W(p.status)?(y(),se(o,{key:0,text:"",icon:N(Se),onClick:i(ve=>m(p),"onClick"),title:"取消任务"},null,8,["icon","onClick"])):P("",!0),X(p.status)?(y(),se(o,{key:1,text:"",icon:N(me),onClick:i(ve=>g(p),"onClick"),title:"重试任务"},null,8,["icon","onClick"])):P("",!0)])]),a("div",Ds,[p.description?(y(),S("div",Rs,f(p.description),1)):P("",!0),p.progress?(y(),S("div",Us,[a("div",Es,[a("span",null,"进度: "+f(p.progress.processed_files)+"/"+f(p.progress.total_files),1),a("span",null,"成功: "+f(p.progress.successful_files),1),a("span",null,"失败: "+f(p.progress.failed_files),1)]),e(A,{percentage:p.progress.percentage,status:p.status==="failed"?"exception":"success","show-text":!1,"stroke-width":8},null,8,["percentage","status"]),a("div",Bs,[p.progress.current_file?(y(),S("span",Js," 当前处理: "+f(p.progress.current_file),1)):P("",!0),p.progress.estimated_remaining_time>0?(y(),S("span",Fs," 预计剩余: "+f(u(p.progress.estimated_remaining_time)),1)):P("",!0)])])):P("",!0),a("div",As,[e(C,{gutter:10},{default:t(()=>[e(b,{span:8},{default:t(()=>[a("div",zs,[r[7]||(r[7]=a("span",{class:"label"},"分析类型:",-1)),a("span",Is,f(Q(p.analysis_type)),1)])]),_:2},1024),e(b,{span:8},{default:t(()=>[a("div",qs,[r[8]||(r[8]=a("span",{class:"label"},"优先级:",-1)),a("span",Ps,f(G(p.processing_priority)),1)])]),_:2},1024),e(b,{span:8},{default:t(()=>[a("div",Ns,[r[9]||(r[9]=a("span",{class:"label"},"队列位置:",-1)),a("span",Ls,f(p.queue_position||"N/A"),1)])]),_:2},1024)]),_:2},1024)]),p.status==="failed"&&p.error_message?(y(),S("div",Hs,[e(de,{title:p.error_message,type:"error",closable:!1,"show-icon":""},null,8,["title"])])):P("",!0)])],2))),128))]))])])}}}),Ys=ue(Ws,[["__scopeId","data-v-0ad74dc8"]]),Ks={class:"batch-history"},Os={class:"history-header"},Gs={class:"header-actions"},Xs={class:"history-filters"},Qs={class:"history-stats"},Zs={class:"history-table"},ea={class:"job-name-cell"},ta={class:"name"},sa={key:0,class:"description"},aa={class:"success-count"},la={class:"fail-count"},oa={class:"action-buttons"},na={class:"pagination-wrapper"},ia={class:"download-options"},ra=ce({__name:"BatchHistory",emits:["jobSelected","jobDeleted","downloadResults"],setup(K,{emit:z}){const V=z,J=E(!1),M=E([]),T=E([]),n=E(!1),w=E("json"),D=E(null);let R=null;const k=be({status:"",analysis_type:"",dateRange:[],search:""}),j=be({currentPage:1,pageSize:20,total:0}),Y=ne(()=>{const v=Array.isArray(M.value)?M.value:[],o=v.length,_=v.filter(h=>(h==null?void 0:h.status)==="completed").length,F=o>0?Math.round(_/o*100):0,b=v.reduce((h,C)=>h+((C==null?void 0:C.file_count)||0),0),$=v.length>0?Math.round(v.reduce((h,C)=>h+((C==null?void 0:C.processing_time)||0),0)/v.length/60):0;return{total:o,successRate:F,totalFiles:b,avgProcessingTime:$}}),H=i(v=>({completed:"success",failed:"danger",cancelled:"info"})[v]||"info","getStatusTagType"),ae=i(v=>({completed:"已完成",failed:"已失败",cancelled:"已取消"})[v]||v,"getStatusText"),te=i(v=>({product_extraction:"产品信息提取",document_classification:"文档分类",quality_assessment:"质量评估",comprehensive:"综合分析"})[v]||v,"getAnalysisTypeText"),O=i(v=>["failed","cancelled"].includes(v),"canRetry"),Q=i(v=>new Date(v).toLocaleString("zh-CN"),"formatTime"),G=i(v=>v<60?"".concat(v,"秒"):v<3600?"".concat(Math.floor(v/60),"分钟"):"".concat(Math.floor(v/3600),"小时").concat(Math.floor(v%3600/60),"分钟"),"formatDuration"),W=i(()=>Z(this,null,function*(){var v;J.value=!0;try{const o=yield mt({page:j.currentPage,page_size:j.pageSize,status:k.status,analysis_type:k.analysis_type,start_date:k.dateRange[0],end_date:k.dateRange[1],search:k.search});if(o&&o.success)M.value=Array.isArray(o.records)?o.records:[],j.total=o.total||0,X();else{M.value=[],j.total=0;const _=(o==null?void 0:o.error)||"加载历史记录失败";I.error(_)}}catch(o){M.value=[],j.total=0;let _="加载历史记录失败";((v=o==null?void 0:o.response)==null?void 0:v.status)===404?_="批量分析服务暂不可用":o!=null&&o.message&&(_=o.message),I.error(_)}finally{J.value=!1}}),"loadHistory"),X=i(()=>{let o=[...Array.isArray(M.value)?M.value:[]];if(k.status&&(o=o.filter(_=>(_==null?void 0:_.status)===k.status)),k.analysis_type&&(o=o.filter(_=>(_==null?void 0:_.analysis_type)===k.analysis_type)),k.dateRange&&k.dateRange.length===2){const _=new Date(k.dateRange[0]),F=new Date(k.dateRange[1]);F.setHours(23,59,59,999),o=o.filter(b=>{if(!(b!=null&&b.created_at))return!1;const $=new Date(b.created_at);return $>=_&&$<=F})}if(k.search){const _=k.search.toLowerCase();o=o.filter(F=>{if(!F)return!1;const b=F.job_name||"任务 #".concat(F.job_id||""),$=F.description||"";return b.toLowerCase().includes(_)||$.toLowerCase().includes(_)})}T.value=o},"applyFilters"),oe=i(()=>{R&&clearTimeout(R),R=window.setTimeout(()=>{X()},300)},"debounceSearch"),u=i(({prop:v,order:o})=>{W()},"handleSortChange"),l=i(v=>{j.pageSize=v,j.currentPage=1,W()},"handleSizeChange"),x=i(v=>{j.currentPage=v,W()},"handleCurrentChange"),L=i(v=>{V("jobSelected",v)},"viewDetails"),U=i(v=>{D.value=v,n.value=!0},"downloadResults"),d=i(()=>{D.value&&(V("downloadResults",D.value.job_id,w.value),n.value=!1,D.value=null)},"confirmDownload"),m=i(v=>Z(this,null,function*(){try{if((yield fe.confirm('确定要重试任务 "'.concat(v.job_name||"#".concat(v.job_id),'" 吗？'),"重试任务",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"}))!=="confirm")return;const _=yield Ke(String(v.job_id));if(_.success)I.success("任务已重新提交，新任务ID: ".concat(_.new_job_id)),W();else throw new Error(_.error||"重试任务失败")}catch(o){o.message!=="cancel"&&I.error(o.message||"重试任务失败")}}),"retryJob"),g=i(v=>Z(this,null,function*(){var o,_,F,b,$;try{const h=yield Wt(v.id);if(h&&h.success){const C=v.job_name||"任务 #".concat(v.job_id);I.success('"'.concat(C,'" 记录已删除')),yield W(),V("jobDeleted")}else throw new Error((h==null?void 0:h.error)||"删除记录失败")}catch(h){let C="删除记录失败";const ee=v.job_name||"任务 #".concat(v.job_id);((o=h==null?void 0:h.response)==null?void 0:o.status)===403?C="权限不足，无法删除此记录":((_=h==null?void 0:h.response)==null?void 0:_.status)===404?C="记录不存在或已被删除":((F=h==null?void 0:h.response)==null?void 0:F.status)===400?C="无法删除正在处理中的任务，请等待任务完成后再试":($=(b=h==null?void 0:h.response)==null?void 0:b.data)!=null&&$.error?C=h.response.data.error:h!=null&&h.message&&h.message!=="删除记录失败"&&(C="删除失败: ".concat(h.message));const le='删除 "'.concat(ee,'" 失败: ').concat(C,"。如问题持续存在，请联系管理员。");I.error(le)}}),"deleteRecord"),s=i(()=>Z(this,null,function*(){var v,o,_,F,b;try{if((yield fe.confirm("确定要清空所有历史记录吗？此操作不可撤销！","清空历史",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}))!=="confirm")return;const h=yield Yt();if(h&&h.success){const C=h.deleted_count||0;let ee=h.message||"历史记录已清空";C===0?(ee="没有找到需要清空的历史记录",I.info(ee)):(ee="已成功清空 ".concat(C," 条历史记录"),I.success(ee)),yield W(),V("jobDeleted")}else throw new Error((h==null?void 0:h.error)||"清空历史记录失败")}catch($){if($.message!=="cancel"){let h="清空历史记录失败";((v=$==null?void 0:$.response)==null?void 0:v.status)===403?h="权限不足，无法清空历史记录":((o=$==null?void 0:$.response)==null?void 0:o.status)===404?h="清空历史服务暂不可用":((_=$==null?void 0:$.response)==null?void 0:_.status)===500?h="服务器内部错误，清空操作失败":(b=(F=$==null?void 0:$.response)==null?void 0:F.data)!=null&&b.error?h=$.response.data.error:$!=null&&$.message&&$.message!=="清空历史记录失败"&&(h="操作失败: ".concat($.message));const C="".concat(h,"。请稍后重试，如问题持续存在，请联系管理员。");I.error(C)}}}),"clearHistory"),r=vt("refreshTrigger");return r&&xe(r,()=>{W()}),ke(()=>{W()}),(v,o)=>{const _=$e,F=Be,b=Ee,$=we,h=St,C=Ue,ee=he,le=ut,A=Le,de=je,p=Dt,ve=He,Me=Rt,_e=it,Te=Ve,q=We,ge=ct;return y(),S("div",Ks,[a("div",Os,[o[11]||(o[11]=a("div",{class:"header-info"},[a("h3",null,"批量分析历史"),a("p",null,"查看和管理历史批量分析记录")],-1)),a("div",Gs,[e(_,{icon:N(me),onClick:W},{default:t(()=>o[9]||(o[9]=[c("刷新",-1)])),_:1,__:[9]},8,["icon"]),e(_,{type:"danger",icon:N(st),onClick:s},{default:t(()=>o[10]||(o[10]=[c("清空历史",-1)])),_:1,__:[10]},8,["icon"])])]),a("div",Xs,[e(ee,{gutter:15},{default:t(()=>[e($,{span:6},{default:t(()=>[e(b,{modelValue:k.status,"onUpdate:modelValue":o[0]||(o[0]=B=>k.status=B),placeholder:"状态筛选",clearable:"",onChange:X},{default:t(()=>[e(F,{label:"全部状态",value:""}),e(F,{label:"已完成",value:"completed"}),e(F,{label:"已失败",value:"failed"}),e(F,{label:"已取消",value:"cancelled"})]),_:1},8,["modelValue"])]),_:1}),e($,{span:6},{default:t(()=>[e(b,{modelValue:k.analysis_type,"onUpdate:modelValue":o[1]||(o[1]=B=>k.analysis_type=B),placeholder:"分析类型",clearable:"",onChange:X},{default:t(()=>[e(F,{label:"全部类型",value:""}),e(F,{label:"产品信息提取",value:"product_extraction"}),e(F,{label:"文档分类",value:"document_classification"}),e(F,{label:"质量评估",value:"quality_assessment"}),e(F,{label:"综合分析",value:"comprehensive"})]),_:1},8,["modelValue"])]),_:1}),e($,{span:6},{default:t(()=>[e(h,{modelValue:k.dateRange,"onUpdate:modelValue":o[2]||(o[2]=B=>k.dateRange=B),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",onChange:X},null,8,["modelValue"])]),_:1}),e($,{span:6},{default:t(()=>[e(C,{modelValue:k.search,"onUpdate:modelValue":o[3]||(o[3]=B=>k.search=B),placeholder:"搜索任务名称","prefix-icon":N(Ie),clearable:"",onInput:oe},null,8,["modelValue","prefix-icon"])]),_:1})]),_:1})]),a("div",Qs,[e(ee,{gutter:15},{default:t(()=>[e($,{span:6},{default:t(()=>[e(le,{title:"总任务数",value:Y.value.total},null,8,["value"])]),_:1}),e($,{span:6},{default:t(()=>[e(le,{title:"成功率",value:Y.value.successRate,suffix:"%"},null,8,["value"])]),_:1}),e($,{span:6},{default:t(()=>[e(le,{title:"处理文件数",value:Y.value.totalFiles},null,8,["value"])]),_:1}),e($,{span:6},{default:t(()=>[e(le,{title:"平均处理时间",value:Y.value.avgProcessingTime,suffix:"分钟"},null,8,["value"])]),_:1})]),_:1})]),a("div",Zs,[gt((y(),se(ve,{data:T.value,stripe:"",border:"",style:{width:"100%"},"default-sort":{prop:"created_at",order:"descending"},onSortChange:u},{default:t(()=>[e(A,{prop:"job_id",label:"任务ID",width:"80",sortable:""}),e(A,{prop:"job_name",label:"任务名称","min-width":"150"},{default:t(({row:B})=>[a("div",ea,[a("span",ta,f(B.job_name||"任务 #".concat(B.job_id)),1),B.description?(y(),S("span",sa,f(B.description),1)):P("",!0)])]),_:1}),e(A,{prop:"analysis_type",label:"分析类型",width:"120"},{default:t(({row:B})=>[c(f(te(B.analysis_type)),1)]),_:1}),e(A,{prop:"status",label:"状态",width:"100"},{default:t(({row:B})=>[e(de,{type:H(B.status),size:"small"},{default:t(()=>[c(f(ae(B.status)),1)]),_:2},1032,["type"])]),_:1}),e(A,{prop:"file_count",label:"文件数",width:"80",sortable:""}),e(A,{prop:"success_count",label:"成功/失败",width:"100"},{default:t(({row:B})=>[a("span",aa,f(B.success_count),1),o[12]||(o[12]=c(" / ",-1)),a("span",la,f(B.fail_count),1)]),_:1}),e(A,{prop:"processing_time",label:"处理时间",width:"100",sortable:""},{default:t(({row:B})=>[c(f(G(B.processing_time)),1)]),_:1}),e(A,{prop:"created_at",label:"创建时间",width:"160",sortable:""},{default:t(({row:B})=>[c(f(Q(B.created_at)),1)]),_:1}),e(A,{label:"操作",width:"200",fixed:"right"},{default:t(({row:B})=>[a("div",oa,[e(_,{text:"",size:"small",icon:N(Pe),onClick:i(ye=>L(B),"onClick")},{default:t(()=>o[13]||(o[13]=[c(" 详情 ",-1)])),_:2,__:[13]},1032,["icon","onClick"]),B.status==="completed"?(y(),se(_,{key:0,text:"",size:"small",icon:N(dt),onClick:i(ye=>U(B),"onClick")},{default:t(()=>o[14]||(o[14]=[c(" 下载 ",-1)])),_:2,__:[14]},1032,["icon","onClick"])):P("",!0),O(B.status)?(y(),se(_,{key:1,text:"",size:"small",icon:N(me),onClick:i(ye=>m(B),"onClick")},{default:t(()=>o[15]||(o[15]=[c(" 重试 ",-1)])),_:2,__:[15]},1032,["icon","onClick"])):P("",!0),e(p,{title:"确定删除这条记录吗？",onConfirm:i(ye=>g(B),"onConfirm")},{reference:t(()=>[e(_,{text:"",size:"small",icon:N(st),class:"danger-button"},{default:t(()=>o[16]||(o[16]=[c(" 删除 ",-1)])),_:1,__:[16]},8,["icon"])]),_:2},1032,["onConfirm"])])]),_:1})]),_:1},8,["data"])),[[ge,J.value]]),a("div",na,[e(Me,{"current-page":j.currentPage,"onUpdate:currentPage":o[4]||(o[4]=B=>j.currentPage=B),"page-size":j.pageSize,"onUpdate:pageSize":o[5]||(o[5]=B=>j.pageSize=B),total:j.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:l,onCurrentChange:x},null,8,["current-page","page-size","total"])])]),e(q,{modelValue:n.value,"onUpdate:modelValue":o[8]||(o[8]=B=>n.value=B),title:"选择下载格式",width:"400px"},{footer:t(()=>[e(_,{onClick:o[7]||(o[7]=B=>n.value=!1)},{default:t(()=>o[21]||(o[21]=[c("取消",-1)])),_:1,__:[21]}),e(_,{type:"primary",onClick:d},{default:t(()=>o[22]||(o[22]=[c("确定下载",-1)])),_:1,__:[22]})]),default:t(()=>[a("div",ia,[e(Te,{modelValue:w.value,"onUpdate:modelValue":o[6]||(o[6]=B=>w.value=B)},{default:t(()=>[e(_e,{value:"json"},{default:t(()=>o[17]||(o[17]=[c("JSON 格式",-1)])),_:1,__:[17]}),e(_e,{value:"excel"},{default:t(()=>o[18]||(o[18]=[c("Excel 表格",-1)])),_:1,__:[18]}),e(_e,{value:"csv"},{default:t(()=>o[19]||(o[19]=[c("CSV 文件",-1)])),_:1,__:[19]}),e(_e,{value:"pdf"},{default:t(()=>o[20]||(o[20]=[c("PDF 报告",-1)])),_:1,__:[20]})]),_:1},8,["modelValue"])])]),_:1},8,["modelValue"])])}}}),ua=ue(ra,[["__scopeId","data-v-515c2eba"]]),ca={class:"batch-metrics"},da={class:"time-range-selector"},_a={class:"metrics-summary"},pa={class:"summary-item"},fa={class:"summary-value"},ma={class:"summary-item"},va={class:"summary-value"},ga={class:"summary-item"},ya={class:"summary-value"},ba={class:"summary-item"},ha={class:"summary-value"},wa={class:"charts-container"},$a={class:"chart-placeholder"},ka={class:"chart-placeholder"},xa={class:"chart-placeholder"},Ca={class:"metrics-table"},ja=ce({__name:"BatchMetrics",setup(K){const z=E("week"),V=E(!1),J=E({summary:{totalJobs:0,successJobs:0,failedJobs:0,avgProcessingTime:0,totalFileSize:0},details:[]}),M=i(()=>Z(this,null,function*(){var T,n,w;V.value=!0;try{const R={today:1,week:7,month:30,quarter:90,year:365}[z.value]||7,k=yield Kt({days:R});if(k&&k.success){const j=k.statistics||{},Y=j.total_jobs||0,H=j.success_rate||0;J.value.summary={totalJobs:Y,successJobs:j.completed_jobs||0,failedJobs:Y-(j.completed_jobs||0),avgProcessingTime:((T=j.processor_stats)==null?void 0:T.average_file_time)||0,totalFileSize:j.total_files?j.total_files*.5:0};const ae=new Date,te=[];for(let O=R-1;O>=0;O--){const Q=new Date(ae);Q.setDate(Q.getDate()-O);const G=Math.floor(Y/R)+(Math.random()*2-1),W=Math.floor(G*(H/100));te.push({date:Q.toISOString().split("T")[0],totalJobs:Math.max(0,Math.round(G)),successJobs:Math.max(0,Math.round(W)),failedJobs:Math.max(0,Math.round(G-W)),avgProcessingTime:(((n=j.processor_stats)==null?void 0:n.average_file_time)||0)+(Math.random()*10-5),totalFileSize:Math.round((j.total_files||0)/R*.5*100)/100})}J.value.details=te,I.success("统计数据加载成功")}else{const j=(k==null?void 0:k.error)||"获取统计数据失败";I.error(j)}}catch(D){let R="加载统计数据失败";((w=D==null?void 0:D.response)==null?void 0:w.status)===404?R="批量分析统计服务暂不可用":D!=null&&D.message&&(R=D.message),I.error(R)}finally{V.value=!1}}),"loadMetrics");return ke(()=>{M()}),(T,n)=>{const w=Ye,D=Ve,R=Re,k=we,j=he,Y=Ce,H=Le,ae=He,te=ct;return y(),S("div",ca,[n[17]||(n[17]=a("div",{class:"metrics-header"},[a("h3",null,"统计分析"),a("p",null,"批量分析任务的统计数据和性能指标")],-1)),a("div",da,[e(D,{modelValue:z.value,"onUpdate:modelValue":n[0]||(n[0]=O=>z.value=O),onChange:M},{default:t(()=>[e(w,{value:"today"},{default:t(()=>n[1]||(n[1]=[c("今天",-1)])),_:1,__:[1]}),e(w,{value:"week"},{default:t(()=>n[2]||(n[2]=[c("本周",-1)])),_:1,__:[2]}),e(w,{value:"month"},{default:t(()=>n[3]||(n[3]=[c("本月",-1)])),_:1,__:[3]}),e(w,{value:"quarter"},{default:t(()=>n[4]||(n[4]=[c("本季度",-1)])),_:1,__:[4]}),e(w,{value:"year"},{default:t(()=>n[5]||(n[5]=[c("本年",-1)])),_:1,__:[5]})]),_:1},8,["modelValue"])]),a("div",_a,[e(j,{gutter:20},{default:t(()=>[e(k,{span:6},{default:t(()=>[e(R,{class:"summary-card"},{default:t(()=>[a("div",pa,[a("div",fa,f(J.value.summary.totalJobs||0),1),n[6]||(n[6]=a("div",{class:"summary-label"},"总任务数",-1))])]),_:1})]),_:1}),e(k,{span:6},{default:t(()=>[e(R,{class:"summary-card"},{default:t(()=>[a("div",ma,[a("div",va,f(J.value.summary.successJobs||0),1),n[7]||(n[7]=a("div",{class:"summary-label"},"成功任务",-1))])]),_:1})]),_:1}),e(k,{span:6},{default:t(()=>[e(R,{class:"summary-card"},{default:t(()=>[a("div",ga,[a("div",ya,f(J.value.summary.failedJobs||0),1),n[8]||(n[8]=a("div",{class:"summary-label"},"失败任务",-1))])]),_:1})]),_:1}),e(k,{span:6},{default:t(()=>[e(R,{class:"summary-card"},{default:t(()=>[a("div",ba,[a("div",ha,f((J.value.summary.avgProcessingTime||0).toFixed(1))+"s",1),n[9]||(n[9]=a("div",{class:"summary-label"},"平均处理时间",-1))])]),_:1})]),_:1})]),_:1})]),a("div",wa,[e(j,{gutter:20},{default:t(()=>[e(k,{span:12},{default:t(()=>[e(R,{class:"chart-card"},{default:t(()=>[n[11]||(n[11]=a("div",{class:"chart-header"},[a("h4",null,"任务状态分布")],-1)),a("div",$a,[e(Y,null,{default:t(()=>[e(N(_t))]),_:1}),n[10]||(n[10]=a("p",null,"图表加载中...",-1))])]),_:1,__:[11]})]),_:1}),e(k,{span:12},{default:t(()=>[e(R,{class:"chart-card"},{default:t(()=>[n[13]||(n[13]=a("div",{class:"chart-header"},[a("h4",null,"分析类型分布")],-1)),a("div",ka,[e(Y,null,{default:t(()=>[e(N(Ut))]),_:1}),n[12]||(n[12]=a("p",null,"图表加载中...",-1))])]),_:1,__:[13]})]),_:1})]),_:1}),e(j,{gutter:20,style:{"margin-top":"20px"}},{default:t(()=>[e(k,{span:24},{default:t(()=>[e(R,{class:"chart-card"},{default:t(()=>[n[15]||(n[15]=a("div",{class:"chart-header"},[a("h4",null,"处理时间趋势")],-1)),a("div",xa,[e(Y,null,{default:t(()=>[e(N(pt))]),_:1}),n[14]||(n[14]=a("p",null,"图表加载中...",-1))])]),_:1,__:[15]})]),_:1})]),_:1})]),a("div",Ca,[e(R,null,{default:t(()=>[n[16]||(n[16]=a("div",{class:"table-header"},[a("h4",null,"详细统计")],-1)),gt((y(),se(ae,{data:J.value.details},{default:t(()=>[e(H,{prop:"date",label:"日期",width:"120"}),e(H,{prop:"totalJobs",label:"总任务",width:"100"}),e(H,{prop:"successJobs",label:"成功",width:"100"}),e(H,{prop:"failedJobs",label:"失败",width:"100"}),e(H,{prop:"avgProcessingTime",label:"平均时长(s)",width:"120"}),e(H,{prop:"totalFileSize",label:"文件大小(MB)",width:"120"})]),_:1},8,["data"])),[[te,V.value]])]),_:1,__:[16]})])])}}}),Va=ue(ja,[["__scopeId","data-v-c4dc6da1"]]),Ma={class:"system-status"},Ta={class:"status-header"},Sa={class:"refresh-info"},Da={class:"last-update"},Ra={class:"system-overview"},Ua={class:"status-indicator"},Ea={class:"status-text"},Ba={class:"detailed-status"},Ja={class:"service-list"},Fa={class:"service-info"},Aa={class:"service-details"},za={class:"service-metrics"},Ia={class:"response-time"},qa={class:"resource-metrics"},Pa={class:"resource-item"},Na={class:"resource-label"},La={class:"resource-progress"},Ha={class:"progress-text"},Wa={class:"resource-item"},Ya={class:"resource-label"},Ka={class:"resource-progress"},Oa={class:"progress-text"},Ga={class:"resource-item"},Xa={class:"resource-label"},Qa={class:"resource-progress"},Za={class:"progress-text"},el={class:"resource-item"},tl={class:"resource-label"},sl={class:"resource-progress"},al={class:"progress-text"},ll={class:"queue-status"},ol={class:"queue-metric"},nl={class:"metric-value"},il={class:"queue-metric"},rl={class:"metric-value"},ul={class:"queue-metric"},cl={class:"metric-value"},dl={key:0,class:"queue-visualization"},_l={class:"queue-items"},pl={class:"item-info"},fl={class:"job-id"},ml={class:"job-name"},vl={class:"item-meta"},gl={class:"wait-time"},yl={key:0,class:"more-items"},bl={class:"system-logs"},hl={class:"log-filters"},wl={class:"log-list"},$l={class:"log-time"},kl={class:"log-level"},xl={class:"log-message"},Cl={key:0,class:"no-logs"},jl=ce({__name:"SystemStatus",setup(K){const z=E(!1),V=E(""),J=E(""),M=be({overall:"healthy"}),T=be({queueLength:0,activeTasks:0,cpuUsage:0,memoryUsage:0,diskUsage:0,networkUsage:0}),n=E([{name:"文档处理服务",description:"负责文档解析和预处理",status:"running",responseTime:45},{name:"AI分析引擎",description:"执行智能分析任务",status:"running",responseTime:120},{name:"队列管理器",description:"管理任务队列和调度",status:"running",responseTime:15},{name:"结果存储服务",description:"存储和管理分析结果",status:"running",responseTime:30}]),w=be({pending:0,processing:0,avgWaitTime:0}),D=E([]),R=E([]),k=E([]);let j=null;const Y=i(g=>({healthy:"CircleCheck",warning:"Warning",error:"CircleClose"})[g]||"CircleCheck","getHealthIcon"),H=i(g=>({healthy:"#67c23a",warning:"#e6a23c",error:"#f56c6c"})[g]||"#67c23a","getHealthColor"),ae=i(g=>({healthy:"运行正常",warning:"存在警告",error:"系统异常"})[g]||"运行正常","getHealthText"),te=i(g=>({running:"CircleCheck",warning:"Warning",error:"CircleClose",stopped:"CircleClose"})[g]||"CircleCheck","getServiceStatusIcon"),O=i(g=>({running:"#67c23a",warning:"#e6a23c",error:"#f56c6c",stopped:"#909399"})[g]||"#67c23a","getServiceStatusColor"),Q=i(g=>({running:"success",warning:"warning",error:"danger",stopped:"info"})[g]||"success","getServiceStatusType"),G=i(g=>({running:"运行中",warning:"警告",error:"错误",stopped:"已停止"})[g]||"运行中","getServiceStatusText"),W=i(g=>g<60?"#67c23a":g<80?"#e6a23c":"#f56c6c","getProgressColor"),X=i(g=>({high:"danger",medium:"warning",low:"info"})[g]||"info","getPriorityType"),oe=i(g=>({high:"高优先级",medium:"中优先级",low:"低优先级"})[g]||"低优先级","getPriorityText"),u=i(g=>({error:"danger",warning:"warning",info:"info"})[g]||"info","getLogLevelType"),l=i(g=>new Date(g).toLocaleString("zh-CN"),"formatTime"),x=i(()=>Z(this,null,function*(){var g,s,r,v;z.value=!0;try{const o=yield Ot();if(o&&o.success&&o.status){const _=o.status;M.overall=_.status==="healthy"?"healthy":_.status==="busy"?"warning":"error",_.resource_usage&&(T.cpuUsage=_.resource_usage.cpu_usage||0,T.memoryUsage=_.resource_usage.memory_usage||0,T.diskUsage=_.resource_usage.disk_usage||0,T.networkUsage=0),T.queueLength=_.queue_length||0,T.activeTasks=_.active_jobs||0,w.pending=_.queue_length||0,w.processing=_.active_jobs||0,w.avgWaitTime=((g=_.performance)==null?void 0:g.average_file_time)||0,n.value=[{name:"批量分析服务",description:"文档批量分析处理服务",status:_.status==="healthy"?"running":"warning",responseTime:Math.round(Math.random()*50+10)},{name:"AI分析引擎",description:"智能文档分析引擎",status:"running",responseTime:Math.round(Math.random()*100+50)},{name:"文件处理器",description:"文档上传和预处理服务",status:((s=_.processing_capacity)==null?void 0:s.active_workers)>0?"running":"stopped",responseTime:Math.round(Math.random()*30+20)}],D.value=Array.from({length:Math.min(_.queue_length||0,5)},(F,b)=>({jobId:1e3+b,name:"批量分析任务 #".concat(1e3+b),priority:["high","medium","low"][Math.floor(Math.random()*3)],waitTime:Math.round(Math.random()*300+60)})),V.value=l(Date.now())}else{const _=(o==null?void 0:o.error)||"获取系统状态数据格式错误";I.error(_)}}catch(o){let _="获取系统状态失败";((r=o==null?void 0:o.response)==null?void 0:r.status)===404?_="系统状态API端点不存在":((v=o==null?void 0:o.response)==null?void 0:v.status)===500?_="服务器内部错误":o!=null&&o.message&&(_=o.message),I.error(_)}finally{z.value=!1}}),"refreshStatus"),L=i(()=>Z(this,null,function*(){try{const g=[{id:1,timestamp:Date.now()-3e5,level:"info",message:"批量分析任务 #1001 已完成"},{id:2,timestamp:Date.now()-6e5,level:"warning",message:"文档处理服务响应时间较长"},{id:3,timestamp:Date.now()-9e5,level:"error",message:"任务 #1000 处理失败：文件格式不支持"}];R.value=g,U()}catch(g){I.error("加载系统日志失败")}}),"loadLogs"),U=i(()=>{J.value?k.value=R.value.filter(g=>g.level===J.value):k.value=[...R.value]},"filterLogs"),d=i(()=>{j=window.setInterval(()=>{x()},3e4)},"startAutoRefresh"),m=i(()=>{j&&(clearInterval(j),j=null)},"stopAutoRefresh");return ke(()=>{x(),L(),d()}),Je(()=>{m()}),(g,s)=>{const r=$e,v=Ce,o=Re,_=we,F=ut,b=he,$=je,h=Ne,C=Be,ee=Ee,le=qe;return y(),S("div",Ma,[a("div",Ta,[s[2]||(s[2]=a("h3",null,"系统状态",-1)),s[3]||(s[3]=a("p",null,"批量分析系统的实时运行状态和性能监控",-1)),a("div",Sa,[e(r,{icon:N(me),onClick:x,loading:z.value},{default:t(()=>s[1]||(s[1]=[c(" 刷新状态 ",-1)])),_:1,__:[1]},8,["icon","loading"]),a("span",Da,"最后更新: "+f(V.value),1)])]),a("div",Ra,[e(b,{gutter:20},{default:t(()=>[e(_,{span:6},{default:t(()=>[e(o,{class:pe(["status-card",{"status-healthy":M.overall==="healthy"}])},{default:t(()=>[a("div",Ua,[e(v,{class:pe(Y(M.overall)),color:H(M.overall)},{default:t(()=>[(y(),se(De(Y(M.overall))))]),_:1},8,["class","color"]),a("div",Ea,[s[4]||(s[4]=a("h4",null,"系统状态",-1)),a("p",null,f(ae(M.overall)),1)])])]),_:1},8,["class"])]),_:1}),e(_,{span:6},{default:t(()=>[e(o,{class:"metric-card"},{default:t(()=>[e(F,{title:"当前队列",value:T.queueLength,suffix:"个任务","prefix-icon":g.List},null,8,["value","prefix-icon"])]),_:1})]),_:1}),e(_,{span:6},{default:t(()=>[e(o,{class:"metric-card"},{default:t(()=>[e(F,{title:"并发处理",value:T.activeTasks,suffix:"个任务","prefix-icon":g.Cpu},null,8,["value","prefix-icon"])]),_:1})]),_:1}),e(_,{span:6},{default:t(()=>[e(o,{class:"metric-card"},{default:t(()=>[e(F,{title:"系统负载",value:T.cpuUsage,suffix:"%","prefix-icon":N(Et)},null,8,["value","prefix-icon"])]),_:1})]),_:1})]),_:1})]),a("div",Ba,[e(b,{gutter:20},{default:t(()=>[e(_,{span:12},{default:t(()=>[e(o,{header:"服务状态"},{default:t(()=>[a("div",Ja,[(y(!0),S(ie,null,re(n.value,A=>(y(),S("div",{key:A.name,class:"service-item"},[a("div",Fa,[e(v,{color:O(A.status)},{default:t(()=>[(y(),se(De(te(A.status))))]),_:2},1032,["color"]),a("div",Aa,[a("h5",null,f(A.name),1),a("p",null,f(A.description),1)])]),a("div",za,[e($,{type:Q(A.status),size:"small"},{default:t(()=>[c(f(G(A.status)),1)]),_:2},1032,["type"]),a("span",Ia,f(A.responseTime)+"ms",1)])]))),128))])]),_:1})]),_:1}),e(_,{span:12},{default:t(()=>[e(o,{header:"资源使用情况"},{default:t(()=>[a("div",qa,[a("div",Pa,[a("div",Na,[e(v,null,{default:t(()=>[e(N(at))]),_:1}),s[5]||(s[5]=a("span",null,"CPU 使用率",-1))]),a("div",La,[e(h,{percentage:T.cpuUsage,color:W(T.cpuUsage),"show-text":!1},null,8,["percentage","color"]),a("span",Ha,f(T.cpuUsage)+"%",1)])]),a("div",Wa,[a("div",Ya,[e(v,null,{default:t(()=>[e(N(at))]),_:1}),s[6]||(s[6]=a("span",null,"内存使用率",-1))]),a("div",Ka,[e(h,{percentage:T.memoryUsage,color:W(T.memoryUsage),"show-text":!1},null,8,["percentage","color"]),a("span",Oa,f(T.memoryUsage)+"%",1)])]),a("div",Ga,[a("div",Xa,[e(v,null,{default:t(()=>[e(N(Bt))]),_:1}),s[7]||(s[7]=a("span",null,"存储使用率",-1))]),a("div",Qa,[e(h,{percentage:T.diskUsage,color:W(T.diskUsage),"show-text":!1},null,8,["percentage","color"]),a("span",Za,f(T.diskUsage)+"%",1)])]),a("div",el,[a("div",tl,[e(v,null,{default:t(()=>[e(N(Jt))]),_:1}),s[8]||(s[8]=a("span",null,"网络负载",-1))]),a("div",sl,[e(h,{percentage:T.networkUsage,color:W(T.networkUsage),"show-text":!1},null,8,["percentage","color"]),a("span",al,f(T.networkUsage)+"%",1)])])])]),_:1})]),_:1})]),_:1})]),a("div",ll,[e(o,{header:"队列状态"},{default:t(()=>[e(b,{gutter:20},{default:t(()=>[e(_,{span:8},{default:t(()=>[a("div",ol,[s[9]||(s[9]=a("h4",null,"等待队列",-1)),a("div",nl,f(w.pending),1),s[10]||(s[10]=a("div",{class:"metric-label"},"个任务",-1))])]),_:1}),e(_,{span:8},{default:t(()=>[a("div",il,[s[11]||(s[11]=a("h4",null,"处理中",-1)),a("div",rl,f(w.processing),1),s[12]||(s[12]=a("div",{class:"metric-label"},"个任务",-1))])]),_:1}),e(_,{span:8},{default:t(()=>[a("div",ul,[s[13]||(s[13]=a("h4",null,"平均等待时间",-1)),a("div",cl,f(w.avgWaitTime),1),s[14]||(s[14]=a("div",{class:"metric-label"},"分钟",-1))])]),_:1})]),_:1}),D.value.length>0?(y(),S("div",dl,[s[15]||(s[15]=a("h5",null,"队列详情",-1)),a("div",_l,[(y(!0),S(ie,null,re(D.value.slice(0,10),A=>(y(),S("div",{key:A.jobId,class:pe(["queue-item","priority-".concat(A.priority)])},[a("div",pl,[a("span",fl,"#"+f(A.jobId),1),a("span",ml,f(A.name),1)]),a("div",vl,[e($,{type:X(A.priority),size:"small"},{default:t(()=>[c(f(oe(A.priority)),1)]),_:2},1032,["type"]),a("span",gl,"等待 "+f(A.waitTime)+"分钟",1)])],2))),128))]),D.value.length>10?(y(),S("div",yl," 还有 "+f(D.value.length-10)+" 个任务... ",1)):P("",!0)])):P("",!0)]),_:1})]),a("div",bl,[e(o,{header:"系统日志"},{default:t(()=>[a("div",hl,[e(ee,{modelValue:J.value,"onUpdate:modelValue":s[0]||(s[0]=A=>J.value=A),placeholder:"日志级别",onChange:U},{default:t(()=>[e(C,{label:"全部",value:""}),e(C,{label:"错误",value:"error"}),e(C,{label:"警告",value:"warning"}),e(C,{label:"信息",value:"info"})]),_:1},8,["modelValue"]),e(r,{icon:N(me),onClick:L},{default:t(()=>s[16]||(s[16]=[c("刷新日志",-1)])),_:1,__:[16]},8,["icon"])]),a("div",wl,[(y(!0),S(ie,null,re(k.value,A=>(y(),S("div",{key:A.id,class:pe(["log-item","log-".concat(A.level)])},[a("div",$l,f(l(A.timestamp)),1),a("div",kl,[e($,{type:u(A.level),size:"small"},{default:t(()=>[c(f(A.level.toUpperCase()),1)]),_:2},1032,["type"])]),a("div",xl,f(A.message),1)],2))),128))]),k.value.length===0?(y(),S("div",Cl,[e(le,{description:"暂无日志记录"})])):P("",!0)]),_:1})])])}}}),Vl=ue(jl,[["__scopeId","data-v-9ad82e91"]]),Ml={class:"batch-job-details"},Tl={class:"details-header"},Sl={class:"job-title"},Dl={class:"job-actions"},Rl={class:"job-overview"},Ul={class:"progress-overview"},El={class:"progress-item"},Bl={class:"stats-grid"},Jl={class:"stat-item"},Fl={class:"stat-value"},Al={class:"stat-item"},zl={class:"stat-value"},Il={class:"stat-item"},ql={class:"stat-value"},Pl={class:"stat-item"},Nl={class:"stat-value"},Ll={key:0,class:"current-processing"},Hl={key:1,class:"time-info"},Wl={key:0,class:"job-description"},Yl={class:"file-details"},Kl={class:"file-filters"},Ol={class:"file-name-cell"},Gl={key:1,class:"error-details"},Xl={class:"error-content"},Ql={key:0,class:"error-meta"},Zl={class:"config-details"},eo={key:0,class:"file-result-content"},to={key:0,class:"file-error-content"},so=ce({__name:"BatchJobDetails",props:{job:{}},emits:["jobCancelled","jobRetried","close"],setup(K,{emit:z}){const V=K,J=Xt(),M=z,T=E("all"),n=E(""),w=E(!1),D=E(!1),R=E(null),k=E(null),j=ne(()=>{let s=V.job.results||[];if(T.value!=="all"&&(s=s.filter(r=>r.status===T.value)),n.value){const r=n.value.toLowerCase();s=s.filter(v=>v.file_name.toLowerCase().includes(r))}return s}),Y=i(s=>({pending:"info",processing:"warning",completed:"success",failed:"danger",cancelled:"info"})[s]||"info","getStatusTagType"),H=i(s=>({pending:"等待中",processing:"处理中",completed:"已完成",failed:"已失败",cancelled:"已取消"})[s]||s,"getStatusText"),ae=i(s=>({customer_requirements:"客户需求分析",competitor_analysis:"竞品资料分析",project_mining:"历史项目挖掘",product_extraction:"产品信息提取",document_classification:"文档分类",quality_assessment:"质量评估",comprehensive:"综合分析"})[s]||s,"getAnalysisTypeText"),te=i(s=>({speed:"速度优先",accuracy:"准确性优先",balanced:"平衡模式"})[s]||s,"getPriorityText"),O=i(s=>({success:"success",failed:"danger",processing:"warning",skipped:"info"})[s]||"info","getFileStatusType"),Q=i(s=>({success:"成功",failed:"失败",processing:"处理中",skipped:"跳过"})[s]||s,"getFileStatusText"),G=i(s=>["pending","processing"].includes(s),"canCancel"),W=i(s=>["failed","cancelled"].includes(s),"canRetry"),X=i(s=>new Date(s).toLocaleString("zh-CN"),"formatTime"),oe=i(s=>s<60?"".concat(s,"秒"):s<3600?"".concat(Math.floor(s/60),"分钟"):"".concat(Math.floor(s/3600),"小时").concat(Math.floor(s%3600/60),"分钟"),"formatDuration"),u=i(s=>s<1024?s+" B":s<1024*1024?(s/1024).toFixed(1)+" KB":s<1024*1024*1024?(s/(1024*1024)).toFixed(1)+" MB":(s/(1024*1024*1024)).toFixed(1)+" GB","formatFileSize"),l=i(()=>{},"filterFiles"),x=i(()=>Z(this,null,function*(){try{if((yield fe.confirm('确定要取消任务 "'.concat(V.job.job_name||"#".concat(V.job.job_id),'" 吗？'),"取消任务",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}))!=="confirm")return;const r=yield ft(V.job.job_id);if(r.success)I.success("任务已取消"),M("jobCancelled",V.job.job_id);else throw new Error(r.error||"取消任务失败")}catch(s){s.message!=="cancel"&&I.error(s.message||"取消任务失败")}}),"cancelJob"),L=i(()=>Z(this,null,function*(){try{if((yield fe.confirm('确定要重试任务 "'.concat(V.job.job_name||"#".concat(V.job.job_id),'" 吗？'),"重试任务",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"}))!=="confirm")return;const r=yield Ke(V.job.job_id);if(r.success)I.success("任务已重新提交，新任务ID: ".concat(r.new_job_id)),M("jobRetried",r.new_job_id);else throw new Error(r.error||"重试任务失败")}catch(s){s.message!=="cancel"&&I.error(s.message||"重试任务失败")}}),"retryJob"),U=i(()=>{J.push("/batch-analysis/results/".concat(V.job.job_id)),M("close")},"viewDetailedResults"),d=i(()=>{I.info("开始下载结果文件...")},"downloadResults"),m=i(s=>{R.value=s,w.value=!0},"viewFileResult"),g=i(s=>{k.value=s,D.value=!0},"viewFileError");return(s,r)=>{const v=je,o=$e,_=At,F=Ft,b=Re,$=we,h=Ne,C=Ce,ee=he,le=Ye,A=Ve,de=Ue,p=Le,ve=He,Me=ze,_e=nt,Te=We;return y(),S("div",Ml,[a("div",Tl,[a("div",Sl,[a("h3",null,f(s.job.job_name||"任务 #".concat(s.job.job_id)),1),e(v,{type:Y(s.job.status),size:"large"},{default:t(()=>[c(f(H(s.job.status)),1)]),_:1},8,["type"])]),a("div",Dl,[G(s.job.status)?(y(),se(o,{key:0,type:"warning",icon:N(Se),onClick:x},{default:t(()=>r[5]||(r[5]=[c(" 取消任务 ",-1)])),_:1,__:[5]},8,["icon"])):P("",!0),W(s.job.status)?(y(),se(o,{key:1,type:"primary",icon:N(me),onClick:L},{default:t(()=>r[6]||(r[6]=[c(" 重试任务 ",-1)])),_:1,__:[6]},8,["icon"])):P("",!0),s.job.status==="completed"?(y(),se(o,{key:2,type:"primary",icon:N(Pe),onClick:U},{default:t(()=>r[7]||(r[7]=[c(" 查看详细结果 ",-1)])),_:1,__:[7]},8,["icon"])):P("",!0),s.job.status==="completed"?(y(),se(o,{key:3,type:"success",icon:N(dt),onClick:d},{default:t(()=>r[8]||(r[8]=[c(" 下载结果 ",-1)])),_:1,__:[8]},8,["icon"])):P("",!0),e(o,{onClick:r[0]||(r[0]=q=>s.$emit("close"))},{default:t(()=>r[9]||(r[9]=[c("关闭",-1)])),_:1,__:[9]})])]),a("div",Rl,[e(ee,{gutter:20},{default:t(()=>[e($,{span:12},{default:t(()=>[e(b,{header:"基本信息"},{default:t(()=>[e(F,{column:1,border:""},{default:t(()=>[e(_,{label:"任务ID"},{default:t(()=>[c(f(s.job.job_id),1)]),_:1}),e(_,{label:"任务名称"},{default:t(()=>[c(f(s.job.job_name||"未命名"),1)]),_:1}),e(_,{label:"分析类型"},{default:t(()=>[c(f(ae(s.job.analysis_type)),1)]),_:1}),e(_,{label:"处理优先级"},{default:t(()=>[c(f(te(s.job.processing_priority)),1)]),_:1}),e(_,{label:"创建时间"},{default:t(()=>[c(f(X(s.job.created_at)),1)]),_:1}),e(_,{label:"开始时间"},{default:t(()=>[c(f(s.job.started_at?X(s.job.started_at):"未开始"),1)]),_:1}),e(_,{label:"完成时间"},{default:t(()=>[c(f(s.job.completed_at?X(s.job.completed_at):"未完成"),1)]),_:1})]),_:1})]),_:1})]),_:1}),e($,{span:12},{default:t(()=>[e(b,{header:"进度统计"},{default:t(()=>{var q,ge,B,ye,Oe,Ge,Xe;return[a("div",Ul,[a("div",El,[r[10]||(r[10]=a("div",{class:"progress-label"},"总体进度",-1)),e(h,{percentage:((q=s.job.progress)==null?void 0:q.percentage)||0,status:s.job.status==="failed"?"exception":"success","stroke-width":12},null,8,["percentage","status"])]),a("div",Bl,[a("div",Jl,[a("div",Fl,f(((ge=s.job.progress)==null?void 0:ge.total_files)||0),1),r[11]||(r[11]=a("div",{class:"stat-label"},"总文件数",-1))]),a("div",Al,[a("div",zl,f(((B=s.job.progress)==null?void 0:B.processed_files)||0),1),r[12]||(r[12]=a("div",{class:"stat-label"},"已处理",-1))]),a("div",Il,[a("div",ql,f(((ye=s.job.progress)==null?void 0:ye.successful_files)||0),1),r[13]||(r[13]=a("div",{class:"stat-label"},"成功",-1))]),a("div",Pl,[a("div",Nl,f(((Oe=s.job.progress)==null?void 0:Oe.failed_files)||0),1),r[14]||(r[14]=a("div",{class:"stat-label"},"失败",-1))])]),(Ge=s.job.progress)!=null&&Ge.current_file?(y(),S("div",Ll,[e(C,{class:"processing-icon"},{default:t(()=>[e(N(zt))]),_:1}),a("span",null,"当前处理: "+f(s.job.progress.current_file),1)])):P("",!0),((Xe=s.job.progress)==null?void 0:Xe.estimated_remaining_time)>0?(y(),S("div",Hl,[e(C,null,{default:t(()=>[e(N(pt))]),_:1}),a("span",null,"预计剩余时间: "+f(oe(s.job.progress.estimated_remaining_time)),1)])):P("",!0)])]}),_:1})]),_:1})]),_:1})]),s.job.description?(y(),S("div",Wl,[e(b,{header:"任务描述"},{default:t(()=>[a("p",null,f(s.job.description),1)]),_:1})])):P("",!0),a("div",Yl,[e(b,{header:"文件处理详情"},{default:t(()=>[a("div",Kl,[e(A,{modelValue:T.value,"onUpdate:modelValue":r[1]||(r[1]=q=>T.value=q),onChange:l},{default:t(()=>[e(le,{value:"all"},{default:t(()=>r[15]||(r[15]=[c("全部文件",-1)])),_:1,__:[15]}),e(le,{value:"success"},{default:t(()=>r[16]||(r[16]=[c("成功",-1)])),_:1,__:[16]}),e(le,{value:"failed"},{default:t(()=>r[17]||(r[17]=[c("失败",-1)])),_:1,__:[17]}),e(le,{value:"processing"},{default:t(()=>r[18]||(r[18]=[c("处理中",-1)])),_:1,__:[18]})]),_:1},8,["modelValue"]),e(de,{modelValue:n.value,"onUpdate:modelValue":r[2]||(r[2]=q=>n.value=q),placeholder:"搜索文件名","prefix-icon":N(Ie),clearable:"",onInput:l,style:{width:"200px"}},null,8,["modelValue","prefix-icon"])]),e(ve,{data:j.value,stripe:"",border:"",style:{width:"100%","margin-top":"15px"},"default-sort":{prop:"processing_time",order:"descending"}},{default:t(()=>[e(p,{prop:"file_name",label:"文件名","min-width":"200"},{default:t(({row:q})=>[a("div",Ol,[e(C,null,{default:t(()=>[e(N(_t))]),_:1}),a("span",null,f(q.file_name),1)])]),_:1}),e(p,{prop:"file_size",label:"文件大小",width:"100"},{default:t(({row:q})=>[c(f(u(q.file_size)),1)]),_:1}),e(p,{prop:"status",label:"状态",width:"100"},{default:t(({row:q})=>[e(v,{type:O(q.status),size:"small"},{default:t(()=>[c(f(Q(q.status)),1)]),_:2},1032,["type"])]),_:1}),e(p,{prop:"processing_time",label:"处理时间",width:"100",sortable:""},{default:t(({row:q})=>[c(f(oe(q.processing_time)),1)]),_:1}),e(p,{label:"操作",width:"120"},{default:t(({row:q})=>[q.status==="success"?(y(),se(o,{key:0,text:"",size:"small",onClick:i(ge=>m(q),"onClick")},{default:t(()=>r[19]||(r[19]=[c(" 查看结果 ",-1)])),_:2,__:[19]},1032,["onClick"])):P("",!0),q.status==="failed"?(y(),se(o,{key:1,text:"",size:"small",onClick:i(ge=>g(q),"onClick")},{default:t(()=>r[20]||(r[20]=[c(" 查看错误 ",-1)])),_:2,__:[20]},1032,["onClick"])):P("",!0)]),_:1})]),_:1},8,["data"])]),_:1})]),s.job.status==="failed"&&s.job.error_message?(y(),S("div",Gl,[e(b,{header:"错误信息"},{default:t(()=>[e(Me,{title:s.job.error_message,type:"error",closable:!1,"show-icon":""},{default:t(()=>[a("div",Xl,[r[22]||(r[22]=a("p",null,[a("strong",null,"错误详情:")],-1)),a("pre",null,f(s.job.error_details||s.job.error_message),1),s.job.error_timestamp?(y(),S("div",Ql,[a("p",null,[r[21]||(r[21]=a("strong",null,"错误时间:",-1)),c(" "+f(X(s.job.error_timestamp)),1)])])):P("",!0)])]),_:1},8,["title"])]),_:1})])):P("",!0),a("div",Zl,[e(b,{header:"配置信息"},{default:t(()=>[e(F,{column:2,border:""},{default:t(()=>[e(_,{label:"自动重试"},{default:t(()=>[c(f(s.job.auto_retry_failed?"已启用":"已禁用"),1)]),_:1}),e(_,{label:"最大重试次数"},{default:t(()=>[c(f(s.job.max_retries||0),1)]),_:1}),e(_,{label:"完成通知"},{default:t(()=>{var q;return[c(f((q=s.job.notification_settings)!=null&&q.email_on_completion?"已启用":"已禁用"),1)]}),_:1}),e(_,{label:"失败通知"},{default:t(()=>{var q;return[c(f((q=s.job.notification_settings)!=null&&q.email_on_failure?"已启用":"已禁用"),1)]}),_:1}),e(_,{label:"Webhook",span:"2"},{default:t(()=>{var q;return[c(f(((q=s.job.notification_settings)==null?void 0:q.webhook_url)||"未配置"),1)]}),_:1})]),_:1})]),_:1})]),e(Te,{modelValue:w.value,"onUpdate:modelValue":r[3]||(r[3]=q=>w.value=q),title:"文件分析结果",width:"80%",top:"5vh"},{default:t(()=>[R.value?(y(),S("div",eo,[a("h4",null,f(R.value.file_name),1),e(_e),a("pre",null,f(JSON.stringify(R.value.analysis_result,null,2)),1)])):P("",!0)]),_:1},8,["modelValue"]),e(Te,{modelValue:D.value,"onUpdate:modelValue":r[4]||(r[4]=q=>D.value=q),title:"文件处理错误",width:"60%"},{default:t(()=>[k.value?(y(),S("div",to,[a("h4",null,f(k.value.file_name),1),e(_e),e(Me,{title:k.value.error_message,type:"error",closable:!1,"show-icon":""},null,8,["title"])])):P("",!0)]),_:1},8,["modelValue"])])}}}),ao=ue(so,[["__scopeId","data-v-38819533"]]),lo={class:"batch-notification"},oo={class:"notification-container"},no=["onClick"],io={class:"notification-icon"},ro={class:"notification-content"},uo={class:"notification-title"},co={class:"notification-message"},_o={class:"notification-time"},po={class:"notification-actions"},fo={class:"notification-center"},mo={class:"notification-center-content"},vo={class:"notification-filters"},go={class:"notification-actions-bar"},yo={class:"notification-history"},bo=["onClick"],ho={class:"history-notification-header"},wo={class:"notification-meta"},$o={class:"notification-type"},ko={class:"notification-timestamp"},xo={class:"history-notification-content"},Co={key:0,class:"notification-action-buttons"},jo={key:0,class:"no-notifications"},Vo=ce({__name:"BatchNotification",props:{notifications:{}},emits:["notificationDismissed","notificationAction"],setup(K,{emit:z}){const V=K,J=z,M=E(!1),T=E("all"),n=E(3),w=E([]),D=ne(()=>w.value.filter(d=>!d.read&&(d.persistent||!d.autoClose)).slice(0,n.value)),R=ne(()=>w.value.filter(d=>!d.read).length),k=ne(()=>{let d=[...w.value].reverse();switch(T.value){case"unread":d=d.filter(m=>!m.read);break;case"success":d=d.filter(m=>m.type==="success");break;case"error":d=d.filter(m=>m.type==="error");break;case"warning":d=d.filter(m=>m.type==="warning");break;case"info":d=d.filter(m=>m.type==="info");break}return d}),j=i(d=>({success:"CircleCheck",warning:"Warning",error:"CircleClose",info:"InfoFilled"})[d]||"InfoFilled","getNotificationIcon"),Y=i(d=>({success:"#67c23a",warning:"#e6a23c",error:"#f56c6c",info:"#409eff"})[d]||"#409eff","getNotificationColor"),H=i(d=>({success:"成功",warning:"警告",error:"错误",info:"信息"})[d]||"信息","getNotificationTypeText"),ae=i(d=>{const g=Date.now()-d;return g<6e4?"刚刚":g<36e5?"".concat(Math.floor(g/6e4),"分钟前"):g<864e5?"".concat(Math.floor(g/36e5),"小时前"):"".concat(Math.floor(g/864e5),"天前")},"formatRelativeTime"),te=i(d=>new Date(d).toLocaleString("zh-CN"),"formatTime"),O=i(()=>{M.value=!M.value},"toggleNotificationCenter"),Q=i(d=>{if(X(d.id),d.actions&&d.actions.length>0){const m=d.actions[0];x(m,d)}},"handleNotificationClick"),G=i(d=>{const m=w.value.findIndex(g=>g.id===d);m>=0&&w.value.splice(m,1),J("notificationDismissed",d)},"dismissNotification"),W=i(d=>{G(d)},"removeNotification"),X=i(d=>{const m=w.value.find(g=>g.id===d);m&&(m.read=!0)},"markAsRead"),oe=i(()=>{w.value.forEach(d=>{d.read=!0})},"markAllAsRead"),u=i(()=>{w.value=[],J("notificationDismissed","all")},"clearAllNotifications"),l=i(()=>{},"filterNotifications"),x=i((d,m)=>{J("notificationAction",d.action,d.params,m)},"handleAction"),L=i(d=>{if(d.autoClose!==!1){const m=d.duration||5e3;setTimeout(()=>{d.read||G(d.id)},m)}},"setupAutoClose");xe(()=>V.notifications,d=>{d.forEach(m=>{w.value.find(s=>s.id===m.id)||(w.value.push(Fe({},m)),L(m))}),w.value=w.value.filter(m=>d.some(g=>g.id===m.id))},{immediate:!0,deep:!0});const U=i(d=>{d.key==="Escape"&&M.value&&(M.value=!1),(d.ctrlKey||d.metaKey)&&d.shiftKey&&d.key==="N"&&(O(),d.preventDefault())},"handleKeyboard");return ke(()=>{document.addEventListener("keydown",U)}),Je(()=>{document.removeEventListener("keydown",U)}),(d,m)=>{const g=Ce,s=$e,r=It,v=Ye,o=Ve,_=qe,F=qt;return y(),S("div",lo,[a("div",oo,[e(Qt,{name:"notification",tag:"div",class:"notification-list"},{default:t(()=>[(y(!0),S(ie,null,re(D.value,b=>(y(),S("div",{key:b.id,class:pe(["notification-item",["notification-".concat(b.type)]]),onClick:i($=>Q(b),"onClick")},[a("div",io,[e(g,{size:20},{default:t(()=>[(y(),se(De(j(b.type))))]),_:2},1024)]),a("div",ro,[a("div",uo,f(b.title),1),a("div",co,f(b.message),1),a("div",_o,f(ae(b.timestamp)),1)]),a("div",po,[e(s,{text:"",icon:N(Se),onClick:Ae($=>G(b.id),["stop"]),class:"dismiss-button"},null,8,["icon","onClick"])])],10,no))),128))]),_:1})]),a("div",fo,[e(r,{value:R.value,hidden:R.value===0},{default:t(()=>[e(s,{type:"primary",icon:N(Pt),circle:"",onClick:O,class:"notification-button"},null,8,["icon"])]),_:1},8,["value","hidden"])]),e(F,{modelValue:M.value,"onUpdate:modelValue":m[1]||(m[1]=b=>M.value=b),title:"通知中心",direction:"rtl",size:"400px"},{default:t(()=>[a("div",mo,[a("div",vo,[e(o,{modelValue:T.value,"onUpdate:modelValue":m[0]||(m[0]=b=>T.value=b),onChange:l},{default:t(()=>[e(v,{value:"all"},{default:t(()=>m[2]||(m[2]=[c("全部",-1)])),_:1,__:[2]}),e(v,{value:"unread"},{default:t(()=>m[3]||(m[3]=[c("未读",-1)])),_:1,__:[3]}),e(v,{value:"success"},{default:t(()=>m[4]||(m[4]=[c("成功",-1)])),_:1,__:[4]}),e(v,{value:"error"},{default:t(()=>m[5]||(m[5]=[c("错误",-1)])),_:1,__:[5]})]),_:1},8,["modelValue"]),a("div",go,[e(s,{text:"",onClick:oe},{default:t(()=>m[6]||(m[6]=[c(" 全部标记为已读 ",-1)])),_:1,__:[6]}),e(s,{text:"",onClick:u},{default:t(()=>m[7]||(m[7]=[c(" 清空通知 ",-1)])),_:1,__:[7]})])]),a("div",yo,[(y(!0),S(ie,null,re(k.value,b=>(y(),S("div",{key:b.id,class:pe(["history-notification-item",{unread:!b.read}]),onClick:i($=>X(b.id),"onClick")},[a("div",ho,[a("div",wo,[e(g,{color:Y(b.type)},{default:t(()=>[(y(),se(De(j(b.type))))]),_:2},1032,["color"]),a("span",$o,f(H(b.type)),1),a("span",ko,f(te(b.timestamp)),1)]),e(s,{text:"",icon:N(Se),onClick:Ae($=>W(b.id),["stop"]),size:"small"},null,8,["icon","onClick"])]),a("div",xo,[a("h4",null,f(b.title),1),a("p",null,f(b.message),1)]),b.actions?(y(),S("div",Co,[(y(!0),S(ie,null,re(b.actions,$=>(y(),se(s,{key:$.label,type:$.type||"text",size:"small",onClick:Ae(h=>x($,b),["stop"])},{default:t(()=>[c(f($.label),1)]),_:2},1032,["type","onClick"]))),128))])):P("",!0)],10,bo))),128)),k.value.length===0?(y(),S("div",jo,[e(_,{description:"暂无通知"})])):P("",!0)])])]),_:1},8,["modelValue"])])}}}),Mo=ue(Vo,[["__scopeId","data-v-1b48fd98"]]),To={class:"batch-analysis"},So=ce({__name:"BatchAnalysis",setup(K){const z=E("create"),V=E(!1),J=E(null),M=E([]),T=E([]);let n=null;const w=E(0);Zt("refreshTrigger",w);const D=i(u=>Z(this,null,function*(){z.value="monitor",lt({title:"任务提交成功",message:"批量分析任务 #".concat(u," 已提交，正在启动处理..."),type:"success",duration:5e3});try{(yield Gt(u)).success&&lt({title:"任务已启动",message:"批量分析任务 #".concat(u," 已开始处理"),type:"info",duration:3e3})}catch(l){}yield Q(u),G(),w.value++}),"handleJobSubmitted"),R=i(u=>{I.error("任务提交失败: ".concat(u))},"handleSubmissionError"),k=i(u=>{I.warning("任务 #".concat(u," 已取消")),M.value=M.value.filter(l=>l.job_id!==u),w.value++},"handleJobCancelled"),j=i(u=>{I.success("任务已重新提交，新任务ID: #".concat(u)),Q(u),w.value++},"handleJobRetried"),Y=i(u=>{J.value=u,V.value=!0},"handleJobDetails"),H=i(u=>Z(this,null,function*(){try{const l=yield ot(String(u.job_id));if(l&&l.success&&l.status)J.value=l.status;else{const x={success:!0,job_id:u.job_id,job_name:u.job_name||"任务 #".concat(u.job_id),description:u.description||"",status:u.status,analysis_type:u.analysis_type,processing_priority:"balanced",created_at:u.created_at,started_at:u.started_at,completed_at:u.completed_at,total_processing_time:u.total_processing_time,progress:{total_files:u.file_count,processed_files:u.success_count+u.fail_count,successful_files:u.success_count,failed_files:u.fail_count,percentage:u.file_count>0?(u.success_count+u.fail_count)/u.file_count*100:0,estimated_remaining_time:0},results:[],summary:{success_rate:u.success_rate,average_confidence:u.average_confidence,total_cost:u.actual_cost,quality_score:85}};J.value=x}V.value=!0}catch(l){I.error("无法加载任务详情")}}),"handleHistorySelected"),ae=i(()=>{I.success("任务记录已删除"),w.value++},"handleJobDeleted"),te=i((u,l)=>{I.success("开始下载任务 #".concat(u," 的").concat(l.toUpperCase(),"结果文件"))},"handleDownloadResults"),O=i(u=>{T.value=T.value.filter(l=>l.id!==u)},"handleNotificationDismissed"),Q=i(u=>Z(this,null,function*(){var l,x;try{const L=yield ot(String(u));if(L&&L.success&&L.status){const U=L.status,d=U.status,m=M.value.findIndex(g=>g.job_id===u);if(m>=0){const g=M.value[m].status;M.value[m]=U}else["pending","processing"].includes(d)&&M.value.push(U);["completed","failed","cancelled"].includes(d)&&(setTimeout(()=>{M.value=M.value.filter(g=>g.job_id!==u)},5e3),X({type:d==="completed"?"success":"error",title:d==="completed"?"任务完成":"任务失败",message:"批量分析任务 #".concat(u," ").concat(d==="completed"?"已完成":"执行失败")})),((l=J.value)==null?void 0:l.job_id)===u&&(J.value=U)}else M.value=M.value.filter(U=>U.job_id!==u)}catch(L){((x=L==null?void 0:L.response)==null?void 0:x.status)===404&&(M.value=M.value.filter(U=>U.job_id!==u))}}),"loadJobStatus"),G=i(()=>{n||(n=window.setInterval(()=>Z(this,null,function*(){const u=M.value.filter(x=>["pending","processing"].includes(x.status));if(u.length===0){W();return}const l=u.map(x=>Q(x.job_id));yield Promise.allSettled(l)}),1e4))},"startPolling"),W=i(()=>{n&&(clearInterval(n),n=null)},"stopPolling"),X=i(u=>{const l="notification-".concat(Date.now(),"-").concat(Math.random());T.value.push(tt(Fe({id:l},u),{timestamp:Date.now()})),setTimeout(()=>{O(l)},5e3)},"addNotification"),oe=i(()=>Z(this,null,function*(){try{const u=yield mt({page:1,page_size:50,status:""});if(u&&u.success&&u.records){const l=u.records.filter(x=>["pending","processing"].includes(x.status)).map(x=>x.job_id);for(const x of l)yield Q(x);l.length>0&&G()}}catch(u){}}),"loadActiveJobs");return ke(()=>Z(this,null,function*(){I.info("批量分析系统已就绪"),yield oe()})),Je(()=>{W()}),(u,l)=>{const x=Lt,L=Nt,U=We;return y(),S("div",To,[l[3]||(l[3]=a("div",{class:"page-header"},[a("h1",null,"批量文档分析"),a("p",{class:"page-description"},"高效批量处理多个文档，支持大规模数据分析和自动化处理流程")],-1)),e(L,{modelValue:z.value,"onUpdate:modelValue":l[0]||(l[0]=d=>z.value=d),class:"batch-tabs"},{default:t(()=>[e(x,{label:"新建任务",name:"create"},{default:t(()=>[e(vs,{onJobSubmitted:D,onSubmissionError:R})]),_:1}),e(x,{label:"任务监控",name:"monitor"},{default:t(()=>[e(Ys,{jobs:M.value,onJobCancelled:k,onJobRetried:j,onJobDetails:Y},null,8,["jobs"])]),_:1}),e(x,{label:"批量历史",name:"history"},{default:t(()=>[e(ua,{onJobSelected:H,onJobDeleted:ae,onDownloadResults:te})]),_:1}),e(x,{label:"统计分析",name:"metrics"},{default:t(()=>[e(Va)]),_:1}),e(x,{label:"系统状态",name:"status"},{default:t(()=>[e(Vl)]),_:1})]),_:1},8,["modelValue"]),e(U,{modelValue:V.value,"onUpdate:modelValue":l[2]||(l[2]=d=>V.value=d),title:"批量任务详情",width:"80%",top:"5vh"},{default:t(()=>[J.value?(y(),se(ao,{key:0,job:J.value,onJobCancelled:k,onJobRetried:j,onClose:l[1]||(l[1]=d=>V.value=!1)},null,8,["job"])):P("",!0)]),_:1},8,["modelValue"]),e(Mo,{notifications:T.value,onNotificationDismissed:O},null,8,["notifications"])])}}}),pn=ue(So,[["__scopeId","data-v-a997933d"]]);export{pn as default};
