var ke=Object.defineProperty;var u=(R,T)=>ke(R,"name",{value:T,configurable:!0});var B=(R,T,V)=>new Promise((j,z)=>{var C=l=>{try{a(V.next(l))}catch(f){z(f)}},k=l=>{try{a(V.throw(l))}catch(f){z(f)}},a=l=>l.done?j(l.value):Promise.resolve(l.value).then(C,k);a((V=V.apply(R,T)).next())});import{h as L,_ as G}from"./index-CoBZUWE1.js";/* empty css                    *//* empty css                *//* empty css                 *//* empty css                         *//* empty css               */import{x as W,y as d,Q as t,I as s,M as m,P as D,a6 as O,A as e,O as i,K as q,D as H,z as r,u as F,H as K,r as A,c as te,X as we,w as be,j as Ce,V as Te}from"./vendor-vue-XfLkFKXI.js";import{ak as ne,d as ie,O as X,c as ce,j as Y,E as M,M as oe,N as ae,b as le,I as re,bi as Re,bo as ue,aJ as _e,P as pe,bj as Ve,aG as me,bp as ze,ap as ge,w as Pe,ae as de,a as Ee,_ as qe,ag as Ie,W as Se,Z as Fe,as as De,af as Oe,aB as je,b6 as Ue,b7 as Be}from"./vendor-ui-CE-ZhXxH.js";/* empty css                *//* empty css                 *//* empty css                 *//* empty css                        */import"./el-form-item-l0sNRNKZ.js";/* empty css                   */import"./vendor-pdf-BeW0Xq92.js";import"./vendor-utils-B8vW8fJV.js";const se={generateRecommendations(R){return B(this,null,function*(){return(yield L.get("/pricing-decision/recommendations/".concat(R))).data})},getMarketAnalysis(R){return B(this,null,function*(){return(yield L.get("/pricing-decision/market-analysis/".concat(R))).data})},getProductRecommendations(R){return B(this,null,function*(){return(yield L.get("/pricing-decision/product-recommendations/".concat(R))).data})},getPricingStrategies(R){return B(this,null,function*(){return(yield L.get("/pricing-decision/pricing-strategies/".concat(R))).data})},getCompletedJobs(){return B(this,null,function*(){return(yield L.get("/pricing-decision/batch-jobs")).data})},createQuoteFromRecommendation(R){return B(this,null,function*(){return(yield L.post("/pricing-decision/create-quote",R)).data})},exportRecommendations(R){return B(this,null,function*(){return(yield L.get("/pricing-decision/export-recommendations/".concat(R))).data})}},Ne={class:"product-recommendations"},Me={key:0,class:"empty-state"},Qe={key:1,class:"recommendations-list"},Ae={class:"recommendation-header"},Je={class:"product-info"},Le={class:"product-name"},He={class:"product-code"},Ke={class:"product-category"},Ge={class:"match-score"},We={class:"score-text"},Xe={class:"recommendation-content"},Ze={class:"product-description"},Ye={class:"match-reasons"},xe={class:"pricing-info"},et={class:"price-comparison"},tt={class:"price-item"},st={class:"price-value"},nt={class:"price-item"},it={class:"price-value recommended"},ot={class:"price-item"},at={class:"adjustment-reasons"},lt={key:0,class:"config-recommendations"},rt={class:"config-items"},dt={class:"config-key"},ct={class:"config-value"},ut={class:"pricing-strategy"},_t={key:0,class:"primary-strategy"},pt={class:"strategy-card"},mt={class:"strategy-header"},gt={class:"strategy-name"},vt={class:"strategy-description"},yt={key:1,class:"alternative-strategies"},ft={class:"strategy-list"},ht={class:"strategy-name"},$t={class:"strategy-description"},kt={class:"recommendation-actions"},wt=W({__name:"ProductRecommendations",props:{recommendations:{}},emits:["create-quote","view-product","compare-product","refresh"],setup(R,{emit:T}){const V=T,j=u(f=>{V("create-quote",f)},"createQuote"),z=u(f=>{V("view-product",f)},"viewProductDetails"),C=u(f=>{V("compare-product",f),M.info("产品对比功能正在开发中")},"compareProduct"),k=u(f=>new Intl.NumberFormat("zh-CN",{minimumFractionDigits:2,maximumFractionDigits:2}).format(f),"formatPrice"),a=u(f=>f>=.8?"#67c23a":f>=.6?"#e6a23c":"#f56c6c","getScoreColor"),l=u(f=>{switch(f){case"low":return"success";case"medium":return"warning";case"high":return"danger";default:return"info"}},"getStrategyRiskType");return(f,y)=>{const I=ie,N=ne,_=ce,c=Y,o=X;return r(),d("div",Ne,[f.recommendations.length===0?(r(),d("div",Me,[t(N,{description:"暂无产品推荐"},{default:s(()=>[t(I,{type:"primary",onClick:y[0]||(y[0]=n=>f.$emit("refresh"))},{default:s(()=>y[1]||(y[1]=[m(" 刷新数据 ",-1)])),_:1,__:[1]})]),_:1})])):(r(),d("div",Qe,[(r(!0),d(D,null,O(f.recommendations,(n,p)=>(r(),d("div",{key:n.product.id,class:"recommendation-card"},[t(o,{shadow:"hover"},{default:s(()=>[e("div",Ae,[e("div",Je,[e("h3",Le,i(n.product.name),1),e("p",He,"型号: "+i(n.product.code),1),e("p",Ke,"类别: "+i(n.product.category),1)]),e("div",Ge,[t(_,{type:"circle",percentage:Math.round(n.match_score*100),color:a(n.match_score),width:80},{default:s(({percentage:h})=>[e("span",We,i(h)+"%",1)]),_:2},1032,["percentage","color"]),y[2]||(y[2]=e("p",{class:"score-label"},"匹配度",-1))])]),e("div",Xe,[e("div",Ze,[e("p",null,i(n.product.description),1)]),e("div",Ye,[y[3]||(y[3]=e("h4",null,"匹配原因",-1)),e("ul",null,[(r(!0),d(D,null,O(n.match_reasons,h=>(r(),d("li",{key:h},i(h),1))),128))])]),e("div",xe,[y[8]||(y[8]=e("h4",null,"价格建议",-1)),e("div",et,[e("div",tt,[y[4]||(y[4]=e("span",{class:"price-label"},"基础价格:",-1)),e("span",st,"¥"+i(k(n.recommended_price.base_price)),1)]),e("div",nt,[y[5]||(y[5]=e("span",{class:"price-label"},"建议价格:",-1)),e("span",it,"¥"+i(k(n.recommended_price.recommended_price)),1)]),e("div",ot,[y[6]||(y[6]=e("span",{class:"price-label"},"调整幅度:",-1)),e("span",{class:H(["price-change",n.recommended_price.price_change_percentage>=0?"positive":"negative"])},i(n.recommended_price.price_change_percentage>0?"+":"")+i(n.recommended_price.price_change_percentage)+"% ",3)])]),e("div",at,[y[7]||(y[7]=e("h5",null,"调整原因:",-1)),e("ul",null,[(r(!0),d(D,null,O(n.recommended_price.adjustment_reasons,h=>(r(),d("li",{key:h},i(h),1))),128))])])]),Object.keys(n.config_recommendations).length>0?(r(),d("div",lt,[y[9]||(y[9]=e("h4",null,"配置建议",-1)),e("div",rt,[(r(!0),d(D,null,O(n.config_recommendations,(h,w)=>(r(),d("div",{key:w,class:"config-item"},[e("span",dt,i(w)+":",1),e("span",ct,i(h),1)]))),128))])])):q("",!0),e("div",ut,[y[11]||(y[11]=e("h4",null,"推荐策略",-1)),n.pricing_strategy.primary_strategy?(r(),d("div",_t,[e("div",pt,[e("div",mt,[e("span",gt,i(n.pricing_strategy.primary_strategy.name),1),t(c,{type:l(n.pricing_strategy.primary_strategy.risk_level),size:"small"},{default:s(()=>[m(i(n.pricing_strategy.primary_strategy.risk_level)+" 风险 ",1)]),_:2},1032,["type"])]),e("p",vt,i(n.pricing_strategy.primary_strategy.description),1)])])):q("",!0),n.pricing_strategy.recommended_strategies.length>1?(r(),d("div",yt,[y[10]||(y[10]=e("h5",null,"备选策略:",-1)),e("div",ft,[(r(!0),d(D,null,O(n.pricing_strategy.recommended_strategies.slice(1),h=>(r(),d("div",{key:h.name,class:"strategy-item"},[e("span",ht,i(h.name),1),e("span",$t,i(h.description),1)]))),128))])])):q("",!0)])]),e("div",kt,[t(I,{type:"primary",onClick:u(h=>j(n),"onClick"),icon:"Plus"},{default:s(()=>y[12]||(y[12]=[m(" 创建报价 ",-1)])),_:2,__:[12]},1032,["onClick"]),t(I,{onClick:u(h=>z(n.product),"onClick"),icon:"View"},{default:s(()=>y[13]||(y[13]=[m(" 查看详情 ",-1)])),_:2,__:[13]},1032,["onClick"]),t(I,{onClick:u(h=>C(n),"onClick"),icon:"TrendCharts"},{default:s(()=>y[14]||(y[14]=[m(" 对比分析 ",-1)])),_:2,__:[14]},1032,["onClick"])])]),_:2},1024)]))),128))]))])}}}),bt=G(wt,[["__scopeId","data-v-85f7728e"]]),Ct={class:"market-analysis"},Tt={class:"market-overview"},Rt={class:"metric-content"},Vt={class:"metric-icon trend"},zt={class:"metric-info"},Pt={class:"metric-content"},Et={class:"metric-icon competition"},qt={class:"metric-info"},It={class:"metric-detail"},St={class:"metric-content"},Ft={class:"metric-icon demand"},Dt={class:"metric-info"},Ot={class:"metric-detail"},jt={class:"detailed-analysis"},Ut={class:"card-header"},Bt={class:"competition-analysis"},Nt={class:"competition-chart"},Mt={class:"chart-header"},Qt={class:"score"},At={class:"competitor-features"},Jt={class:"feature-list"},Lt={class:"feature-item"},Ht={class:"feature-value"},Kt={class:"feature-item"},Gt={class:"feature-value"},Wt={class:"feature-item"},Xt={class:"feature-value"},Zt={class:"competition-recommendations"},Yt={key:0},xt={key:1},es={key:2},ts={key:3},ss={class:"card-header"},ns={class:"opportunity-analysis"},is={class:"opportunity-chart"},os={class:"chart-header"},as={class:"score"},ls={class:"opportunity-stats"},rs={class:"stats-grid"},ds={class:"stat-item"},cs={class:"stat-number"},us={class:"stat-item"},_s={class:"stat-number"},ps={key:0,class:"top-opportunities"},ms={class:"opportunity-list"},gs={class:"opportunity-content"},vs={class:"opportunity-title"},ys={class:"opportunity-description"},fs={class:"price-sensitivity-section"},hs={class:"card-header"},$s={class:"sensitivity-analysis"},ks={class:"sensitivity-chart"},ws={class:"score-text"},bs={class:"sensitivity-factors"},Cs={class:"factor-list"},Ts={class:"factor-item"},Rs={class:"factor-value"},Vs={class:"factor-item"},zs={class:"factor-value"},Ps={class:"sensitivity-recommendations"},Es={key:0},qs={key:1},Is={key:2},Ss={key:3},Fs={class:"demand-analysis-section"},Ds={class:"card-header"},Os={class:"demand-analysis"},js={class:"demand-overview"},Us={class:"demand-stats"},Bs={class:"demand-stat"},Ns={class:"stat-number"},Ms={class:"demand-stat"},Qs={class:"stat-number"},As={class:"demand-score"},Js={class:"trending-products"},Ls={key:0,class:"trending-list"},Hs={class:"trending-rank"},Ks={class:"trending-info"},Gs={class:"trending-category"},Ws={class:"trending-count"},Xs={class:"trending-bar"},Zs={key:1,class:"no-trending"},Ys=W({__name:"MarketAnalysis",props:{marketContext:{}},setup(R){const T=u(o=>typeof o=="string"?o:typeof o=="object"?o.description||o.title||JSON.stringify(o):String(o),"formatOpportunity"),V=u(o=>{switch(o){case"growing":return"trend-growing";case"stable":return"trend-stable";case"declining":return"trend-declining";default:return"trend-unknown"}},"getTrendClass"),j=u(o=>{switch(o){case"growing":return"增长中";case"stable":return"稳定";case"declining":return"下降";default:return"未知"}},"getTrendText"),z=u(o=>{switch(o){case"low":return"intensity-low";case"medium":return"intensity-medium";case"high":return"intensity-high";default:return"intensity-unknown"}},"getIntensityClass"),C=u(o=>{switch(o){case"low":return"低";case"medium":return"中等";case"high":return"激烈";default:return"未知"}},"getIntensityText"),k=u(o=>{switch(o){case"low":return"success";case"medium":return"warning";case"high":return"danger";default:return"info"}},"getIntensityType"),a=u(o=>{switch(o){case"low":return"heat-low";case"medium":return"heat-medium";case"high":return"heat-high";default:return"heat-unknown"}},"getHeatClass"),l=u(o=>{switch(o){case"low":return"较低";case"medium":return"中等";case"high":return"旺盛";default:return"未知"}},"getHeatText"),f=u(o=>{switch(o){case"low":return"info";case"medium":return"warning";case"high":return"success";default:return"info"}},"getHeatType"),y=u(o=>{switch(o){case"low":return"较少";case"medium":return"中等";case"high":return"丰富";default:return"未知"}},"getOpportunityText"),I=u(o=>{switch(o){case"low":return"info";case"medium":return"warning";case"high":return"success";default:return"info"}},"getOpportunityType"),N=u(o=>{switch(o){case"low":return"不";case"medium":return"中等";case"high":return"高度";default:return"未知"}},"getSensitivityText"),_=u(o=>{switch(o){case"low":return"success";case"medium":return"warning";case"high":return"danger";default:return"info"}},"getSensitivityType"),c=u(o=>o>=.8?"#67c23a":o>=.6?"#e6a23c":o>=.4?"#f56c6c":"#909399","getProgressColor");return(o,n)=>{const p=le,h=X,w=ae,U=oe,E=Y,$=ce;return r(),d("div",Ct,[e("div",Tt,[t(U,{gutter:24},{default:s(()=>[t(w,{span:8},{default:s(()=>[t(h,{class:"metric-card"},{default:s(()=>[e("div",Rt,[e("div",Vt,[t(p,null,{default:s(()=>[t(F(re))]),_:1})]),e("div",zt,[n[0]||(n[0]=e("h3",null,"市场趋势",-1)),e("p",{class:H(["metric-value",V(o.marketContext.market_trend)])},i(j(o.marketContext.market_trend)),3)])])]),_:1})]),_:1}),t(w,{span:8},{default:s(()=>[t(h,{class:"metric-card"},{default:s(()=>[e("div",Pt,[e("div",Et,[t(p,null,{default:s(()=>[t(F(Re))]),_:1})]),e("div",qt,[n[1]||(n[1]=e("h3",null,"竞争强度",-1)),e("p",{class:H(["metric-value",z(o.marketContext.competition_intensity.level)])},i(C(o.marketContext.competition_intensity.level)),3),e("p",It,i(o.marketContext.competition_intensity.competitor_count)+" 个竞争对手",1)])])]),_:1})]),_:1}),t(w,{span:8},{default:s(()=>[t(h,{class:"metric-card"},{default:s(()=>[e("div",St,[e("div",Ft,[t(p,null,{default:s(()=>[t(F(ue))]),_:1})]),e("div",Dt,[n[2]||(n[2]=e("h3",null,"需求热度",-1)),e("p",{class:H(["metric-value",a(o.marketContext.demand_heat.level)])},i(l(o.marketContext.demand_heat.level)),3),e("p",Ot,i(o.marketContext.demand_heat.total_demands)+" 个需求点",1)])])]),_:1})]),_:1})]),_:1})]),e("div",jt,[t(U,{gutter:24},{default:s(()=>[t(w,{span:12},{default:s(()=>[t(h,null,{header:s(()=>[e("div",Ut,[n[3]||(n[3]=e("span",null,"竞争环境分析",-1)),t(E,{type:k(o.marketContext.competition_intensity.level)},{default:s(()=>[m(i(C(o.marketContext.competition_intensity.level))+"竞争 ",1)]),_:1},8,["type"])])]),default:s(()=>[e("div",Bt,[e("div",Nt,[e("div",Mt,[n[4]||(n[4]=e("h4",null,"竞争强度评分",-1)),e("span",Qt,i((o.marketContext.competition_intensity.score*100).toFixed(0))+"分",1)]),t($,{percentage:o.marketContext.competition_intensity.score*100,color:c(o.marketContext.competition_intensity.score),"stroke-width":20},null,8,["percentage","color"])]),e("div",At,[n[8]||(n[8]=e("h4",null,"竞争对手特征",-1)),e("div",Jt,[e("div",Lt,[n[5]||(n[5]=e("span",{class:"feature-label"},"大型企业:",-1)),e("span",Ht,i(o.marketContext.competition_intensity.analysis.large_enterprises),1)]),e("div",Kt,[n[6]||(n[6]=e("span",{class:"feature-label"},"价格激进:",-1)),e("span",Gt,i(o.marketContext.competition_intensity.analysis.pricing_aggressive),1)]),e("div",Wt,[n[7]||(n[7]=e("span",{class:"feature-label"},"技术先进:",-1)),e("span",Xt,i(o.marketContext.competition_intensity.analysis.technology_advanced),1)])])]),e("div",Zt,[n[9]||(n[9]=e("h4",null,"竞争策略建议",-1)),e("ul",null,[o.marketContext.competition_intensity.level==="high"?(r(),d("li",Yt," 采用差异化策略，避免正面价格竞争 ")):q("",!0),o.marketContext.competition_intensity.level==="high"?(r(),d("li",xt," 强化产品优势和服务质量 ")):q("",!0),o.marketContext.competition_intensity.level==="medium"?(r(),d("li",es," 平衡价格竞争力与产品价值 ")):q("",!0),o.marketContext.competition_intensity.level==="low"?(r(),d("li",ts," 可以采用溢价策略，建立市场领导地位 ")):q("",!0)])])])]),_:1})]),_:1}),t(w,{span:12},{default:s(()=>[t(h,null,{header:s(()=>[e("div",ss,[n[10]||(n[10]=e("span",null,"市场机会分析",-1)),t(E,{type:I(o.marketContext.market_opportunities.level)},{default:s(()=>[m(i(y(o.marketContext.market_opportunities.level))+"机会 ",1)]),_:1},8,["type"])])]),default:s(()=>[e("div",ns,[e("div",is,[e("div",os,[n[11]||(n[11]=e("h4",null,"机会评分",-1)),e("span",as,i((o.marketContext.market_opportunities.score*100).toFixed(0))+"分",1)]),t($,{percentage:o.marketContext.market_opportunities.score*100,color:c(o.marketContext.market_opportunities.score),"stroke-width":20},null,8,["percentage","color"])]),e("div",ls,[n[14]||(n[14]=e("h4",null,"机会统计",-1)),e("div",rs,[e("div",ds,[e("span",cs,i(o.marketContext.market_opportunities.total_opportunities),1),n[12]||(n[12]=e("span",{class:"stat-label"},"总机会数",-1))]),e("div",us,[e("span",_s,i(o.marketContext.market_opportunities.high_value_opportunities),1),n[13]||(n[13]=e("span",{class:"stat-label"},"高价值机会",-1))])])]),o.marketContext.market_opportunities.opportunities.length>0?(r(),d("div",ps,[n[15]||(n[15]=e("h4",null,"主要机会",-1)),e("div",ms,[(r(!0),d(D,null,O(o.marketContext.market_opportunities.opportunities.slice(0,3),(P,g)=>(r(),d("div",{key:g,class:"opportunity-item"},[e("div",gs,[e("span",vs,"机会 "+i(g+1),1),e("p",ys,i(T(P)),1)])]))),128))])])):q("",!0)])]),_:1})]),_:1})]),_:1})]),e("div",fs,[t(h,null,{header:s(()=>[e("div",hs,[n[16]||(n[16]=e("span",null,"价格敏感度分析",-1)),t(E,{type:_(o.marketContext.price_sensitivity.level)},{default:s(()=>[m(i(N(o.marketContext.price_sensitivity.level))+"敏感 ",1)]),_:1},8,["type"])])]),default:s(()=>[e("div",$s,[t(U,{gutter:24},{default:s(()=>[t(w,{span:8},{default:s(()=>[e("div",ks,[n[17]||(n[17]=e("h4",null,"敏感度评分",-1)),t($,{type:"circle",percentage:o.marketContext.price_sensitivity.score*100,color:c(1-o.marketContext.price_sensitivity.score),width:120},{default:s(({percentage:P})=>[e("span",ws,i(P.toFixed(0))+"%",1)]),_:1},8,["percentage","color"])])]),_:1}),t(w,{span:8},{default:s(()=>[e("div",bs,[n[20]||(n[20]=e("h4",null,"影响因素",-1)),e("div",Cs,[e("div",Ts,[n[18]||(n[18]=e("span",{class:"factor-label"},"预算提及:",-1)),e("span",Rs,i(o.marketContext.price_sensitivity.budget_mentions)+" 次",1)]),e("div",Vs,[n[19]||(n[19]=e("span",{class:"factor-label"},"成本关注:",-1)),e("span",zs,i(o.marketContext.price_sensitivity.cost_concerns)+" 次",1)])])])]),_:1}),t(w,{span:8},{default:s(()=>[e("div",Ps,[n[21]||(n[21]=e("h4",null,"定价建议",-1)),e("ul",null,[o.marketContext.price_sensitivity.level==="high"?(r(),d("li",Es," 采用成本导向定价，控制价格水平 ")):q("",!0),o.marketContext.price_sensitivity.level==="high"?(r(),d("li",qs," 提供多档次产品组合 ")):q("",!0),o.marketContext.price_sensitivity.level==="medium"?(r(),d("li",Is," 平衡价格与价值，强调性价比 ")):q("",!0),o.marketContext.price_sensitivity.level==="low"?(r(),d("li",Ss," 可以采用价值定价策略 ")):q("",!0)])])]),_:1})]),_:1})])]),_:1})]),e("div",Fs,[t(h,null,{header:s(()=>[e("div",Ds,[n[22]||(n[22]=e("span",null,"需求热度分析",-1)),t(E,{type:f(o.marketContext.demand_heat.level)},{default:s(()=>[m(i(l(o.marketContext.demand_heat.level))+"需求 ",1)]),_:1},8,["type"])])]),default:s(()=>[e("div",Os,[t(U,{gutter:24},{default:s(()=>[t(w,{span:12},{default:s(()=>[e("div",js,[n[26]||(n[26]=e("h4",null,"需求概况",-1)),e("div",Us,[e("div",Bs,[e("span",Ns,i(o.marketContext.demand_heat.total_demands),1),n[23]||(n[23]=e("span",{class:"stat-label"},"总需求数",-1))]),e("div",Ms,[e("span",Qs,i(Object.keys(o.marketContext.demand_heat.product_categories).length),1),n[24]||(n[24]=e("span",{class:"stat-label"},"产品类别",-1))])]),e("div",As,[n[25]||(n[25]=e("h5",null,"需求热度评分",-1)),t($,{percentage:o.marketContext.demand_heat.score*100,color:c(o.marketContext.demand_heat.score),"stroke-width":16},null,8,["percentage","color"])])])]),_:1}),t(w,{span:12},{default:s(()=>[e("div",Js,[n[28]||(n[28]=e("h4",null,"热门产品类别",-1)),o.marketContext.demand_heat.trending_products.length>0?(r(),d("div",Ls,[(r(!0),d(D,null,O(o.marketContext.demand_heat.trending_products,([P,g],v)=>(r(),d("div",{key:P,class:"trending-item"},[e("div",Hs,i(v+1),1),e("div",Ks,[e("span",Gs,i(P),1),e("span",Ws,i(g)+" 个需求",1)]),e("div",Xs,[t($,{percentage:g/Math.max(...o.marketContext.demand_heat.trending_products.map(([,Q])=>Q))*100,"show-text":!1,"stroke-width":8},null,8,["percentage"])])]))),128))])):(r(),d("div",Zs,n[27]||(n[27]=[e("p",null,"暂无热门产品类别数据",-1)])))])]),_:1})]),_:1})])]),_:1})])])}}}),xs=G(Ys,[["__scopeId","data-v-d94b379a"]]),en={class:"pricing-strategies"},tn={class:"overall-strategy-section"},sn={class:"card-header"},nn={class:"strategy-content"},on={class:"strategy-description"},an={class:"success-probability"},ln={class:"probability-text"},rn={class:"strategy-details"},dn={class:"card-header"},cn={class:"bundle-section"},un={key:0,class:"empty-state"},_n={key:1,class:"bundle-list"},pn={class:"bundle-header"},mn={class:"bundle-products"},gn={class:"bundle-value"},vn={class:"value-proposition"},yn={class:"card-header"},fn={class:"discount-section"},hn={class:"discount-type"},$n={class:"discount-details"},kn={class:"discount-rule"},wn={class:"rule-value"},bn={class:"discount-rule"},Cn={class:"rule-value"},Tn={class:"discount-type"},Rn={class:"discount-details"},Vn={class:"discount-rule"},zn={class:"rule-value"},Pn={class:"discount-rule"},En={class:"rule-value"},qn={class:"discount-conditions"},In={class:"timing-section"},Sn={class:"card-header"},Fn={class:"timing-content"},Dn={class:"timing-card"},On={class:"timing-icon optimal"},jn={class:"timing-card"},Un={class:"timing-icon window"},Bn={class:"timing-card"},Nn={class:"timing-icon seasonal"},Mn={class:"timing-card"},Qn={class:"timing-icon urgency"},An={key:0,class:"urgency-indicators"},Jn={class:"indicator-list"},Ln={class:"implementation-section"},Hn={class:"card-header"},Kn={class:"implementation-content"},Gn={class:"implementation-steps"},Wn={class:"step-item"},Xn={class:"step-content"},Zn={class:"step-item"},Yn={class:"step-content"},xn={class:"key-success-factors"},ei={class:"success-factors"},ti=W({__name:"PricingStrategies",props:{strategies:{}},setup(R){const T=u(a=>{switch(a){case"value_based_pricing":return"primary";case"aggressive_pricing":return"danger";case"premium_pricing":return"success";case"market_penetration":return"warning";default:return"info"}},"getStrategyType"),V=u(a=>{switch(a){case"value_based_pricing":return"价值定价";case"aggressive_pricing":return"积极定价";case"premium_pricing":return"溢价定价";case"market_penetration":return"市场渗透";default:return"标准定价"}},"getStrategyName"),j=u(a=>a>=.8?"#67c23a":a>=.6?"#e6a23c":"#f56c6c","getSuccessColor"),z=u(a=>{switch(a){case"excellent":return"success";case"good":return"primary";case"challenging":return"warning";default:return"info"}},"getTimingType"),C=u(a=>{switch(a){case"excellent":return"绝佳";case"good":return"良好";case"challenging":return"挑战";default:return"一般"}},"getTimingText"),k=u(a=>{switch(a){case"value_based_pricing":return["产品价值展示","客户需求匹配","服务质量","ROI论证"];case"aggressive_pricing":return["成本控制","运营效率","规模优势","快速响应"];case"premium_pricing":return["品牌建设","产品差异化","技术创新","客户体验"];case"market_penetration":return["市场份额","客户获取","渠道建设","竞争分析"];default:return["产品质量","客户服务","价格竞争力","市场定位"]}},"getKeySuccessFactors");return(a,l)=>{const f=Y,y=ce,I=X,N=ne,_=le,c=ae,o=oe;return r(),d("div",en,[e("div",tn,[t(I,null,{header:s(()=>[e("div",sn,[l[0]||(l[0]=e("span",null,"推荐定价策略",-1)),t(f,{type:T(a.strategies.overall_strategy.strategy),size:"large"},{default:s(()=>[m(i(V(a.strategies.overall_strategy.strategy)),1)]),_:1},8,["type"])])]),default:s(()=>[e("div",nn,[e("div",on,[e("p",null,i(a.strategies.overall_strategy.description),1)]),e("div",an,[l[1]||(l[1]=e("h4",null,"成功概率评估",-1)),t(y,{percentage:a.strategies.overall_strategy.success_probability*100,color:j(a.strategies.overall_strategy.success_probability),"stroke-width":20},{default:s(({percentage:n})=>[e("span",ln,i(n.toFixed(1))+"%",1)]),_:1},8,["percentage","color"])])])]),_:1})]),e("div",rn,[t(o,{gutter:24},{default:s(()=>[t(c,{span:12},{default:s(()=>[t(I,null,{header:s(()=>[e("div",dn,[l[2]||(l[2]=e("span",null,"打包销售机会",-1)),t(f,{type:a.strategies.bundle_opportunities.length>0?"success":"info",size:"small"},{default:s(()=>[m(i(a.strategies.bundle_opportunities.length)+" 个机会 ",1)]),_:1},8,["type"])])]),default:s(()=>[e("div",cn,[a.strategies.bundle_opportunities.length===0?(r(),d("div",un,[t(N,{description:"暂无打包销售机会","image-size":80})])):(r(),d("div",_n,[(r(!0),d(D,null,O(a.strategies.bundle_opportunities,(n,p)=>(r(),d("div",{key:p,class:"bundle-item"},[e("div",pn,[e("h4",null,i(n.category)+" 解决方案",1),t(f,{type:"success",size:"small"},{default:s(()=>[m(i(n.estimated_discount)+" 折扣 ",1)]),_:2},1024)]),e("div",mn,[l[3]||(l[3]=e("h5",null,"包含产品:",-1)),e("ul",null,[(r(!0),d(D,null,O(n.products,h=>(r(),d("li",{key:h},i(h),1))),128))])]),e("div",gn,[e("p",vn,[t(_,null,{default:s(()=>[t(F(_e))]),_:1}),m(" "+i(n.value_proposition),1)])])]))),128))]))])]),_:1})]),_:1}),t(c,{span:12},{default:s(()=>[t(I,null,{header:s(()=>[e("div",yn,[l[5]||(l[5]=e("span",null,"折扣策略建议",-1)),t(f,{type:"warning",size:"small"},{default:s(()=>l[4]||(l[4]=[m("灵活定价",-1)])),_:1,__:[4]})])]),default:s(()=>[e("div",fn,[e("div",hn,[e("h4",null,[t(_,null,{default:s(()=>[t(F(re))]),_:1}),l[6]||(l[6]=m(" 批量折扣 ",-1))]),e("div",$n,[e("div",kn,[l[7]||(l[7]=e("span",{class:"rule-label"},"数量阈值:",-1)),e("span",wn,i(a.strategies.discount_recommendations.volume_discount.threshold)+" 件",1)]),e("div",bn,[l[8]||(l[8]=e("span",{class:"rule-label"},"折扣范围:",-1)),e("span",Cn,i(a.strategies.discount_recommendations.volume_discount.discount_range),1)])])]),e("div",Tn,[e("h4",null,[t(_,null,{default:s(()=>[t(F(pe))]),_:1}),l[9]||(l[9]=m(" 早鸟折扣 ",-1))]),e("div",Rn,[e("div",Vn,[l[10]||(l[10]=e("span",{class:"rule-label"},"有效期:",-1)),e("span",zn,i(a.strategies.discount_recommendations.early_bird_discount.duration),1)]),e("div",Pn,[l[11]||(l[11]=e("span",{class:"rule-label"},"折扣幅度:",-1)),e("span",En,i(a.strategies.discount_recommendations.early_bird_discount.discount),1)])])]),e("div",qn,[l[12]||(l[12]=e("h4",null,"重要条件",-1)),e("ul",null,[(r(!0),d(D,null,O(a.strategies.discount_recommendations.conditions,n=>(r(),d("li",{key:n},i(n),1))),128))])])])]),_:1})]),_:1})]),_:1})]),e("div",In,[t(I,null,{header:s(()=>[e("div",Sn,[l[13]||(l[13]=e("span",null,"时机策略分析",-1)),t(f,{type:z(a.strategies.timing_considerations.market_window),size:"small"},{default:s(()=>[m(i(C(a.strategies.timing_considerations.market_window))+"窗口期 ",1)]),_:1},8,["type"])])]),default:s(()=>[e("div",Fn,[t(o,{gutter:24},{default:s(()=>[t(c,{span:6},{default:s(()=>[e("div",Dn,[e("div",On,[t(_,null,{default:s(()=>[t(F(Ve))]),_:1})]),l[14]||(l[14]=e("h4",null,"最佳时机",-1)),e("p",null,i(a.strategies.timing_considerations.optimal_timing),1)])]),_:1}),t(c,{span:6},{default:s(()=>[e("div",jn,[e("div",Un,[t(_,null,{default:s(()=>[t(F(me))]),_:1})]),l[15]||(l[15]=e("h4",null,"市场窗口",-1)),e("p",null,i(C(a.strategies.timing_considerations.market_window))+"机会期",1)])]),_:1}),t(c,{span:6},{default:s(()=>[e("div",Bn,[e("div",Nn,[t(_,null,{default:s(()=>[t(F(ze))]),_:1})]),l[16]||(l[16]=e("h4",null,"季节因素",-1)),e("p",null,i(a.strategies.timing_considerations.seasonal_factors),1)])]),_:1}),t(c,{span:6},{default:s(()=>[e("div",Mn,[e("div",Qn,[t(_,null,{default:s(()=>[t(F(ge))]),_:1})]),l[17]||(l[17]=e("h4",null,"紧急信号",-1)),e("p",null,i(a.strategies.timing_considerations.urgency_indicators.length||0)+" 个信号",1)])]),_:1})]),_:1}),a.strategies.timing_considerations.urgency_indicators.length>0?(r(),d("div",An,[l[18]||(l[18]=e("h4",null,"紧急性指标",-1)),e("div",Jn,[(r(!0),d(D,null,O(a.strategies.timing_considerations.urgency_indicators,n=>(r(),K(f,{key:n,type:"warning",class:"indicator-tag"},{default:s(()=>[m(i(n),1)]),_:2},1024))),128))])])):q("",!0)])]),_:1})]),e("div",Ln,[t(I,null,{header:s(()=>[e("div",Hn,[l[20]||(l[20]=e("span",null,"实施建议",-1)),t(f,{type:"primary",size:"small"},{default:s(()=>l[19]||(l[19]=[m("行动指南",-1)])),_:1,__:[19]})])]),default:s(()=>[e("div",Kn,[e("div",Gn,[e("div",Wn,[l[24]||(l[24]=e("div",{class:"step-number"},"1",-1)),e("div",Xn,[l[23]||(l[23]=e("h4",null,"策略选择",-1)),e("p",null,[l[21]||(l[21]=m("基于市场分析结果，采用 ",-1)),e("strong",null,i(V(a.strategies.overall_strategy.strategy)),1),l[22]||(l[22]=m(" 策略",-1))])])]),l[27]||(l[27]=e("div",{class:"step-item"},[e("div",{class:"step-number"},"2"),e("div",{class:"step-content"},[e("h4",null,"价格设定"),e("p",null,"根据产品推荐中的建议价格进行定价，考虑市场竞争和客户价格敏感度")])],-1)),l[28]||(l[28]=e("div",{class:"step-item"},[e("div",{class:"step-number"},"3"),e("div",{class:"step-content"},[e("h4",null,"折扣应用"),e("p",null,"合理运用批量折扣和早鸟折扣，避免过度价格竞争")])],-1)),e("div",Zn,[l[26]||(l[26]=e("div",{class:"step-number"},"4",-1)),e("div",Yn,[l[25]||(l[25]=e("h4",null,"时机把握",-1)),e("p",null,"在"+i(C(a.strategies.timing_considerations.market_window))+"市场窗口期内实施策略",1)])])]),e("div",xn,[l[29]||(l[29]=e("h4",null,"成功关键因素",-1)),e("div",ei,[(r(!0),d(D,null,O(k(a.strategies.overall_strategy.strategy),n=>(r(),K(f,{key:n,type:"success",class:"factor-tag"},{default:s(()=>[m(i(n),1)]),_:2},1024))),128))])])])]),_:1})])])}}}),si=G(ti,[["__scopeId","data-v-f01bd70f"]]),ni={class:"risk-opportunity-analysis"},ii={class:"overview-section"},oi={class:"overview-content"},ai={class:"overview-icon"},li={class:"overview-info"},ri={class:"overview-count"},di={class:"overview-content"},ci={class:"overview-icon"},ui={class:"overview-info"},_i={class:"overview-count"},pi={class:"detailed-analysis"},mi={class:"card-header"},gi={class:"opportunities-section"},vi={key:0,class:"empty-state"},yi={key:1,class:"opportunities-list"},fi={class:"opportunity-header"},hi={class:"opportunity-icon"},$i={class:"opportunity-title"},ki={class:"opportunity-content"},wi={class:"opportunity-actions"},bi={class:"card-header"},Ci={class:"risks-section"},Ti={key:0,class:"empty-state"},Ri={key:1,class:"risks-list"},Vi={class:"risk-header"},zi={class:"risk-icon"},Pi={class:"risk-title"},Ei={class:"risk-tags"},qi={class:"risk-content"},Ii={class:"risk-actions"},Si={class:"mitigation-section"},Fi={class:"card-header"},Di={class:"mitigation-content"},Oi={key:0,class:"empty-state"},ji={key:1,class:"strategies-grid"},Ui={class:"strategy-number"},Bi={class:"strategy-content"},Ni={class:"strategy-priority"},Mi={class:"action-recommendations"},Qi={class:"card-header"},Ai={class:"recommendations-content"},Ji={class:"recommendation-categories"},Li={class:"category-section"},Hi={class:"action-list"},Ki={key:0},Gi={key:1},Wi={class:"category-section"},Xi={class:"category-section"},Zi={class:"success-factors"},Yi={class:"factors-tags"},xi=W({__name:"RiskOpportunityAnalysis",props:{analysis:{}},setup(R){const T=u(_=>B(this,null,function*(){try{(yield de.prompt('为 "'.concat(_.type,'" 机会制定行动计划:'),"行动计划",{confirmButtonText:"确定",cancelButtonText:"取消",inputPlaceholder:"请输入具体的行动计划..."})).value&&M.success("行动计划已记录")}catch(c){}}),"handleOpportunity"),V=u(_=>B(this,null,function*(){try{(yield de.prompt('为 "'.concat(_.type,'" 风险制定应对措施:'),"应对措施",{confirmButtonText:"确定",cancelButtonText:"取消",inputPlaceholder:"请输入具体的应对措施..."})).value&&M.success("应对措施已记录")}catch(c){}}),"handleRisk"),j=u(_=>_>2?"机会丰富":_>0?"有机会":"机会较少","getOpportunityLevel"),z=u(_=>_>2?"高风险":_>0?"中等风险":"低风险","getRiskLevel"),C=u(_=>{switch(_){case"high":return"danger";case"medium":return"warning";case"low":return"info";default:return"info"}},"getImpactType"),k=u(_=>{switch(_){case"high":return"高";case"medium":return"中等";case"low":return"低";default:return"未知"}},"getImpactText"),a=u(_=>{switch(_){case"high":return"danger";case"medium":return"warning";case"low":return"success";default:return"info"}},"getProbabilityType"),l=u(_=>{switch(_){case"high":return"高";case"medium":return"中等";case"low":return"低";default:return"未知"}},"getProbabilityText"),f=u((_,c)=>_==="high"&&c==="high"?"risk-critical":_==="high"||c==="high"?"risk-high":_==="medium"||c==="medium"?"risk-medium":"risk-low","getRiskSeverityClass"),y=u(_=>_===0?"danger":_===1?"warning":"info","getStrategyPriority"),I=u(_=>_===0?"高优先级":_===1?"中优先级":"低优先级","getStrategyPriorityText"),N=u(()=>["市场洞察","快速响应","风险控制","创新能力","客户关系","团队执行力"],"getKeySuccessFactors");return(_,c)=>{const o=le,n=X,p=ae,h=oe,w=Y,U=ne,E=ie;return r(),d("div",ni,[e("div",ii,[t(h,{gutter:24},{default:s(()=>[t(p,{span:12},{default:s(()=>[t(n,{class:"overview-card opportunities"},{default:s(()=>[e("div",oi,[e("div",ai,[t(o,null,{default:s(()=>[t(F(ue))]),_:1})]),e("div",li,[c[0]||(c[0]=e("h3",null,"市场机会",-1)),e("p",ri,i(_.analysis.opportunities.length)+" 个",1),c[1]||(c[1]=e("p",{class:"overview-desc"},"发现的潜在机会",-1))])])]),_:1})]),_:1}),t(p,{span:12},{default:s(()=>[t(n,{class:"overview-card risks"},{default:s(()=>[e("div",di,[e("div",ci,[t(o,null,{default:s(()=>[t(F(ge))]),_:1})]),e("div",ui,[c[2]||(c[2]=e("h3",null,"潜在风险",-1)),e("p",_i,i(_.analysis.risks.length)+" 个",1),c[3]||(c[3]=e("p",{class:"overview-desc"},"需要关注的风险点",-1))])])]),_:1})]),_:1})]),_:1})]),e("div",pi,[t(h,{gutter:24},{default:s(()=>[t(p,{span:12},{default:s(()=>[t(n,null,{header:s(()=>[e("div",mi,[c[4]||(c[4]=e("span",null,"机会分析",-1)),t(w,{type:_.analysis.opportunities.length>2?"success":_.analysis.opportunities.length>0?"warning":"info",size:"small"},{default:s(()=>[m(i(j(_.analysis.opportunities.length)),1)]),_:1},8,["type"])])]),default:s(()=>[e("div",gi,[_.analysis.opportunities.length===0?(r(),d("div",vi,[t(U,{description:"暂无明显机会","image-size":80},{default:s(()=>c[5]||(c[5]=[e("p",{class:"empty-tip"},"建议加强市场调研，寻找潜在机会",-1)])),_:1,__:[5]})])):(r(),d("div",yi,[(r(!0),d(D,null,O(_.analysis.opportunities,($,P)=>(r(),d("div",{key:P,class:"opportunity-item"},[e("div",fi,[e("div",hi,[t(o,null,{default:s(()=>[t(F(_e))]),_:1})]),e("div",$i,[e("h4",null,i($.type),1),t(w,{type:C($.impact),size:"small"},{default:s(()=>[m(i(k($.impact))+"影响 ",1)]),_:2},1032,["type"])])]),e("div",ki,[e("p",null,i($.description),1)]),e("div",wi,[t(E,{type:"primary",size:"small",onClick:u(g=>T($),"onClick")},{default:s(()=>c[6]||(c[6]=[m(" 制定行动计划 ",-1)])),_:2,__:[6]},1032,["onClick"])])]))),128))]))])]),_:1})]),_:1}),t(p,{span:12},{default:s(()=>[t(n,null,{header:s(()=>[e("div",bi,[c[7]||(c[7]=e("span",null,"风险分析",-1)),t(w,{type:_.analysis.risks.length>2?"danger":_.analysis.risks.length>0?"warning":"success",size:"small"},{default:s(()=>[m(i(z(_.analysis.risks.length)),1)]),_:1},8,["type"])])]),default:s(()=>[e("div",Ci,[_.analysis.risks.length===0?(r(),d("div",Ti,[t(U,{description:"风险较低","image-size":80},{default:s(()=>c[8]||(c[8]=[e("p",{class:"empty-tip"},"当前市场环境相对安全",-1)])),_:1,__:[8]})])):(r(),d("div",Ri,[(r(!0),d(D,null,O(_.analysis.risks,($,P)=>(r(),d("div",{key:P,class:H(["risk-item",f($.probability,$.impact)])},[e("div",Vi,[e("div",zi,[t(o,null,{default:s(()=>[t(F(Pe))]),_:1})]),e("div",Pi,[e("h4",null,i($.type),1),e("div",Ei,[t(w,{type:a($.probability),size:"small"},{default:s(()=>[m(i(l($.probability))+"概率 ",1)]),_:2},1032,["type"]),t(w,{type:C($.impact),size:"small"},{default:s(()=>[m(i(k($.impact))+"影响 ",1)]),_:2},1032,["type"])])])]),e("div",qi,[e("p",null,i($.description),1)]),e("div",Ii,[t(E,{type:"danger",size:"small",onClick:u(g=>V($),"onClick")},{default:s(()=>c[9]||(c[9]=[m(" 制定应对措施 ",-1)])),_:2,__:[9]},1032,["onClick"])])],2))),128))]))])]),_:1})]),_:1})]),_:1})]),e("div",Si,[t(n,null,{header:s(()=>[e("div",Fi,[c[10]||(c[10]=e("span",null,"风险缓解策略",-1)),t(w,{type:"primary",size:"small"},{default:s(()=>[m(i(_.analysis.mitigation_strategies.length)+" 项策略 ",1)]),_:1})])]),default:s(()=>[e("div",Di,[_.analysis.mitigation_strategies.length===0?(r(),d("div",Oi,[t(U,{description:"暂无特定缓解策略","image-size":80})])):(r(),d("div",ji,[(r(!0),d(D,null,O(_.analysis.mitigation_strategies,($,P)=>(r(),d("div",{key:P,class:"strategy-card"},[e("div",Ui,i(P+1),1),e("div",Bi,[e("p",null,i($),1)]),e("div",Ni,[t(w,{type:y(P),size:"small"},{default:s(()=>[m(i(I(P)),1)]),_:2},1032,["type"])])]))),128))]))])]),_:1})]),e("div",Mi,[t(n,null,{header:s(()=>[e("div",Qi,[c[12]||(c[12]=e("span",null,"行动建议",-1)),t(w,{type:"success",size:"small"},{default:s(()=>c[11]||(c[11]=[m("立即执行",-1)])),_:1,__:[11]})])]),default:s(()=>{var $,P;return[e("div",Ai,[e("div",Ji,[e("div",Li,[e("h4",null,[t(o,null,{default:s(()=>[t(F(pe))]),_:1}),c[13]||(c[13]=m(" 短期行动 (1-3个月) ",-1))]),e("ul",Hi,[_.analysis.opportunities.length>0?(r(),d("li",Ki," 抓住 "+i((($=_.analysis.opportunities[0])==null?void 0:$.type)||"主要")+" 机会，快速行动 ",1)):q("",!0),_.analysis.risks.length>0?(r(),d("li",Gi," 优先应对 "+i(((P=_.analysis.risks[0])==null?void 0:P.type)||"主要")+" 风险 ",1)):q("",!0),c[14]||(c[14]=e("li",null,"建立市场监控机制，跟踪竞争动态",-1))])]),e("div",Wi,[e("h4",null,[t(o,null,{default:s(()=>[t(F(me))]),_:1}),c[15]||(c[15]=m(" 中期规划 (3-12个月) ",-1))]),c[16]||(c[16]=e("ul",{class:"action-list"},[e("li",null,"建立完善的风险管理体系"),e("li",null,"开发差异化产品和服务"),e("li",null,"加强客户关系管理，提升客户忠诚度")],-1))]),e("div",Xi,[e("h4",null,[t(o,null,{default:s(()=>[t(F(re))]),_:1}),c[17]||(c[17]=m(" 长期战略 (1年以上) ",-1))]),c[18]||(c[18]=e("ul",{class:"action-list"},[e("li",null,"建立行业领导地位"),e("li",null,"构建可持续竞争优势"),e("li",null,"探索新兴市场和技术机会")],-1))])]),e("div",Zi,[c[19]||(c[19]=e("h4",null,"关键成功因素",-1)),e("div",Yi,[(r(!0),d(D,null,O(N(),g=>(r(),K(w,{key:g,type:"success",class:"factor-tag"},{default:s(()=>[m(i(g),1)]),_:2},1024))),128))])])])]}),_:1})])])}}}),eo=G(xi,[["__scopeId","data-v-53f34471"]]),to={key:0,class:"create-quote-form"},so={class:"product-section"},no={class:"product-details"},io={class:"product-basic"},oo={class:"product-code"},ao={class:"product-category"},lo={class:"product-pricing"},ro={class:"price-item"},co={class:"price-value"},uo={class:"price-item"},_o={class:"price-value recommended"},po={class:"price-item"},mo={class:"quote-form-section"},go={class:"price-tip"},vo={class:"config-recommendations"},yo={class:"config-list"},fo={class:"total-price-display"},ho={class:"price-calculation"},$o={class:"calc-line"},ko={key:0,class:"calc-line discount"},wo={class:"calc-line total"},bo={class:"dialog-footer"},Co=W({__name:"CreateQuoteDialog",props:{visible:{type:Boolean},productRecommendation:{}},emits:["update:visible","quote-created"],setup(R,{emit:T}){const V=R,j=T,z=A(),C=A(!1),k=te({get:u(()=>V.visible,"get"),set:u(n=>j("update:visible",n),"set")}),a=we({product_id:0,customer_name:"",customer_email:"",customer_company:"",recommended_price:0,quantity:1,discount_percentage:0,notes:"",terms_conditions:""}),l={customer_name:[{required:!0,message:"请输入客户姓名",trigger:"blur"}],customer_email:[{required:!0,message:"请输入客户邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱格式",trigger:"blur"}],quantity:[{required:!0,message:"请输入数量",trigger:"blur"},{type:"number",min:1,message:"数量必须大于0",trigger:"blur"}],unit_price:[{required:!0,message:"请输入单价",trigger:"blur"},{type:"number",min:0,message:"单价不能为负数",trigger:"blur"}]},f=te(()=>a.quantity*a.unit_price),y=te(()=>f.value*(a.discount_percentage/100)),I=te(()=>f.value-y.value);be(()=>V.productRecommendation,n=>{n&&(a.product_id=n.product.id,a.recommended_price=n.recommended_price.recommended_price,a.unit_price=n.recommended_price.recommended_price,a.customer_name="",a.customer_email="",a.customer_company="",a.quantity=1,a.discount_percentage=0,a.notes="",a.terms_conditions="")},{immediate:!0});const N=u(()=>{},"updateTotalPrice"),_=u(()=>B(this,null,function*(){if(z.value)try{if(!(yield z.value.validate()))return;C.value=!0;const p=yield se.createQuoteFromRecommendation(a);p.success?(M.success("报价创建成功"),j("quote-created",p.data.quote),c()):M.error(p.error||"创建报价失败")}catch(n){M.error("创建报价失败")}finally{C.value=!1}}),"handleSubmit"),c=u(()=>{k.value=!1,z.value&&z.value.clearValidate()},"handleClose"),o=u(n=>new Intl.NumberFormat("zh-CN",{minimumFractionDigits:2,maximumFractionDigits:2}).format(n),"formatPrice");return(n,p)=>{const h=X,w=qe,U=Se,E=Ie,$=Fe,P=De,g=Oe,v=ie,Q=Ee;return r(),K(Q,{modelValue:k.value,"onUpdate:modelValue":p[8]||(p[8]=b=>k.value=b),title:"基于推荐创建报价",width:"800px","close-on-click-modal":!1,onClose:c},{footer:s(()=>[e("div",bo,[t(v,{onClick:c},{default:s(()=>p[17]||(p[17]=[m("取消",-1)])),_:1,__:[17]}),t(v,{type:"primary",onClick:_,loading:C.value},{default:s(()=>p[18]||(p[18]=[m(" 创建报价 ",-1)])),_:1,__:[18]},8,["loading"])])]),default:s(()=>[n.productRecommendation?(r(),d("div",to,[e("div",so,[t(h,{class:"product-info-card"},{header:s(()=>p[9]||(p[9]=[e("span",null,"推荐产品信息",-1)])),default:s(()=>[e("div",no,[e("div",io,[e("h3",null,i(n.productRecommendation.product.name),1),e("p",oo,"型号: "+i(n.productRecommendation.product.code),1),e("p",ao,"类别: "+i(n.productRecommendation.product.category),1)]),e("div",lo,[e("div",ro,[p[10]||(p[10]=e("span",{class:"price-label"},"基础价格:",-1)),e("span",co,"¥"+i(o(n.productRecommendation.recommended_price.base_price)),1)]),e("div",uo,[p[11]||(p[11]=e("span",{class:"price-label"},"推荐价格:",-1)),e("span",_o,"¥"+i(o(n.productRecommendation.recommended_price.recommended_price)),1)]),e("div",po,[p[12]||(p[12]=e("span",{class:"price-label"},"调整幅度:",-1)),e("span",{class:H(["price-change",n.productRecommendation.recommended_price.price_change_percentage>=0?"positive":"negative"])},i(n.productRecommendation.recommended_price.price_change_percentage>0?"+":"")+i(n.productRecommendation.recommended_price.price_change_percentage)+"% ",3)])])])]),_:1})]),e("div",mo,[t(g,{ref_key:"quoteFormRef",ref:z,model:a,rules:l,"label-width":"120px"},{default:s(()=>[t(w,{"content-position":"left"},{default:s(()=>p[13]||(p[13]=[m("客户信息",-1)])),_:1,__:[13]}),t(E,{label:"客户姓名",prop:"customer_name"},{default:s(()=>[t(U,{modelValue:a.customer_name,"onUpdate:modelValue":p[0]||(p[0]=b=>a.customer_name=b),placeholder:"请输入客户姓名"},null,8,["modelValue"])]),_:1}),t(E,{label:"客户邮箱",prop:"customer_email"},{default:s(()=>[t(U,{modelValue:a.customer_email,"onUpdate:modelValue":p[1]||(p[1]=b=>a.customer_email=b),placeholder:"请输入客户邮箱"},null,8,["modelValue"])]),_:1}),t(E,{label:"客户公司",prop:"customer_company"},{default:s(()=>[t(U,{modelValue:a.customer_company,"onUpdate:modelValue":p[2]||(p[2]=b=>a.customer_company=b),placeholder:"请输入客户公司（可选）"},null,8,["modelValue"])]),_:1}),t(w,{"content-position":"left"},{default:s(()=>p[14]||(p[14]=[m("产品配置",-1)])),_:1,__:[14]}),t(E,{label:"数量",prop:"quantity"},{default:s(()=>[t($,{modelValue:a.quantity,"onUpdate:modelValue":p[3]||(p[3]=b=>a.quantity=b),min:1,max:9999,onChange:N},null,8,["modelValue"])]),_:1}),t(E,{label:"单价",prop:"unit_price"},{default:s(()=>[t($,{modelValue:a.unit_price,"onUpdate:modelValue":p[4]||(p[4]=b=>a.unit_price=b),precision:2,min:0,onChange:N},null,8,["modelValue"]),e("span",go,"建议价格: ¥"+i(o(n.productRecommendation.recommended_price.recommended_price)),1)]),_:1}),t(E,{label:"折扣",prop:"discount_percentage"},{default:s(()=>[t($,{modelValue:a.discount_percentage,"onUpdate:modelValue":p[5]||(p[5]=b=>a.discount_percentage=b),precision:2,min:0,max:50,onChange:N},null,8,["modelValue"]),p[15]||(p[15]=e("span",{class:"discount-tip"},"%",-1))]),_:1,__:[15]}),Object.keys(n.productRecommendation.config_recommendations).length>0?(r(),K(E,{key:0,label:"配置建议"},{default:s(()=>[e("div",vo,[t(P,{title:"AI推荐配置",type:"info",closable:!1,"show-icon":""},{default:s(()=>[e("ul",yo,[(r(!0),d(D,null,O(n.productRecommendation.config_recommendations,(b,J)=>(r(),d("li",{key:J},[e("strong",null,i(J)+":",1),m(" "+i(b),1)]))),128))])]),_:1})])]),_:1})):q("",!0),t(E,{label:"总价"},{default:s(()=>[e("div",fo,[e("div",ho,[e("div",$o,[e("span",null,"小计: ¥"+i(o(f.value)),1)]),a.discount_percentage>0?(r(),d("div",ko,[e("span",null,"折扣 ("+i(a.discount_percentage)+"%): -¥"+i(o(y.value)),1)])):q("",!0),e("div",wo,[e("span",null,"总计: ¥"+i(o(I.value)),1)])])])]),_:1}),t(w,{"content-position":"left"},{default:s(()=>p[16]||(p[16]=[m("备注信息",-1)])),_:1,__:[16]}),t(E,{label:"报价备注"},{default:s(()=>[t(U,{modelValue:a.notes,"onUpdate:modelValue":p[6]||(p[6]=b=>a.notes=b),type:"textarea",rows:3,placeholder:"请输入报价相关备注信息"},null,8,["modelValue"])]),_:1}),t(E,{label:"条款条件"},{default:s(()=>[t(U,{modelValue:a.terms_conditions,"onUpdate:modelValue":p[7]||(p[7]=b=>a.terms_conditions=b),type:"textarea",rows:3,placeholder:"请输入条款和条件"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])])])):q("",!0)]),_:1},8,["modelValue"])}}}),To=G(Co,[["__scopeId","data-v-84b4afdc"]]),Ro={class:"pricing-decision-page"},Vo={class:"page-header"},zo={class:"job-selection-section"},Po={class:"card-header"},Eo={key:0,class:"text-center"},qo={key:1,class:"empty-state"},Io={key:2,class:"jobs-grid"},So={class:"job-card-content"},Fo={class:"job-header"},Do={class:"job-stats"},Oo={class:"stat-item"},jo={class:"value"},Uo={class:"stat-item"},Bo={class:"value"},No={class:"stat-item"},Mo={class:"value"},Qo={class:"job-actions"},Ao={key:0,class:"recommendations-section"},Jo={class:"card-header"},Lo={class:"summary-content"},Ho={class:"summary-text"},Ko={class:"key-metrics"},Go={class:"metric"},Wo={class:"metric"},Xo={class:"metric"},Zo={class:"metric-value"},Yo={class:"action-buttons"},xo=W({__name:"PricingDecision",setup(R){const T=A(!1),V=A(!1),j=A(!1),z=A([]),C=A(""),k=A(null),a=A("products"),l=A(!1),f=A(null);Ce(()=>{y()});const y=u(()=>B(this,null,function*(){T.value=!0;try{const g=yield se.getCompletedJobs();z.value=g.jobs}catch(g){M.error("加载任务列表失败")}finally{T.value=!1}}),"loadCompletedJobs"),I=u(()=>{y()},"refreshJobs"),N=u(g=>{C.value=g.job_id,g.has_pricing_recommendations&&_(g.job_id)},"selectJob"),_=u(g=>B(this,null,function*(){V.value=!0,C.value=g;try{const v=yield se.generateRecommendations(g);k.value=v;const Q=z.value.find(b=>b.job_id===g);Q&&(Q.has_pricing_recommendations=!0),M.success("报价建议生成成功")}catch(v){M.error("生成报价建议失败")}finally{V.value=!1}}),"generateRecommendations"),c=u(g=>{f.value=g,l.value=!0},"handleCreateQuote"),o=u(g=>{M.success("报价创建成功"),l.value=!1},"handleQuoteCreated"),n=u(()=>B(this,null,function*(){if(C.value){j.value=!0;try{const g=yield se.exportRecommendations(C.value),v=new Blob([JSON.stringify(g,null,2)],{type:"application/json"}),Q=window.URL.createObjectURL(v),b=document.createElement("a");b.href=Q,b.download="pricing-recommendations-".concat(C.value,".json"),b.click(),window.URL.revokeObjectURL(Q),M.success("报告导出成功")}catch(g){M.error("导出报告失败")}finally{j.value=!1}}}),"exportReport"),p=u(()=>{de.alert("分享功能正在开发中","提示",{confirmButtonText:"确定"})},"shareRecommendations"),h=u(g=>g?new Date(g).toLocaleString("zh-CN"):"-","formatDate"),w=u(g=>g>=.8?"success":g>=.6?"warning":"danger","getConfidenceType"),U=u(g=>{switch(g){case"growing":return"success";case"stable":return"info";case"declining":return"warning";default:return"info"}},"getTrendType"),E=u(g=>{switch(g){case"growing":return"增长";case"stable":return"稳定";case"declining":return"下降";default:return"未知"}},"getTrendText"),$=u(g=>{switch(g){case"low":return"success";case"medium":return"warning";case"high":return"danger";default:return"info"}},"getIntensityType"),P=u(g=>{switch(g){case"low":return"低";case"medium":return"中等";case"high":return"高";default:return"未知"}},"getIntensityText");return(g,v)=>{const Q=le,b=ae,J=ie,ve=oe,Z=Y,ye=je,fe=ne,x=X,ee=Be,he=Ue;return r(),d("div",Ro,[e("div",Vo,[t(ve,{gutter:20,align:"middle"},{default:s(()=>[t(b,{span:16},{default:s(()=>[e("h1",null,[t(Q,null,{default:s(()=>[t(F(re))]),_:1}),v[3]||(v[3]=m(" 智能报价决策支持 ",-1))]),v[4]||(v[4]=e("p",{class:"page-description"}," 基于批量分析结果，为您提供数据驱动的报价建议和市场洞察 ",-1))]),_:1,__:[4]}),t(b,{span:8,class:"text-right"},{default:s(()=>[t(J,{type:"primary",onClick:I,loading:T.value,icon:"Refresh"},{default:s(()=>v[5]||(v[5]=[m(" 刷新任务列表 ",-1)])),_:1,__:[5]},8,["loading"])]),_:1})]),_:1})]),e("div",zo,[t(x,null,{header:s(()=>[e("div",Po,[v[6]||(v[6]=e("span",null,"选择批量分析任务",-1)),t(Z,{type:"info"},{default:s(()=>[m(i(z.value.length)+" 个已完成任务",1)]),_:1})])]),default:s(()=>[T.value?(r(),d("div",Eo,[t(ye,{rows:3,animated:""})])):z.value.length===0?(r(),d("div",qo,[t(fe,{description:"暂无已完成的批量分析任务"},{default:s(()=>[t(J,{type:"primary",onClick:v[0]||(v[0]=S=>g.$router.push("/batch-analysis"))},{default:s(()=>v[7]||(v[7]=[m(" 去创建批量分析任务 ",-1)])),_:1,__:[7]})]),_:1})])):(r(),d("div",Io,[(r(!0),d(D,null,O(z.value,S=>(r(),K(x,{key:S.job_id,class:H(["job-card",{selected:C.value===S.job_id}]),onClick:u($e=>N(S),"onClick"),shadow:"hover"},{default:s(()=>[e("div",So,[e("div",Fo,[e("h3",null,i(S.job_name||"任务 ".concat(S.job_id)),1),t(Z,{type:S.has_pricing_recommendations?"success":"info",size:"small"},{default:s(()=>[m(i(S.has_pricing_recommendations?"已生成建议":"待生成"),1)]),_:2},1032,["type"])]),e("div",Do,[e("div",Oo,[v[8]||(v[8]=e("span",{class:"label"},"文件数量:",-1)),e("span",jo,i(S.total_files),1)]),e("div",Uo,[v[9]||(v[9]=e("span",{class:"label"},"成功率:",-1)),e("span",Bo,i(S.progress_percentage)+"%",1)]),e("div",No,[v[10]||(v[10]=e("span",{class:"label"},"完成时间:",-1)),e("span",Mo,i(h(S.end_time)),1)])]),e("div",Qo,[t(J,{type:"primary",size:"small",onClick:Te($e=>_(S.job_id),["stop"]),loading:V.value&&C.value===S.job_id},{default:s(()=>[m(i(S.has_pricing_recommendations?"查看建议":"生成建议"),1)]),_:2},1032,["onClick","loading"])])])]),_:2},1032,["class","onClick"]))),128))]))]),_:1})]),k.value?(r(),d("div",Ao,[t(x,{class:"summary-card"},{header:s(()=>[e("div",Jo,[v[11]||(v[11]=e("span",null,"执行摘要",-1)),t(Z,{type:w(k.value.confidence_score)},{default:s(()=>[m(" 置信度: "+i((k.value.confidence_score*100).toFixed(1))+"% ",1)]),_:1},8,["type"])])]),default:s(()=>[e("div",Lo,[e("p",Ho,i(k.value.summary),1),e("div",Ko,[e("div",Go,[v[12]||(v[12]=e("span",{class:"metric-label"},"市场趋势:",-1)),t(Z,{type:U(k.value.market_context.market_trend)},{default:s(()=>[m(i(E(k.value.market_context.market_trend)),1)]),_:1},8,["type"])]),e("div",Wo,[v[13]||(v[13]=e("span",{class:"metric-label"},"竞争强度:",-1)),t(Z,{type:$(k.value.market_context.competition_intensity.level)},{default:s(()=>[m(i(P(k.value.market_context.competition_intensity.level)),1)]),_:1},8,["type"])]),e("div",Xo,[v[14]||(v[14]=e("span",{class:"metric-label"},"推荐产品:",-1)),e("span",Zo,i(k.value.product_recommendations.length)+" 个",1)])])])]),_:1}),t(x,{class:"details-card"},{default:s(()=>[t(he,{modelValue:a.value,"onUpdate:modelValue":v[1]||(v[1]=S=>a.value=S),type:"border-card"},{default:s(()=>[t(ee,{label:"产品推荐",name:"products"},{default:s(()=>[t(bt,{recommendations:k.value.product_recommendations,onCreateQuote:c},null,8,["recommendations"])]),_:1}),t(ee,{label:"市场分析",name:"market"},{default:s(()=>[t(xs,{"market-context":k.value.market_context},null,8,["market-context"])]),_:1}),t(ee,{label:"定价策略",name:"pricing"},{default:s(()=>[t(si,{strategies:k.value.pricing_strategies},null,8,["strategies"])]),_:1}),t(ee,{label:"风险与机会",name:"risks"},{default:s(()=>[t(eo,{analysis:k.value.risk_opportunity_analysis},null,8,["analysis"])]),_:1})]),_:1},8,["modelValue"])]),_:1}),e("div",Yo,[t(J,{type:"primary",onClick:n,loading:j.value,icon:"Download"},{default:s(()=>v[15]||(v[15]=[m(" 导出报告 ",-1)])),_:1,__:[15]},8,["loading"]),t(J,{onClick:p,icon:"Share"},{default:s(()=>v[16]||(v[16]=[m(" 分享建议 ",-1)])),_:1,__:[16]})])])):q("",!0),t(To,{visible:l.value,"onUpdate:visible":v[2]||(v[2]=S=>l.value=S),"product-recommendation":f.value,onQuoteCreated:o},null,8,["visible","product-recommendation"])])}}}),ya=G(xo,[["__scopeId","data-v-6ee1757a"]]);export{ya as default};
