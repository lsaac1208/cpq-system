const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/ai-analysis-DPd-iqke.js","js/index-CoBZUWE1.js","js/vendor-pdf-BeW0Xq92.js","js/vendor-ui-CE-ZhXxH.js","js/vendor-vue-XfLkFKXI.js","js/vendor-utils-B8vW8fJV.js","assets/index-DYWh58_h.css"])))=>i.map(i=>d[i]);
var Ce=Object.defineProperty;var u=(q,T)=>Ce(q,"name",{value:T,configurable:!0});var se=(q,T,E)=>new Promise((x,h)=>{var B=f=>{try{g(E.next(f))}catch(d){h(d)}},A=f=>{try{g(E.throw(f))}catch(d){h(d)}},g=f=>f.done?x(f.value):Promise.resolve(f.value).then(B,A);g((E=E.apply(q,T)).next())});import{s as k,u as $e,_ as _e}from"./index-CoBZUWE1.js";/* empty css                 *//* empty css                */import{x as me,r as U,X as de,c as ce,y as $,Q as s,K as V,I as l,A as e,u as w,M as _,O as p,H as Y,z as m,P as Re,a6 as Ee,D as X,al as Ie,V as pe,j as Me,aC as Se}from"./vendor-vue-XfLkFKXI.js";import{M as ze,N as Fe,O as we,at as Ve,b as fe,au as Pe,B as ue,af as Te,ag as De,X as Le,Y as Be,ai as Ue,bd as je,b3 as Oe,am as Ne,b4 as Ge,d as ve,J as Je,c as ke,j as ye,aD as We,V as Xe,aY as qe,ak as Ke,w as He,aJ as Ye,bi as Qe,as as xe,bj as Ze,bk as es,H as ge,G as he,F as be,bl as ss}from"./vendor-ui-CE-ZhXxH.js";import{_ as ts}from"./vendor-pdf-BeW0Xq92.js";/* empty css               *//* empty css                *//* empty css                  *//* empty css                 *//* empty css                        */import"./el-tooltip-l0sNRNKZ.js";/* empty css                     *//* empty css                          *//* empty css                    *//* empty css                       *//* empty css                 */import"./el-form-item-l0sNRNKZ.js";/* empty css                  *//* empty css                  */import{analyzeDocument as ls,getAnalysisStatistics as as}from"./ai-analysis-DPd-iqke.js";import{A as os}from"./AIAnalysisPreview-_TtnVAQb.js";/* empty css                 */import"./vendor-utils-B8vW8fJV.js";const ns={class:"enhanced-single-analysis"},is={class:"upload-content"},rs={key:0,class:"file-info"},ds={class:"file-item"},cs={class:"file-details"},us={class:"file-name"},ps={class:"file-size"},_s={class:"file-type"},ms={class:"analysis-actions"},fs={key:0,class:"analysis-progress"},vs={class:"progress-text"},ys={class:"progress-time"},gs={class:"model-status"},hs={class:"status-item"},bs={class:"status-item"},$s={class:"status-value"},ws={class:"status-item"},ks={class:"document-preview"},xs={class:"preview-content"},As={class:"preview-meta"},Cs={key:0,class:"analysis-results"},Rs={class:"result-header"},Es={class:"result-actions"},Is=me({__name:"EnhancedSingleAnalysis",emits:["analysis-success","analysis-error"],setup(q,{emit:T}){const E=T,x=U(),h=U(!1),B=U([]),A=U(null),g=U(null),f=de({type:"comprehensive",depth:"detailed",focus:["basic_info","specifications","features"],confidence_threshold:.7}),d=de({percentage:0,status:"",text:"准备开始分析...",estimated_time:0}),z=de({online:!0,response_time:850,load:45}),P=U(null),n=ce(()=>A.value&&!h.value),i=u((o,t)=>{B.value=t,o.raw&&(A.value=o.raw,v(o.raw))},"handleFileChange"),I=u(()=>{B.value=[],A.value=null,P.value=null,g.value=null},"handleFileRemove"),F=u(o=>{const t=["application/pdf","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/msword","text/plain"].includes(o.type),c=o.size/1024/1024<10;return t?(c||k.error("文件大小不能超过 10MB"),!1):(k.error("只支持 PDF、Word、TXT 格式的文件"),!1)},"beforeUpload"),v=u(o=>se(this,null,function*(){const t=yield y(o);P.value={text_preview:t.substring(0,300)+(t.length>300?"...":""),word_count:t.split(/\s+/).length,page_count:Math.ceil(t.length/2e3),language:a(t)}}),"generatePreview"),y=u(o=>new Promise(t=>{if(o.type==="text/plain"){const c=new FileReader;c.onload=C=>{var R;t(((R=C.target)==null?void 0:R.result)||"")},c.readAsText(o)}else t("这是一个示例文档内容，实际内容将通过服务器端解析获取...")}),"readFileAsText"),a=u(o=>/[\u4e00-\u9fff]/.test(o)?"中文":"英文","detectLanguage"),D=u(()=>se(this,null,function*(){if(A.value)try{h.value=!0,g.value=null,d.percentage=0,d.status="",d.text="准备开始分析...",d.estimated_time=60;const o=$e(),t=o.userRole;if(!o.isAuthenticated)throw new Error("请先登录后再使用AI分析功能");d.text="检查AI服务状态...";try{yield ts(()=>import("./ai-analysis-DPd-iqke.js"),__vite__mapDeps([0,1,2,3,4,5,6])).then(S=>S.getSupportedFormats())}catch(S){throw new Error("AI分析服务暂时不可用，请稍后重试或联系管理员")}if(!["application/pdf","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/msword","text/plain"].includes(A.value.type))throw new Error("不支持的文件格式：".concat(A.value.type,"，请上传 PDF、Word 或 TXT 文件"));const C=setInterval(()=>{d.percentage<90&&(d.percentage+=Math.random()*10,d.estimated_time=Math.max(0,d.estimated_time-3),d.percentage<30?d.text="正在解析文档结构...":d.percentage<60?d.text="正在提取关键信息...":d.text="正在生成分析结果...")},1e3);d.text="连接AI分析服务...";const R=yield ls(A.value);clearInterval(C);const b=R.data;if(b&&b.success)d.percentage=100,d.status="success",d.text="分析完成！",d.estimated_time=0,g.value=b,E("analysis-success",b),k.success("文档分析完成！");else{let S="分析失败，请稍后重试";throw b!=null&&b.error&&(b.error.includes("No document file")?S="未检测到文档文件，请重新上传":b.error.includes("Document contains no readable text")?S="文档内容无法读取，请检查文件是否损坏或为空白文档":b.error.includes("Document analysis failed")?S="AI分析引擎暂时无法处理此文档，请稍后重试":b.error.includes("timeout")?S="分析超时，请尝试上传较小的文档或稍后重试":b.error.includes("permission")?S="权限不足，请联系管理员":S="分析失败：".concat(b.error)),new Error(S)}}catch(o){let t="分析过程中发生未知错误",c="";if(o instanceof Error)t=o.message,t.includes("权限不足")?c="请联系管理员授予分析权限":t.includes("网络")?c="请检查网络连接":t.includes("服务不可用")?c="请稍后重试或联系技术支持":t.includes("文件格式")?c="请上传支持的文件格式（PDF/Word/TXT）":t.includes("超时")?c="请尝试上传较小的文件":c="请稍后重试，如问题持续请联系技术支持";else if(typeof o=="string")t=o;else if(o&&typeof o=="object")if(o.response){const R=o.response.status;switch(R){case 401:t="登录已过期，请重新登录",c="重新登录后再试";break;case 403:t="权限不足，无法访问AI分析功能",c="请联系管理员授予相应权限";break;case 404:t="AI分析服务未找到",c="请联系技术支持检查服务配置";break;case 500:t="服务器内部错误",c="请稍后重试或联系技术支持";break;default:t="服务请求失败 (".concat(R,")"),c="请稍后重试"}}else t=JSON.stringify(o);d.status="exception",d.text="分析失败";const C=c?"".concat(t,"。建议：").concat(c):t;E("analysis-error",C),k.error(C)}finally{h.value=!1}}),"startAnalysis"),M=u(()=>{k.success("分析结果已保存")},"saveResult"),r=u(()=>{g.value&&k.info("正在跳转到产品创建页面...")},"createProduct"),j=u(()=>{if(g.value){const o=JSON.stringify(g.value,null,2),t=new Blob([o],{type:"application/json"}),c=URL.createObjectURL(t),C=document.createElement("a");C.href=c,C.download="analysis-result-".concat(Date.now(),".json"),document.body.appendChild(C),C.click(),document.body.removeChild(C),URL.revokeObjectURL(c),k.success("分析结果已导出")}},"exportResult"),O=u(o=>{k.success("产品创建成功，ID: ".concat(o))},"handleProductCreated"),K=u((o,t)=>{},"handleFieldModified"),L=u(o=>o<1024?"".concat(o," B"):o<1024*1024?"".concat((o/1024).toFixed(1)," KB"):"".concat((o/1024/1024).toFixed(1)," MB"),"formatFileSize"),te=u(o=>({"application/pdf":"PDF文档","application/vnd.openxmlformats-officedocument.wordprocessingml.document":"Word文档","application/msword":"Word文档","text/plain":"文本文件"})[o]||"未知格式","getFileType"),le=u(o=>o<50?"#67c23a":o<80?"#e6a23c":"#f56c6c","getLoadColor"),ae=u(o=>{if(o<60)return"".concat(o,"秒");const t=Math.floor(o/60),c=o%60;return"".concat(t,"分").concat(c,"秒")},"formatTime");return(o,t)=>{const c=fe,C=Ve,R=we,b=Be,S=Le,G=De,H=je,oe=Ue,N=Ne,ne=Oe,ie=Ge,re=Te,Q=Fe,J=ve,Z=ke,ee=ye,Ae=ze;return m(),$("div",ns,[s(Ae,{gutter:20},{default:l(()=>[s(Q,{span:12},{default:l(()=>[s(R,{class:"upload-card"},{header:l(()=>t[4]||(t[4]=[e("h3",null,"文档上传",-1)])),default:l(()=>[s(C,{ref_key:"uploadRef",ref:x,class:"document-uploader",drag:"","auto-upload":!1,multiple:!1,"file-list":B.value,"on-change":i,"on-remove":I,"before-upload":F,accept:".pdf,.docx,.doc,.txt"},{default:l(()=>[e("div",is,[s(c,{class:"upload-icon"},{default:l(()=>[s(w(Pe))]),_:1}),t[5]||(t[5]=e("div",{class:"upload-text"},[e("p",null,[_("将文档拖拽到此处或"),e("em",null,"点击上传")]),e("p",{class:"upload-tip"},"支持 PDF、Word、TXT 格式，单个文件不超过10MB")],-1))])]),_:1},8,["file-list"]),A.value?(m(),$("div",rs,[e("div",ds,[s(c,{class:"file-icon"},{default:l(()=>[s(w(ue))]),_:1}),e("div",cs,[e("div",us,p(A.value.name),1),e("div",ps,p(L(A.value.size)),1),e("div",_s,p(te(A.value.type)),1)])])])):V("",!0)]),_:1}),s(R,{class:"config-card"},{header:l(()=>t[6]||(t[6]=[e("h3",null,"分析配置",-1)])),default:l(()=>[s(re,{"label-width":"100px"},{default:l(()=>[s(G,{label:"分析类型"},{default:l(()=>[s(S,{modelValue:f.type,"onUpdate:modelValue":t[0]||(t[0]=W=>f.type=W),style:{width:"100%"}},{default:l(()=>[s(b,{label:"产品信息提取",value:"product_extraction"}),s(b,{label:"文档分类",value:"document_classification"}),s(b,{label:"质量评估",value:"quality_assessment"}),s(b,{label:"综合分析",value:"comprehensive"})]),_:1},8,["modelValue"])]),_:1}),s(G,{label:"分析深度"},{default:l(()=>[s(oe,{modelValue:f.depth,"onUpdate:modelValue":t[1]||(t[1]=W=>f.depth=W)},{default:l(()=>[s(H,{value:"basic"},{default:l(()=>t[7]||(t[7]=[_("基础",-1)])),_:1,__:[7]}),s(H,{value:"detailed"},{default:l(()=>t[8]||(t[8]=[_("详细",-1)])),_:1,__:[8]}),s(H,{value:"comprehensive"},{default:l(()=>t[9]||(t[9]=[_("全面",-1)])),_:1,__:[9]})]),_:1},8,["modelValue"])]),_:1}),s(G,{label:"提取重点"},{default:l(()=>[s(ne,{modelValue:f.focus,"onUpdate:modelValue":t[2]||(t[2]=W=>f.focus=W)},{default:l(()=>[s(N,{value:"basic_info"},{default:l(()=>t[10]||(t[10]=[_("基本信息",-1)])),_:1,__:[10]}),s(N,{value:"specifications"},{default:l(()=>t[11]||(t[11]=[_("技术规格",-1)])),_:1,__:[11]}),s(N,{value:"features"},{default:l(()=>t[12]||(t[12]=[_("产品特性",-1)])),_:1,__:[12]}),s(N,{value:"pricing"},{default:l(()=>t[13]||(t[13]=[_("价格信息",-1)])),_:1,__:[13]}),s(N,{value:"quality"},{default:l(()=>t[14]||(t[14]=[_("质量标准",-1)])),_:1,__:[14]})]),_:1},8,["modelValue"])]),_:1}),s(G,{label:"置信度"},{default:l(()=>[s(ie,{modelValue:f.confidence_threshold,"onUpdate:modelValue":t[3]||(t[3]=W=>f.confidence_threshold=W),min:.3,max:.9,step:.1,"show-stops":"","show-input":"","input-size":"small"},null,8,["modelValue"]),t[15]||(t[15]=e("div",{class:"config-tip"},"设置最低置信度阈值，低于此值的结果将被标记",-1))]),_:1,__:[15]})]),_:1})]),_:1})]),_:1}),s(Q,{span:12},{default:l(()=>[s(R,{class:"action-card"},{header:l(()=>t[16]||(t[16]=[e("h3",null,"分析控制",-1)])),default:l(()=>[e("div",ms,[s(J,{type:"primary",size:"large",loading:h.value,onClick:D,disabled:!n.value,class:"analyze-btn"},{icon:l(()=>[s(c,null,{default:l(()=>[s(w(Je))]),_:1})]),default:l(()=>[_(" "+p(h.value?"分析中...":"开始智能分析"),1)]),_:1},8,["loading","disabled"]),h.value?(m(),$("div",fs,[s(Z,{percentage:d.percentage,status:d.status,"stroke-width":8},null,8,["percentage","status"]),e("div",vs,p(d.text),1),e("div",ys," 预计剩余时间: "+p(ae(d.estimated_time)),1)])):V("",!0)])]),_:1}),s(R,{class:"model-status-card"},{header:l(()=>t[17]||(t[17]=[e("h3",null,"AI模型状态",-1)])),default:l(()=>[e("div",gs,[e("div",hs,[t[18]||(t[18]=e("span",{class:"status-label"},"智谱AI GLM-4",-1)),s(ee,{type:z.online?"success":"danger",size:"small"},{default:l(()=>[_(p(z.online?"在线":"离线"),1)]),_:1},8,["type"])]),e("div",bs,[t[19]||(t[19]=e("span",{class:"status-label"},"响应时间",-1)),e("span",$s,p(z.response_time)+"ms",1)]),e("div",ws,[t[20]||(t[20]=e("span",{class:"status-label"},"负载状态",-1)),s(Z,{percentage:z.load,color:le(z.load),"show-text":!1,"stroke-width":6},null,8,["percentage","color"])])])]),_:1}),P.value?(m(),Y(R,{key:0,class:"preview-card"},{header:l(()=>t[21]||(t[21]=[e("h3",null,"文档预览",-1)])),default:l(()=>[e("div",ks,[e("div",xs,p(P.value.text_preview),1),e("div",As,[e("span",null,"字数: "+p(P.value.word_count),1),e("span",null,"页数: "+p(P.value.page_count),1),e("span",null,"语言: "+p(P.value.language),1)])])]),_:1})):V("",!0)]),_:1})]),_:1}),g.value?(m(),$("div",Cs,[s(R,{class:"result-card"},{header:l(()=>[e("div",Rs,[t[25]||(t[25]=e("h3",null,"分析结果",-1)),e("div",Es,[s(J,{type:"success",size:"small",onClick:M},{icon:l(()=>[s(c,null,{default:l(()=>[s(w(We))]),_:1})]),default:l(()=>[t[22]||(t[22]=_(" 保存结果 ",-1))]),_:1,__:[22]}),s(J,{type:"primary",size:"small",onClick:r},{icon:l(()=>[s(c,null,{default:l(()=>[s(w(Xe))]),_:1})]),default:l(()=>[t[23]||(t[23]=_(" 创建产品 ",-1))]),_:1,__:[23]}),s(J,{type:"info",size:"small",onClick:j},{icon:l(()=>[s(c,null,{default:l(()=>[s(w(qe))]),_:1})]),default:l(()=>[t[24]||(t[24]=_(" 导出结果 ",-1))]),_:1,__:[24]})])])]),default:l(()=>[s(os,{analysisResult:g.value,onProductCreated:O,onFieldModified:K},null,8,["analysisResult"])]),_:1})])):V("",!0)])}}}),Ms=_e(Is,[["__scopeId","data-v-a9e1ed2a"]]),Ss={class:"recent-analysis-results"},zs={key:0,class:"empty-state"},Fs={key:1,class:"results-list"},Vs=["onClick"],Ps={class:"result-header"},Ts={class:"result-title"},Ds={class:"document-name"},Ls={class:"result-status"},Bs={key:0,class:"result-content"},Us={class:"result-summary"},js={class:"result-details"},Os={class:"detail-item"},Ns={class:"detail-item"},Gs={class:"detail-item"},Js={class:"result-metrics"},Ws={class:"metric-item"},Xs={class:"metric-value"},qs={class:"metric-item"},Ks={class:"metric-value"},Hs={class:"result-features"},Ys={class:"feature-count"},Qs={class:"feature-count"},Zs={class:"feature-count"},et={key:1,class:"result-error"},st={class:"result-footer"},tt={class:"result-meta"},lt={class:"meta-item"},at={class:"meta-item"},ot={key:0,class:"meta-item"},nt={class:"result-actions"},it=me({__name:"RecentAnalysisResults",props:{results:{}},emits:["result-selected","start-analysis"],setup(q,{emit:T}){const E=T,x=u(n=>n>=.8?"#67c23a":n>=.6?"#e6a23c":"#f56c6c","getConfidenceColor"),h=u(n=>n>=.9?"#67c23a":n>=.7?"#e6a23c":"#f56c6c","getCompletenessColor"),B=u(n=>{const i=new Date(n),F=new Date().getTime()-i.getTime(),v=Math.floor(F/(1e3*60)),y=Math.floor(F/(1e3*60*60)),a=Math.floor(F/(1e3*60*60*24));return v<1?"刚刚":v<60?"".concat(v,"分钟前"):y<24?"".concat(y,"小时前"):a<7?"".concat(a,"天前"):i.toLocaleDateString("zh-CN")},"formatTime"),A=u(n=>n<1024?"".concat(n," B"):n<1024*1024?"".concat((n/1024).toFixed(1)," KB"):"".concat((n/1024/1024).toFixed(1)," MB"),"formatFileSize"),g=u(n=>{E("result-selected",n)},"viewDetails"),f=u(n=>{k.info("跳转到产品创建页面...")},"createProduct"),d=u(n=>{const i=JSON.stringify(n,null,2),I=new Blob([i],{type:"application/json"}),F=URL.createObjectURL(I),v=document.createElement("a");v.href=F,v.download="analysis-".concat(n.document_info.filename,"-").concat(Date.now(),".json"),document.body.appendChild(v),v.click(),document.body.removeChild(v),URL.revokeObjectURL(F),k.success("分析结果已导出")},"exportResult"),z=u((n,i="待确认")=>{if(!n||typeof n=="string"&&!n.trim())return i;if(typeof n=="string"){const I=n.trim();return["未识别","未知","unknown","N/A","null","undefined","待定","无"].some(v=>I.toLowerCase().includes(v.toLowerCase()))||I.length<2?i:I}if(typeof n=="number")return n.toString();if(typeof n=="object"){if(Array.isArray(n))return n.length>0?"".concat(n.length,"项"):i;if(n.value!==void 0)return z(n.value,i)}return String(n)||i},"getDisplayValue"),P=u(n=>{const i=z(n,"");return!n||i.includes("待确认")||i.includes("待定")?"value-pending":typeof n=="string"&&n.trim().length>=2||typeof n=="number"&&n>0?"value-valid":"value-normal"},"getValueClass");return(n,i)=>{const I=ve,F=Ke,v=fe,y=ye,a=ke,D=Ie("Menu"),M=xe;return m(),$("div",Ss,[n.results.length===0?(m(),$("div",zs,[s(F,{description:"暂无分析结果"},{default:l(()=>[s(I,{type:"primary",onClick:i[0]||(i[0]=r=>n.$emit("start-analysis"))},{default:l(()=>i[1]||(i[1]=[_("开始分析",-1)])),_:1,__:[1]})]),_:1})])):(m(),$("div",Fs,[(m(!0),$(Re,null,Ee(n.results,(r,j)=>{var O,K,L,te,le,ae,o,t,c,C,R,b,S,G,H,oe,N,ne,ie,re,Q,J,Z;return m(),$("div",{key:j,class:"result-item",onClick:u(ee=>n.$emit("result-selected",r),"onClick")},[e("div",Ps,[e("div",Ts,[s(v,{class:"result-icon"},{default:l(()=>[r.success?(m(),Y(w(ue),{key:0})):(m(),Y(w(He),{key:1}))]),_:2},1024),e("span",Ds,p(r.document_info.filename),1)]),e("div",Ls,[s(y,{type:r.success?"success":"danger",size:"small"},{default:l(()=>[_(p(r.success?"成功":"失败"),1)]),_:2},1032,["type"])])]),r.success?(m(),$("div",Bs,[e("div",Us,p(r.summary),1),e("div",js,[e("div",Os,[i[2]||(i[2]=e("span",{class:"detail-label"},"产品名称:",-1)),e("span",{class:X(["detail-value",P((K=(O=r.extracted_data)==null?void 0:O.basic_info)==null?void 0:K.name)])},p(z((te=(L=r.extracted_data)==null?void 0:L.basic_info)==null?void 0:te.name,"产品名称待确认")),3)]),e("div",Ns,[i[3]||(i[3]=e("span",{class:"detail-label"},"产品代码:",-1)),e("span",{class:X(["detail-value",P((ae=(le=r.extracted_data)==null?void 0:le.basic_info)==null?void 0:ae.code)])},p(z((t=(o=r.extracted_data)==null?void 0:o.basic_info)==null?void 0:t.code,"代码待确认")),3)]),e("div",Gs,[i[4]||(i[4]=e("span",{class:"detail-label"},"产品分类:",-1)),e("span",{class:X(["detail-value",P((C=(c=r.extracted_data)==null?void 0:c.basic_info)==null?void 0:C.category)])},p(z((b=(R=r.extracted_data)==null?void 0:R.basic_info)==null?void 0:b.category,"分类待确认")),3)])]),e("div",Js,[e("div",Ws,[i[5]||(i[5]=e("span",{class:"metric-label"},"整体置信度:",-1)),s(a,{percentage:Math.round((((S=r.confidence_scores)==null?void 0:S.overall)||0)*100),color:x(((G=r.confidence_scores)==null?void 0:G.overall)||0),"stroke-width":6,"show-text":!1,style:{width:"80px"}},null,8,["percentage","color"]),e("span",Xs,p(Math.round((((H=r.confidence_scores)==null?void 0:H.overall)||0)*100))+"% ",1)]),e("div",qs,[i[6]||(i[6]=e("span",{class:"metric-label"},"完整性:",-1)),s(a,{percentage:Math.round((((oe=r.validation)==null?void 0:oe.completeness_score)||0)*100),color:h(((N=r.validation)==null?void 0:N.completeness_score)||0),"stroke-width":6,"show-text":!1,style:{width:"80px"}},null,8,["percentage","color"]),e("span",Ks,p(Math.round((((ne=r.validation)==null?void 0:ne.completeness_score)||0)*100))+"% ",1)])]),e("div",Hs,[e("div",Ys,[s(v,null,{default:l(()=>[s(D)]),_:1}),e("span",null,"规格 "+p(Object.keys(((ie=r.extracted_data)==null?void 0:ie.specifications)||{}).length)+" 项",1)]),e("div",Qs,[s(v,null,{default:l(()=>[s(w(Ye))]),_:1}),e("span",null,"特性 "+p(((Q=(re=r.extracted_data)==null?void 0:re.features)==null?void 0:Q.length)||0)+" 项",1)]),e("div",Zs,[s(v,null,{default:l(()=>[s(w(Qe))]),_:1}),e("span",null,"认证 "+p(((Z=(J=r.extracted_data)==null?void 0:J.certificates)==null?void 0:Z.length)||0)+" 项",1)])])])):(m(),$("div",et,[s(M,{title:r.error||"分析失败",type:"error",closable:!1,"show-icon":""},null,8,["title"])])),e("div",st,[e("div",tt,[e("span",lt,[s(v,null,{default:l(()=>[s(w(Ze))]),_:1}),_(" "+p(B(r.analysis_timestamp)),1)]),e("span",at,[s(v,null,{default:l(()=>[s(w(ue))]),_:1}),_(" "+p(A(r.document_info.size)),1)]),r.document_info.analysis_duration?(m(),$("span",ot,[s(v,null,{default:l(()=>[s(w(es))]),_:1}),_(" "+p(r.document_info.analysis_duration)+"s ",1)])):V("",!0)]),e("div",nt,[r.success?(m(),Y(I,{key:0,type:"primary",size:"small",text:"",onClick:pe(ee=>g(r),["stop"])},{default:l(()=>i[7]||(i[7]=[_(" 查看详情 ",-1)])),_:2,__:[7]},1032,["onClick"])):V("",!0),r.success?(m(),Y(I,{key:1,type:"success",size:"small",text:"",onClick:pe(ee=>f(),["stop"])},{default:l(()=>i[8]||(i[8]=[_(" 创建产品 ",-1)])),_:2,__:[8]},1032,["onClick"])):V("",!0),s(I,{type:"info",size:"small",text:"",onClick:pe(ee=>d(r),["stop"])},{default:l(()=>i[9]||(i[9]=[_(" 导出结果 ",-1)])),_:2,__:[9]},1032,["onClick"])])])],8,Vs)}),128))]))])}}}),rt=_e(it,[["__scopeId","data-v-b23e10cd"]]),dt={class:"ai-analysis-enhanced"},ct={class:"analysis-container"},ut={class:"feature-cards"},pt={class:"card-content"},_t={class:"card-content"},mt={class:"card-content"},ft={class:"card-content"},vt={key:0,class:"feature-content"},yt={key:0,class:"permission-warning"},gt={key:1,class:"feature-content"},ht={class:"batch-analysis-section"},bt={class:"quick-actions"},$t={key:0,class:"permission-hint"},wt={key:2,class:"feature-content"},kt={class:"comparison-section"},xt={class:"quick-actions"},At={key:0,class:"permission-hint"},Ct={key:3,class:"feature-content"},Rt={class:"optimization-section"},Et={class:"quick-actions"},It={key:0,class:"permission-hint"},Mt={class:"stats-overview"},St={class:"stat-item"},zt={class:"stat-number"},Ft={class:"stat-item"},Vt={class:"stat-number"},Pt={class:"stat-item"},Tt={class:"stat-number"},Dt={class:"stat-item"},Lt={class:"stat-number"},Bt={class:"card-header"},Ut={class:"model-info"},jt={class:"model-item"},Ot={class:"model-value"},Nt={class:"model-item"},Gt={class:"model-value"},Jt=me({__name:"AIAnalysisEnhanced",setup(q){const T=Se(),E=$e(),x=U("single"),h=ce(()=>E.hasAIAnalysisRole),B=ce(()=>E.userRole),A=ce(()=>E.isAuthenticated),g=de({totalAnalyses:0,successRate:0,avgConfidence:0,processingJobs:0}),f=U([]),d=U("online"),z=U(850),P=u(y=>{k.success("分析完成！"),f.value.unshift(y),f.value.length>5&&(f.value=f.value.slice(0,5)),F()},"handleSingleAnalysisSuccess"),n=u(y=>{k.error("分析失败: ".concat(y))},"handleAnalysisError"),i=u(y=>{k.info("查看分析结果详情")},"handleResultSelected"),I=u(()=>{k.info("查看所有分析结果")},"viewAllResults"),F=u(()=>se(this,null,function*(){if(h.value)try{const y=yield as({days:30});y.success&&(g.totalAnalyses=y.statistics.total_analyses,g.successRate=y.statistics.success_rate,g.avgConfidence=y.statistics.average_confidence)}catch(y){k.error("加载统计数据失败：请确认您有足够的权限")}}),"loadStatistics"),v=u(()=>{const y=Math.random();d.value=y>.1?"online":"offline",z.value=Math.floor(Math.random()*500)+600},"checkModelStatus");return Me(()=>se(this,null,function*(){if(!A.value){k.warning("请先登录后再使用AI分析功能"),T.push("/login");return}if(!E.user&&E.token)try{yield E.loadUserProfile()}catch(y){k.error("用户信息加载失败，请重新登录"),T.push("/login");return}if(!h.value){k.error("抱歉，".concat(B.value," 角色无权访问AI分析功能。仅限 engineer、admin、manager 角色使用。")),T.push("/dashboard");return}F(),v(),setInterval(v,3e4),k.success("AI智能分析系统已就绪，基于智谱AI GLM-4模型提供服务")})),(y,a)=>{const D=fe,M=we,r=xe,j=ve,O=ss,K=ye;return m(),$("div",dt,[a[36]||(a[36]=e("div",{class:"page-header"},[e("h1",null,"AI智能分析增强版"),e("p",{class:"page-description"},"基于智谱AI GLM-4模型，提供更智能、更准确的文档分析和数据提取")],-1)),e("div",ct,[e("div",ut,[s(M,{class:X(["feature-card",{active:x.value==="single"}]),onClick:a[0]||(a[0]=L=>x.value="single")},{default:l(()=>[e("div",pt,[s(D,{class:"card-icon"},{default:l(()=>[s(w(ue))]),_:1}),a[7]||(a[7]=e("h3",null,"单文档智能分析",-1)),a[8]||(a[8]=e("p",null,"深度分析单个文档，提取结构化数据",-1))])]),_:1},8,["class"]),s(M,{class:X(["feature-card",{active:x.value==="batch"}]),onClick:a[1]||(a[1]=L=>x.value="batch")},{default:l(()=>[e("div",_t,[s(D,{class:"card-icon"},{default:l(()=>[s(w(ge))]),_:1}),a[9]||(a[9]=e("h3",null,"批量智能分析",-1)),a[10]||(a[10]=e("p",null,"高效处理多个文档的批量分析任务",-1))])]),_:1},8,["class"]),s(M,{class:X(["feature-card",{active:x.value==="comparison"}]),onClick:a[2]||(a[2]=L=>x.value="comparison")},{default:l(()=>[e("div",mt,[s(D,{class:"card-icon"},{default:l(()=>[s(w(he))]),_:1}),a[11]||(a[11]=e("h3",null,"智能文档对比",-1)),a[12]||(a[12]=e("p",null,"AI驱动的多文档对比和差异分析",-1))])]),_:1},8,["class"]),s(M,{class:X(["feature-card",{active:x.value==="optimization"}]),onClick:a[3]||(a[3]=L=>x.value="optimization")},{default:l(()=>[e("div",ft,[s(D,{class:"card-icon"},{default:l(()=>[s(w(be))]),_:1}),a[13]||(a[13]=e("h3",null,"Prompt智能优化",-1)),a[14]||(a[14]=e("p",null,"基于历史数据优化AI提示词效果",-1))])]),_:1},8,["class"])]),s(M,{class:"main-feature-area"},{default:l(()=>[x.value==="single"?(m(),$("div",vt,[a[15]||(a[15]=e("div",{class:"feature-header"},[e("h2",null,"单文档智能分析"),e("p",null,"上传文档，AI将自动识别并提取关键信息，支持产品规格、技术参数、价格等数据")],-1)),h.value?(m(),Y(Ms,{key:1,onAnalysisSuccess:P,onAnalysisError:n})):(m(),$("div",yt,[s(r,{title:"权限不足",description:"当前角色 ".concat(B.value," 无权使用AI分析功能。请联系管理员分配 engineer、admin 或 manager 角色。"),type:"warning","show-icon":"",closable:!1},null,8,["description"])]))])):V("",!0),x.value==="batch"?(m(),$("div",gt,[a[18]||(a[18]=e("div",{class:"feature-header"},[e("h2",null,"批量智能分析"),e("p",null,"一次性上传多个文档，系统将自动排队处理，提供实时进度监控")],-1)),e("div",ht,[s(r,{title:"批量分析功能",type:"info",description:"此功能可在批量分析页面使用，点击下方按钮快速跳转","show-icon":"",closable:!1,style:{"margin-bottom":"20px"}}),e("div",bt,[s(j,{type:"primary",size:"large",disabled:!h.value,onClick:a[4]||(a[4]=L=>y.$router.push("/batch-analysis"))},{icon:l(()=>[s(D,null,{default:l(()=>[s(w(ge))]),_:1})]),default:l(()=>[a[16]||(a[16]=_(" 进入批量分析 ",-1))]),_:1,__:[16]},8,["disabled"]),h.value?V("",!0):(m(),$("div",$t,[s(O,{type:"warning",size:"small"},{default:l(()=>a[17]||(a[17]=[_("需要 engineer/admin/manager 权限",-1)])),_:1,__:[17]})]))])])])):V("",!0),x.value==="comparison"?(m(),$("div",wt,[a[21]||(a[21]=e("div",{class:"feature-header"},[e("h2",null,"智能文档对比"),e("p",null,"上传多个文档进行AI驱动的智能对比，识别相似性和差异性")],-1)),e("div",kt,[s(r,{title:"文档对比功能",type:"info",description:"此功能可在文档对比页面使用，点击下方按钮快速跳转","show-icon":"",closable:!1,style:{"margin-bottom":"20px"}}),e("div",xt,[s(j,{type:"primary",size:"large",disabled:!h.value,onClick:a[5]||(a[5]=L=>y.$router.push("/document-comparison"))},{icon:l(()=>[s(D,null,{default:l(()=>[s(w(he))]),_:1})]),default:l(()=>[a[19]||(a[19]=_(" 进入文档对比 ",-1))]),_:1,__:[19]},8,["disabled"]),h.value?V("",!0):(m(),$("div",At,[s(O,{type:"warning",size:"small"},{default:l(()=>a[20]||(a[20]=[_("需要 engineer/admin/manager 权限",-1)])),_:1,__:[20]})]))])])])):V("",!0),x.value==="optimization"?(m(),$("div",Ct,[a[24]||(a[24]=e("div",{class:"feature-header"},[e("h2",null,"Prompt智能优化"),e("p",null,"基于历史分析数据，智能优化AI提示词，提升分析准确性和用户满意度")],-1)),e("div",Rt,[s(r,{title:"Prompt优化功能",type:"info",description:"此功能可在Prompt优化页面使用，点击下方按钮快速跳转","show-icon":"",closable:!1,style:{"margin-bottom":"20px"}}),e("div",Et,[s(j,{type:"primary",size:"large",disabled:!h.value,onClick:a[6]||(a[6]=L=>y.$router.push("/prompt-optimization"))},{icon:l(()=>[s(D,null,{default:l(()=>[s(w(be))]),_:1})]),default:l(()=>[a[22]||(a[22]=_(" 进入Prompt优化 ",-1))]),_:1,__:[22]},8,["disabled"]),h.value?V("",!0):(m(),$("div",It,[s(O,{type:"warning",size:"small"},{default:l(()=>a[23]||(a[23]=[_("需要 engineer/admin/manager 权限",-1)])),_:1,__:[23]})]))])])])):V("",!0)]),_:1}),e("div",Mt,[s(M,{class:"stats-card"},{default:l(()=>[e("div",St,[e("div",zt,p(g.totalAnalyses),1),a[25]||(a[25]=e("div",{class:"stat-label"},"总分析次数",-1))])]),_:1}),s(M,{class:"stats-card"},{default:l(()=>[e("div",Ft,[e("div",Vt,p((g.successRate*100).toFixed(1))+"%",1),a[26]||(a[26]=e("div",{class:"stat-label"},"成功率",-1))])]),_:1}),s(M,{class:"stats-card"},{default:l(()=>[e("div",Pt,[e("div",Tt,p(g.avgConfidence.toFixed(1)),1),a[27]||(a[27]=e("div",{class:"stat-label"},"平均置信度",-1))])]),_:1}),s(M,{class:"stats-card"},{default:l(()=>[e("div",Dt,[e("div",Lt,p(g.processingJobs),1),a[28]||(a[28]=e("div",{class:"stat-label"},"处理中任务",-1))])]),_:1})])]),s(M,{class:"recent-results-card"},{header:l(()=>[e("div",Bt,[a[30]||(a[30]=e("h3",null,"最近分析结果",-1)),s(j,{link:"",onClick:I},{default:l(()=>a[29]||(a[29]=[_("查看全部",-1)])),_:1,__:[29]})])]),default:l(()=>[s(rt,{results:f.value,onResultSelected:i},null,8,["results"])]),_:1}),s(M,{class:"model-info-card"},{header:l(()=>a[31]||(a[31]=[e("h3",null,"AI模型信息",-1)])),default:l(()=>[e("div",Ut,[a[34]||(a[34]=e("div",{class:"model-item"},[e("div",{class:"model-label"},"当前模型"),e("div",{class:"model-value"},"智谱AI GLM-4")],-1)),a[35]||(a[35]=e("div",{class:"model-item"},[e("div",{class:"model-label"},"模型版本"),e("div",{class:"model-value"},"GLM-4-0520")],-1)),e("div",jt,[a[32]||(a[32]=e("div",{class:"model-label"},"服务状态",-1)),e("div",Ot,[s(K,{type:d.value==="online"?"success":"danger"},{default:l(()=>[_(p(d.value==="online"?"在线":"离线"),1)]),_:1},8,["type"])])]),e("div",Nt,[a[33]||(a[33]=e("div",{class:"model-label"},"响应时间",-1)),e("div",Gt,p(z.value)+"ms",1)])])]),_:1})])}}}),yl=_e(Jt,[["__scopeId","data-v-3fbf611a"]]);export{yl as default};
