# CPQç³»ç»Ÿå®å¡”é¢æ¿éƒ¨ç½²å·¥å…·åŒ…

## ğŸ¯ æ¦‚è¿°

è¿™æ˜¯CPQç³»ç»Ÿåœ¨å®å¡”é¢æ¿çš„å®Œæ•´éƒ¨ç½²è§£å†³æ–¹æ¡ˆï¼Œç”± **devops-troubleshooter + cloud-architect + backend-architect** è”åˆå›¢é˜Ÿå¼€å‘ã€‚åŒ…å«è‡ªåŠ¨åŒ–è„šæœ¬ã€éªŒè¯å·¥å…·å’Œè¯¦ç»†æ–‡æ¡£ï¼Œè®©æ‚¨å¯ä»¥åœ¨30åˆ†é’Ÿå†…å®Œæˆå®Œæ•´çš„ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²ã€‚

## ğŸ“¦ å·¥å…·åŒ…å†…å®¹

### ğŸ¤– è‡ªåŠ¨åŒ–è„šæœ¬
- **`baota-deploy-automation.sh`** - å®å¡”ç¯å¢ƒä¸€é”®é…ç½®è„šæœ¬
- **`package-preparation.sh`** - éƒ¨ç½²åŒ…è‡ªåŠ¨ç”Ÿæˆè„šæœ¬
- **`cpq-deployment-validator.py`** - æ™ºèƒ½éƒ¨ç½²éªŒè¯å·¥å…·
- **`test-deployment-tools.sh`** - å·¥å…·åŒ…å®Œæ•´æ€§æµ‹è¯•

### ğŸ“š è¯¦ç»†æ–‡æ¡£  
- **`DEPLOYMENT_EXECUTION_GUIDE.md`** - å®Œæ•´éƒ¨ç½²æ‰§è¡ŒæŒ‡å—
- **`step-by-step-deployment-guide.md`** - åˆ†æ­¥è¯¦ç»†æ“ä½œæ‰‹å†Œ
- **`deployment-commands.md`** - å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥è¡¨
- **`FINAL_DEPLOYMENT_SUMMARY.md`** - éƒ¨ç½²æ–¹æ¡ˆæ€»ç»“

### âš™ï¸ é…ç½®æ¨¡æ¿
- Nginxå‰åç«¯é…ç½®æ¨¡æ¿
- systemdæœåŠ¡é…ç½®æ–‡ä»¶
- ç¯å¢ƒå˜é‡é…ç½®æ¨¡æ¿
- Gunicorn WSGIæœåŠ¡é…ç½®

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¬¬ä¸€æ­¥ï¼šéªŒè¯å·¥å…·åŒ…å®Œæ•´æ€§

```bash
cd deployment/
./test-deployment-tools.sh
```

åº”è¯¥çœ‹åˆ°ï¼š
```
âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼éƒ¨ç½²å·¥å…·å‡†å¤‡å°±ç»ª
```

### ç¬¬äºŒæ­¥ï¼šç”Ÿæˆéƒ¨ç½²åŒ…

```bash
./package-preparation.sh
```

å°†ç”Ÿæˆå®Œæ•´çš„éƒ¨ç½²åŒ…ï¼š`cpq-baota-deploy-YYYYMMDD_HHMMSS.tar.gz`

### ç¬¬ä¸‰æ­¥ï¼šä¸Šä¼ åˆ°å®å¡”æœåŠ¡å™¨

é€šè¿‡å®å¡”é¢æ¿æ–‡ä»¶ç®¡ç†å™¨æˆ–SCPå‘½ä»¤ä¸Šä¼ éƒ¨ç½²åŒ…åˆ°æœåŠ¡å™¨ã€‚

### ç¬¬å››æ­¥ï¼šæœåŠ¡å™¨ç«¯ä¸€é”®éƒ¨ç½²

åœ¨å®å¡”æœåŠ¡å™¨ç»ˆç«¯æ‰§è¡Œï¼š

```bash
# è§£å‹éƒ¨ç½²åŒ…
tar -xzf cpq-baota-deploy-*.tar.gz
cd cpq-baota-deploy-*/scripts/

# ä¸€é”®å®‰è£…
./quick-install.sh
```

### ç¬¬äº”æ­¥ï¼šéªŒè¯éƒ¨ç½²

```bash
python3 cpq-deployment-validator.py
```

åº”è¯¥çœ‹åˆ°ï¼š
```
ğŸ‰ éƒ¨ç½²éªŒè¯é€šè¿‡ï¼
ğŸŒ è®¿é—®åœ°å€: http://cpq.d1bk.com  
ğŸ” é»˜è®¤ç™»å½•: admin / admin123
```

## ğŸ“Š éƒ¨ç½²ç›®æ ‡

- **å‰ç«¯åŸŸå**: `cpq.d1bk.com` (HTTPç«¯å£80)
- **åç«¯åŸŸå**: `cpqh.d1bbk.com` (HTTPç«¯å£5000)
- **æ•°æ®åº“**: MySQL `cpq_system`
- **é¢„è®¡ç”¨æ—¶**: 30-45åˆ†é’Ÿ

## âœ… ç³»ç»Ÿè¦æ±‚

### æœåŠ¡å™¨ç¯å¢ƒ
- **æ“ä½œç³»ç»Ÿ**: CentOS 7+ / Ubuntu 18+ / Debian 9+
- **å®å¡”é¢æ¿**: 7.7.0+
- **å†…å­˜**: 2GB+ æ¨è
- **ç¡¬ç›˜**: 5GB+ å¯ç”¨ç©ºé—´
- **CPU**: 2æ ¸+ æ¨è

### è½¯ä»¶ç‰ˆæœ¬
- **Python**: 3.8+
- **MySQL**: 5.7+ / 8.0+  
- **Nginx**: 1.18+

### åŸŸåå‡†å¤‡
ç¡®ä¿ä»¥ä¸‹åŸŸåå·²è§£æåˆ°æœåŠ¡å™¨IPï¼š
- `cpq.d1bk.com` (å‰ç«¯)
- `cpqh.d1bbk.com` (åç«¯)

## ğŸ”§ å¸¸ç”¨ç®¡ç†å‘½ä»¤

```bash
# æœåŠ¡ç®¡ç† (åœ¨åç«¯ç›®å½•æ‰§è¡Œ)
cd /www/wwwroot/cpqh.d1bbk.com/
./start.sh start    # å¯åŠ¨æœåŠ¡
./start.sh stop     # åœæ­¢æœåŠ¡
./start.sh restart  # é‡å¯æœåŠ¡
./start.sh status   # æŸ¥çœ‹çŠ¶æ€
./start.sh logs     # æŸ¥çœ‹æ—¥å¿—
./start.sh health   # å¥åº·æ£€æŸ¥

# éƒ¨ç½²éªŒè¯
python3 /root/cpq-baota-deploy-*/scripts/cpq-deployment-validator.py
```

## ğŸ“‹ éƒ¨ç½²åæ£€æŸ¥æ¸…å•

- [ ] å‰ç«¯é¡µé¢å¯è®¿é—® (`http://cpq.d1bk.com`)
- [ ] åç«¯APIå¥åº·æ£€æŸ¥é€šè¿‡ (`http://cpqh.d1bbk.com/health`)
- [ ] ç®¡ç†å‘˜è´¦å·å¯æ­£å¸¸ç™»å½• (admin/admin123)
- [ ] äº§å“ç®¡ç†åŠŸèƒ½æ­£å¸¸
- [ ] æŠ¥ä»·ç®¡ç†åŠŸèƒ½æ­£å¸¸
- [ ] æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½æ­£å¸¸

## ğŸš¨ æ•…éšœæ’æŸ¥

### 1. å¦‚æœä¸€é”®å®‰è£…å¤±è´¥
```bash
# æŸ¥çœ‹è¯¦ç»†é”™è¯¯æ—¥å¿—
./quick-install.sh 2>&1 | tee install.log

# ç„¶åå‚è€ƒ step-by-step-deployment-guide.md è¿›è¡Œæ‰‹åŠ¨éƒ¨ç½²
```

### 2. å¦‚æœæœåŠ¡å¯åŠ¨å¤±è´¥
```bash
# æŸ¥çœ‹ç³»ç»ŸæœåŠ¡æ—¥å¿—
journalctl -u cpq-api --no-pager -l

# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
tail -f /www/wwwroot/cpqh.d1bbk.com/logs/app.log

# æ‰‹åŠ¨æµ‹è¯•å¯åŠ¨
cd /www/wwwroot/cpqh.d1bbk.com/
python3 app.py
```

### 3. å¦‚æœå‰ç«¯é¡µé¢ç©ºç™½
```bash
# æ£€æŸ¥Nginxé…ç½®
nginx -t

# æ£€æŸ¥æ–‡ä»¶æƒé™
ls -la /www/wwwroot/cpq.d1bk.com/dist/

# æŸ¥çœ‹Nginxé”™è¯¯æ—¥å¿—
tail -f /www/server/nginx/logs/error.log
```

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### è·å–å¸®åŠ©çš„æ­¥éª¤

1. **è¿è¡ŒéªŒè¯è„šæœ¬**: `python3 cpq-deployment-validator.py`
2. **æŸ¥çœ‹è¯¦ç»†æ–‡æ¡£**: å‚è€ƒå¯¹åº”çš„.mdæ–‡æ¡£æ–‡ä»¶
3. **æ”¶é›†é”™è¯¯ä¿¡æ¯**: ä¿å­˜ç›¸å…³çš„æ—¥å¿—æ–‡ä»¶
4. **æ£€æŸ¥å‘½ä»¤å‚è€ƒ**: æŸ¥çœ‹ `deployment-commands.md`

### æ—¥å¿—æ–‡ä»¶ä½ç½®
- åº”ç”¨æ—¥å¿—: `/www/wwwroot/cpqh.d1bbk.com/logs/app.log`
- ç³»ç»Ÿæ—¥å¿—: `journalctl -u cpq-api`
- Nginxæ—¥å¿—: `/www/server/nginx/logs/error.log`
- éªŒè¯æŠ¥å‘Š: `/www/wwwroot/cpqh.d1bbk.com/logs/validation_report_*.json`

## ğŸ‰ éƒ¨ç½²æˆåŠŸå

æ­å–œï¼æ‚¨å°†æ‹¥æœ‰ï¼š

- âœ… å®Œæ•´çš„ç”Ÿäº§çº§CPQç³»ç»Ÿ
- âœ… ç°ä»£åŒ–çš„å‰ç«¯SPAåº”ç”¨ (16MBï¼Œå·²ä¼˜åŒ–)
- âœ… é«˜æ€§èƒ½çš„Flask APIåç«¯
- âœ… å®Œæ•´çš„ç”¨æˆ·è®¤è¯å’Œæƒé™ç®¡ç†
- âœ… äº§å“å’ŒæŠ¥ä»·ç®¡ç†åŠŸèƒ½
- âœ… AIæ™ºèƒ½åˆ†æåŠŸèƒ½ (éœ€é…ç½®APIå¯†é’¥)
- âœ… è‡ªåŠ¨åŒ–çš„æœåŠ¡ç®¡ç†è„šæœ¬
- âœ… å®Œå–„çš„æ—¥å¿—å’Œç›‘æ§ç³»ç»Ÿ

**è®¿é—®åœ°å€**: http://cpq.d1bk.com  
**ç®¡ç†å‘˜è´¦å·**: admin / admin123 (è¯·åŠæ—¶ä¿®æ”¹å¯†ç )

---

## ğŸ“ ç‰ˆæœ¬ä¿¡æ¯

- **ç‰ˆæœ¬**: 1.0.0
- **æ„å»ºæ—¶é—´**: 2025-01-25
- **å…¼å®¹æ€§**: å®å¡”é¢æ¿ 7.7.0+
- **æ”¯æŒç³»ç»Ÿ**: CentOS 7+, Ubuntu 18+, Debian 9+

---

**ğŸš€ ç¥æ‚¨éƒ¨ç½²é¡ºåˆ©ï¼**