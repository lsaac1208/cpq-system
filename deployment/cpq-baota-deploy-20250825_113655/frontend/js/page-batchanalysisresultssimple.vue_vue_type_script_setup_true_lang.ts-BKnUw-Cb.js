import{a as s,aj as l,c as n,E as e,h as i,g as a,f as t,o as r,d as u,I as o}from"./element-plus-DR0qywX_.js";import{z as c,r as _,b as d,aA as v,l as y,A as h,C as p,S as g,K as m,J as f,M as b,P as k,Q as w,R as j,a8 as q,u as x,az as S,B as A}from"./vue-BMWQU0Ry.js";import{s as C}from"./utils-BjNHK8wL.js";import{j as J,l as N}from"./api-BHu6TLr6.js";const z={class:"batch-analysis-results-page"},E={class:"page-header"},I={class:"header-content"},O={class:"header-right"},P={key:0,class:"loading-container"},R={key:1,class:"error-container"},B={key:2,class:"results-container"},D={class:"card-header"},L={class:"summary-item"},F={class:"summary-value"},K={class:"summary-item"},M={class:"summary-value"},Q={class:"summary-item"},G={class:"summary-value"},H={class:"card-header"},T={class:"results-list"},U={class:"file-info"},V={class:"file-name"},W={key:0,class:"analysis-content"},X={key:0,class:"insights-section"},Y={class:"insights-content"},Z={key:0},$={class:"business-analysis"},ss={key:1},ls={key:1,class:"insights-section"},ns={class:"insights-content"},es={key:0},is={class:"business-analysis"},as={key:1},ts={key:2,class:"insights-section"},rs={class:"insights-content"},us={key:0},os={class:"business-analysis"},cs={key:1},_s={key:3,class:"insights-section"},ds={class:"insights-content"},vs={key:0},ys={class:"business-analysis"},hs={key:4,class:"insights-section"},ps={class:"insights-content"},gs={key:0},ms={class:"business-analysis"},fs={key:5,class:"insights-section"},bs={class:"insights-content"},ks={key:0},ws={class:"business-analysis"},js={key:6,class:"insights-section"},qs={class:"insights-content"},xs={key:0},Ss={class:"business-analysis"},As={key:7,class:"insights-section"},Cs={class:"insights-content"},Js={key:8,class:"raw-data"},Ns=c({__name:"BatchAnalysisResultsSimple",setup(c){const Ns=v(),zs=S(),Es=_(!0),Is=_(""),Os=_(null),Ps=_([]),Rs=d(()=>Ns.params.jobId),Bs=()=>{return s=this,l=function*(){var s;if(!Rs.value)return Is.value="缺少任务ID参数",void(Es.value=!1);try{Es.value=!0,Is.value="";const l=yield J(Rs.value);if(!l||!l.success)throw new Error((null==l?void 0:l.error)||"加载任务信息失败");Os.value=l.status||l;const n=yield N(Rs.value);if(!n||!n.success)throw new Error((null==n?void 0:n.error)||"加载分析结果失败");Ps.value=(null==(s=n.results)?void 0:s.results)||n.results||[]}catch(l){Is.value=l.message||"加载失败",C.error(Is.value)}finally{Es.value=!1}},new Promise((n,e)=>{var i=s=>{try{t(l.next(s))}catch(n){e(n)}},a=s=>{try{t(l.throw(s))}catch(n){e(n)}},t=s=>s.done?n(s.value):Promise.resolve(s.value).then(i,a);t((l=l.apply(s,null)).next())});var s,l},Ds=()=>{Bs()},Ls=()=>{zs.go(-1)},Fs=s=>{switch(s){case"completed":return"success";case"failed":return"danger";case"processing":return"warning";default:return"info"}},Ks=s=>{switch(s){case"completed":return"已完成";case"failed":return"失败";case"processing":return"处理中";case"pending":return"等待中";case"cancelled":return"已取消";default:return s}},Ms=s=>{switch(s){case"customer_requirements":return"客户需求分析";case"competitor_analysis":return"竞品资料分析";case"project_mining":return"历史项目挖掘";case"product_extraction":return"产品信息提取";case"document_classification":return"文档分类";case"quality_assessment":return"质量评估";case"comprehensive":return"综合分析";default:return s}},Qs=s=>{if(!s)return"未知";try{return new Date(s).toLocaleString("zh-CN")}catch(l){return s}},Gs=s=>{try{const l=s.match(/```json\s*([\s\S]*?)\s*```/);return l?JSON.parse(l[1]):JSON.parse(s)}catch(l){return null}},Hs=s=>{var l;const n=Gs(s);return(null==(l=null==n?void 0:n.技术需求)?void 0:l.性能规格要求)?n.技术需求.性能规格要求.slice(0,3).join(", ")+(n.技术需求.性能规格要求.length>3?"...":""):"未提取到技术需求信息"},Ts=s=>{var l;const n=Gs(s);return(null==(l=null==n?void 0:n.商务需求)?void 0:l.预算范围)||(null==n?void 0:n.预算范围)||"未指定"},Us=s=>{var l;const n=Gs(s);return(null==(l=null==n?void 0:n.商务需求)?void 0:l.项目时间线)||(null==n?void 0:n.项目时间线)||(null==n?void 0:n.时间要求)||"未指定"},Vs=s=>{var l;const n=Gs(s);return(null==(l=null==n?void 0:n.产品信息)?void 0:l.产品名称)||(null==n?void 0:n.competitor_product)||"未识别产品"},Ws=s=>{var l;const n=Gs(s);return(null==(l=null==n?void 0:n.价格信息)?void 0:l.价格范围)||(null==n?void 0:n.price_info)||"未获取价格信息"},Xs=s=>{var l;const n=Gs(s);return(null==(l=null==n?void 0:n.项目信息)?void 0:l.项目类型)||(null==n?void 0:n.project_type)||"未分类项目"},Ys=s=>{const l=Gs(s);return(null==l?void 0:l.成功经验)&&Array.isArray(l.成功经验)?l.成功经验.slice(0,2).join("; "):(null==l?void 0:l.success_patterns)||"未发现明显成功模式"},Zs=s=>{var l;const n=Gs(s);return(null==(l=null==n?void 0:n.产品信息)?void 0:l.产品名称)?"".concat(n.产品信息.产品名称," - ").concat(n.产品信息.产品描述||"无描述"):(null==n?void 0:n.product_name)||"未提取到产品信息"},$s=s=>{const l=Gs(s);return(null==l?void 0:l.文档类型)||(null==l?void 0:l.document_category)||"未分类"},sl=s=>{const l=Gs(s),n=(null==l?void 0:l.质量评分)||(null==l?void 0:l.quality_score);return n?"".concat(n,"/100"):"未评分"},ll=s=>{var l;const n=Gs(s);return(null==(l=null==n?void 0:n.综合评估)?void 0:l.关键发现)?n.综合评估.关键发现.slice(0,2).join("; "):(null==n?void 0:n.key_insights)||"综合分析结果"};return y(()=>{Bs()}),(c,_)=>{const d=s,v=l,y=n,S=t,C=i,J=a,N=e,Ns=u,zs=o;return A(),h("div",z,[p("div",E,[p("div",I,[_[2]||(_[2]=p("div",{class:"header-left"},[p("h1",null,"分析结果查看"),p("p",{class:"page-description"},"查看和分析批量文档处理的详细结果")],-1)),p("div",O,[g(d,{onClick:Ls,icon:"ArrowLeft"},{default:m(()=>_[0]||(_[0]=[k("返回",-1)])),_:1,__:[0]}),g(d,{type:"primary",onClick:Ds,icon:"Refresh"},{default:m(()=>_[1]||(_[1]=[k("刷新",-1)])),_:1,__:[1]})])])]),Es.value?(A(),h("div",P,[g(v,{text:"正在加载分析结果..."})])):Is.value?(A(),h("div",R,[g(y,{title:"加载失败",description:Is.value,type:"error","show-icon":"",closable:!1},null,8,["description"]),g(d,{onClick:Ds,style:{"margin-top":"15px"}},{default:m(()=>_[3]||(_[3]=[k("重试",-1)])),_:1,__:[3]})])):(A(),h("div",B,[Os.value?(A(),f(N,{key:0,class:"job-summary-card"},{header:m(()=>[p("div",D,[_[4]||(_[4]=p("span",{class:"header-title"},"任务信息",-1)),g(S,{type:Fs(Os.value.status)},{default:m(()=>[k(w(Ks(Os.value.status)),1)]),_:1},8,["type"])])]),default:m(()=>[g(J,{gutter:20},{default:m(()=>[g(C,{span:8},{default:m(()=>[p("div",L,[_[5]||(_[5]=p("span",{class:"summary-label"},"任务名称:",-1)),p("span",F,w(Os.value.job_name||"批量分析任务 #".concat(Os.value.job_id)),1)])]),_:1}),g(C,{span:8},{default:m(()=>[p("div",K,[_[6]||(_[6]=p("span",{class:"summary-label"},"分析类型:",-1)),p("span",M,w(Ms(Os.value.analysis_type)),1)])]),_:1}),g(C,{span:8},{default:m(()=>[p("div",Q,[_[7]||(_[7]=p("span",{class:"summary-label"},"创建时间:",-1)),p("span",G,w(Qs(Os.value.created_at)),1)])]),_:1})]),_:1})]),_:1})):b("",!0),Ps.value&&Ps.value.length>0?(A(),f(N,{key:1,class:"business-results"},{header:m(()=>[p("div",H,[_[8]||(_[8]=p("span",{class:"header-title"},"业务分析结果",-1)),g(S,{type:"success"},{default:m(()=>[k(w(Ps.value.length)+" 个文档",1)]),_:1})])]),default:m(()=>[p("div",T,[(A(!0),h(j,null,q(Ps.value,(s,l)=>{var n,e,i,a,t,u,o,c,d,v,y,f,j,q;return A(),h("div",{key:l,class:"result-item"},[p("div",U,[g(Ns,null,{default:m(()=>[g(x(r))]),_:1}),p("span",V,w(s.filename||s.file_name||s.original_filename||"未知文件"),1)]),s.analysis_result?(A(),h("div",W,[(null==(n=s.analysis_result.business_insights)?void 0:n.customer_requirements)?(A(),h("div",X,[_[14]||(_[14]=p("h4",null,"客户需求分析",-1)),p("div",Y,[s.analysis_result.business_insights.customer_requirements.raw_analysis?(A(),h("div",Z,[p("div",$,[p("p",null,[_[9]||(_[9]=p("strong",null,"技术需求:",-1)),k(" "+w(Hs(s.analysis_result.business_insights.customer_requirements.raw_analysis)),1)]),p("p",null,[_[10]||(_[10]=p("strong",null,"预算范围:",-1)),k(" "+w(Ts(s.analysis_result.business_insights.customer_requirements.raw_analysis)),1)]),p("p",null,[_[11]||(_[11]=p("strong",null,"时间要求:",-1)),k(" "+w(Us(s.analysis_result.business_insights.customer_requirements.raw_analysis)),1)]),p("p",null,[_[12]||(_[12]=p("strong",null,"风险等级:",-1)),k(" "+w((null==(e=s.analysis_result.business_insights.customer_requirements.risk_assessment)?void 0:e.overall_risk_level)||"未评估"),1)])])])):(A(),h("div",ss,[p("p",null,[_[13]||(_[13]=p("strong",null,"风险等级:",-1)),k(" "+w((null==(i=s.analysis_result.business_insights.customer_requirements.risk_assessment)?void 0:i.overall_risk_level)||"未评估"),1)])]))])])):b("",!0),(null==(a=s.analysis_result.business_insights)?void 0:a.competitor_analysis)?(A(),h("div",ls,[_[19]||(_[19]=p("h4",null,"竞品分析",-1)),p("div",ns,[s.analysis_result.business_insights.competitor_analysis.raw_analysis?(A(),h("div",es,[p("div",is,[p("p",null,[_[15]||(_[15]=p("strong",null,"产品信息:",-1)),k(" "+w(Vs(s.analysis_result.business_insights.competitor_analysis.raw_analysis)),1)]),p("p",null,[_[16]||(_[16]=p("strong",null,"价格信息:",-1)),k(" "+w(Ws(s.analysis_result.business_insights.competitor_analysis.raw_analysis)),1)])])])):(A(),h("div",as,[p("p",null,[_[17]||(_[17]=p("strong",null,"产品名称:",-1)),k(" "+w((null==(t=s.analysis_result.business_insights.competitor_analysis.competitor_info)?void 0:t.product_name)||"未识别"),1)]),p("p",null,[_[18]||(_[18]=p("strong",null,"市场地位:",-1)),k(" "+w((null==(u=s.analysis_result.business_insights.competitor_analysis.competitor_info)?void 0:u.market_position)||"未知"),1)])]))])])):b("",!0),(null==(o=s.analysis_result.business_insights)?void 0:o.project_insights)?(A(),h("div",ts,[_[24]||(_[24]=p("h4",null,"历史项目洞察",-1)),p("div",rs,[s.analysis_result.business_insights.project_insights.raw_analysis?(A(),h("div",us,[p("div",os,[p("p",null,[_[20]||(_[20]=p("strong",null,"项目信息:",-1)),k(" "+w(Xs(s.analysis_result.business_insights.project_insights.raw_analysis)),1)]),p("p",null,[_[21]||(_[21]=p("strong",null,"成功经验:",-1)),k(" "+w(Ys(s.analysis_result.business_insights.project_insights.raw_analysis)),1)])])])):(A(),h("div",cs,[p("p",null,[_[22]||(_[22]=p("strong",null,"项目类型:",-1)),k(" "+w((null==(c=s.analysis_result.business_insights.project_insights.project_overview)?void 0:c.project_type)||"未分类"),1)]),p("p",null,[_[23]||(_[23]=p("strong",null,"成功状态:",-1)),k(" "+w((null==(d=s.analysis_result.business_insights.project_insights.project_overview)?void 0:d.success_status)||"未评估"),1)])]))])])):b("",!0),(null==(v=s.analysis_result.business_insights)?void 0:v.product_extraction)?(A(),h("div",_s,[_[26]||(_[26]=p("h4",null,"产品信息提取",-1)),p("div",ds,[s.analysis_result.business_insights.product_extraction.raw_analysis?(A(),h("div",vs,[p("div",ys,[p("p",null,[_[25]||(_[25]=p("strong",null,"产品详情:",-1)),k(" "+w(Zs(s.analysis_result.business_insights.product_extraction.raw_analysis)),1)])])])):b("",!0)])])):b("",!0),(null==(y=s.analysis_result.business_insights)?void 0:y.document_classification)?(A(),h("div",hs,[_[28]||(_[28]=p("h4",null,"文档分类",-1)),p("div",ps,[s.analysis_result.business_insights.document_classification.raw_analysis?(A(),h("div",gs,[p("div",ms,[p("p",null,[_[27]||(_[27]=p("strong",null,"分类结果:",-1)),k(" "+w($s(s.analysis_result.business_insights.document_classification.raw_analysis)),1)])])])):b("",!0)])])):b("",!0),(null==(f=s.analysis_result.business_insights)?void 0:f.quality_assessment)?(A(),h("div",fs,[_[30]||(_[30]=p("h4",null,"质量评估",-1)),p("div",bs,[s.analysis_result.business_insights.quality_assessment.raw_analysis?(A(),h("div",ks,[p("div",ws,[p("p",null,[_[29]||(_[29]=p("strong",null,"质量评分:",-1)),k(" "+w(sl(s.analysis_result.business_insights.quality_assessment.raw_analysis)),1)])])])):b("",!0)])])):b("",!0),(null==(j=s.analysis_result.business_insights)?void 0:j.comprehensive)?(A(),h("div",js,[_[32]||(_[32]=p("h4",null,"综合分析",-1)),p("div",qs,[s.analysis_result.business_insights.comprehensive.raw_analysis?(A(),h("div",xs,[p("div",Ss,[p("p",null,[_[31]||(_[31]=p("strong",null,"综合评估:",-1)),k(" "+w(ll(s.analysis_result.business_insights.comprehensive.raw_analysis)),1)])])])):b("",!0)])])):b("",!0),s.analysis_result.confidence_scores?(A(),h("div",As,[_[35]||(_[35]=p("h4",null,"分析置信度",-1)),p("div",Cs,[p("p",null,[_[33]||(_[33]=p("strong",null,"整体置信度:",-1)),k(" "+w((100*s.analysis_result.confidence_scores.overall).toFixed(1))+"%",1)]),p("p",null,[_[34]||(_[34]=p("strong",null,"质量评级:",-1)),k(" "+w((q=s.analysis_result.confidence_scores.level,{very_high:"非常高",high:"高",medium:"中等",low:"低",very_low:"很低"}[q]||q)),1)])])])):b("",!0),s.analysis_result.business_insights||s.analysis_result.confidence_scores?b("",!0):(A(),h("div",Js,[_[36]||(_[36]=p("h4",null,"分析结果",-1)),p("pre",null,w(JSON.stringify(s.analysis_result,null,2)),1)]))])):b("",!0)])}),128))])]),_:1})):(A(),f(N,{key:2,class:"no-results-card"},{default:m(()=>[g(zs,{description:"暂无分析结果"})]),_:1}))]))])}}});export{Ns as _};
