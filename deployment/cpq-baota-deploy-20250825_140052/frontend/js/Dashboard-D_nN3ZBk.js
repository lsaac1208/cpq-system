var H=Object.defineProperty;var k=(Q,p)=>H(Q,"name",{value:p,configurable:!0});var S=(Q,p,f)=>new Promise((g,_)=>{var A=c=>{try{y(f.next(c))}catch(d){_(d)}},C=c=>{try{y(f.throw(c))}catch(d){_(d)}},y=c=>c.done?g(c.value):Promise.resolve(c.value).then(A,C);y((f=f.apply(Q,p)).next())});import{_ as J}from"./index-CoBZUWE1.js";import"./el-tooltip-l0sNRNKZ.js";/* empty css                     *//* empty css                        *//* empty css                    *//* empty css               *//* empty css                */import{u as L}from"./quotes-BbFL_Tm9.js";import{p as O}from"./products-CqbSQiZB.js";import{getAnalysisHistory as $}from"./ai-analysis-DPd-iqke.js";import{M as F,N as U,O as G,b as K,z as N,B as V,P as W,Q as X,R as Y,S as Z,j as R,T as tt,d as et,U as at,V as st,J as lt}from"./vendor-ui-CE-ZhXxH.js";import{x as nt,r as T,j as ot,y as j,A as s,Q as t,I as e,al as dt,z as E,u as v,O as r,J as M,H as q,M as i}from"./vendor-vue-XfLkFKXI.js";import"./vendor-pdf-BeW0Xq92.js";import"./vendor-utils-B8vW8fJV.js";const ut={class:"dashboard"},it={class:"stat-content"},rt={class:"stat-icon products"},_t={class:"stat-info"},ct={class:"stat-content"},pt={class:"stat-icon quotes"},ft={class:"stat-info"},mt={class:"stat-content"},vt={class:"stat-icon pending"},gt={class:"stat-info"},yt={class:"stat-content"},bt={class:"stat-icon revenue"},ht={class:"stat-info"},wt={class:"card-header"},zt={class:"card-header"},kt={key:0},Et={class:"quick-actions"},Qt=nt({__name:"Dashboard",setup(Q){const p=T(!1),f=T([]),g=T([]),_=T({products:0,quotes:0,pendingQuotes:0,revenue:0}),A=k(d=>({draft:"info",pending:"warning",approved:"success",rejected:"danger",expired:"info"})[d]||"info","getStatusType"),C=k(d=>d>=.8?"success":d>=.6?"warning":"danger","getConfidenceType"),y=k((d,a)=>d?d.length>a?d.substring(0,a)+"...":d:"","truncateText"),c=k(()=>S(this,null,function*(){var d,a;p.value=!0;try{const l=yield L.getAllQuotes({page:1,per_page:5});f.value=(l==null?void 0:l.quotes)||[];const u=yield O.getProducts({page:1,per_page:1});try{const n=yield $({page:1,per_page:5});g.value=(n==null?void 0:n.records)||[]}catch(n){g.value=[]}_.value={products:((d=u==null?void 0:u.pagination)==null?void 0:d.total)||0,quotes:((a=l==null?void 0:l.pagination)==null?void 0:a.total)||0,pendingQuotes:((l==null?void 0:l.quotes)||[]).filter(n=>n.status==="pending").length,revenue:((l==null?void 0:l.quotes)||[]).filter(n=>n.status==="approved").reduce((n,w)=>n+(w.final_price||0),0)}}catch(l){_.value={products:0,quotes:0,pendingQuotes:0,revenue:0},f.value=[],g.value=[]}finally{p.value=!1}}),"loadDashboardData");return ot(()=>{c()}),(d,a)=>{const l=K,u=G,n=U,w=F,b=et,h=dt("router-link"),m=Z,x=R,B=Y,P=at,D=tt;return E(),j("div",ut,[a[14]||(a[14]=s("div",{class:"dashboard-header"},[s("h1",null,"仪表盘"),s("p",null,"欢迎使用CPQ系统")],-1)),t(w,{gutter:20,class:"stats-row"},{default:e(()=>[t(n,{span:6},{default:e(()=>[t(u,{class:"stat-card"},{default:e(()=>[s("div",it,[s("div",rt,[t(l,null,{default:e(()=>[t(v(N))]),_:1})]),s("div",_t,[s("h3",null,r(_.value.products),1),a[0]||(a[0]=s("p",null,"活跃产品",-1))])])]),_:1})]),_:1}),t(n,{span:6},{default:e(()=>[t(u,{class:"stat-card"},{default:e(()=>[s("div",ct,[s("div",pt,[t(l,null,{default:e(()=>[t(v(V))]),_:1})]),s("div",ft,[s("h3",null,r(_.value.quotes),1),a[1]||(a[1]=s("p",null,"总报价数",-1))])])]),_:1})]),_:1}),t(n,{span:6},{default:e(()=>[t(u,{class:"stat-card"},{default:e(()=>[s("div",mt,[s("div",vt,[t(l,null,{default:e(()=>[t(v(W))]),_:1})]),s("div",gt,[s("h3",null,r(_.value.pendingQuotes),1),a[2]||(a[2]=s("p",null,"待处理报价",-1))])])]),_:1})]),_:1}),t(n,{span:6},{default:e(()=>[t(u,{class:"stat-card"},{default:e(()=>[s("div",yt,[s("div",bt,[t(l,null,{default:e(()=>[t(v(X))]),_:1})]),s("div",ht,[s("h3",null,"$"+r(_.value.revenue.toLocaleString()),1),a[3]||(a[3]=s("p",null,"总收入",-1))])])]),_:1})]),_:1})]),_:1}),t(w,{gutter:20,class:"content-row"},{default:e(()=>[t(n,{span:12},{default:e(()=>[t(u,null,{header:e(()=>[s("div",wt,[a[5]||(a[5]=s("span",null,"最近报价",-1)),t(h,{to:"/quotes"},{default:e(()=>[t(b,{type:"primary",size:"small"},{default:e(()=>a[4]||(a[4]=[i("查看全部",-1)])),_:1,__:[4]})]),_:1})])]),default:e(()=>[M((E(),q(B,{data:f.value,style:{width:"100%"}},{default:e(()=>[t(m,{prop:"quote_number",label:"报价单号",width:"120"}),t(m,{prop:"customer_name",label:"客户"}),t(m,{prop:"status",label:"状态",width:"100"},{default:e(({row:o})=>[t(x,{type:A(o.status)},{default:e(()=>[i(r(o.status),1)]),_:2},1032,["type"])]),_:1}),t(m,{prop:"final_price",label:"金额",width:"100"},{default:e(({row:o})=>{var z;return[i(" $"+r((z=o.final_price)==null?void 0:z.toLocaleString()),1)]}),_:1})]),_:1},8,["data"])),[[D,p.value]])]),_:1})]),_:1}),t(n,{span:12},{default:e(()=>[t(u,null,{header:e(()=>[s("div",zt,[a[7]||(a[7]=s("span",null,"最近AI分析",-1)),t(h,{to:"/ai-analysis-enhanced"},{default:e(()=>[t(b,{type:"primary",size:"small"},{default:e(()=>a[6]||(a[6]=[i("查看全部",-1)])),_:1,__:[6]})]),_:1})])]),default:e(()=>[M((E(),q(B,{data:g.value,style:{width:"100%"}},{default:e(()=>[t(m,{prop:"document_name",label:"文档名称",width:"150"},{default:e(({row:o})=>[t(P,{content:o.document_name,placement:"top"},{default:e(()=>[s("span",null,r(y(o.document_name,20)),1)]),_:2},1032,["content"])]),_:1}),t(m,{label:"分析结果",width:"100"},{default:e(({row:o})=>{var z,I;return[o.success&&((I=(z=o.extracted_data)==null?void 0:z.basic_info)!=null&&I.name)&&!o.extracted_data.basic_info.name.includes("失败")?(E(),j("span",kt,r(y(o.extracted_data.basic_info.name,15)),1)):(E(),q(x,{key:1,type:"warning",size:"small"},{default:e(()=>a[8]||(a[8]=[i("解析异常",-1)])),_:1,__:[8]}))]}),_:1}),t(m,{label:"置信度",width:"80"},{default:e(({row:o})=>[t(x,{type:C(o.overall_confidence||0),size:"small"},{default:e(()=>[i(r(((o.overall_confidence||0)*100).toFixed(0))+"% ",1)]),_:2},1032,["type"])]),_:1}),t(m,{label:"状态",width:"80"},{default:e(({row:o})=>[t(x,{type:o.success?"success":"danger",size:"small"},{default:e(()=>[i(r(o.success?"成功":"失败"),1)]),_:2},1032,["type"])]),_:1})]),_:1},8,["data"])),[[D,p.value]])]),_:1})]),_:1})]),_:1}),t(w,{gutter:20,class:"content-row"},{default:e(()=>[t(n,{span:24},{default:e(()=>[t(u,null,{header:e(()=>a[9]||(a[9]=[s("div",{class:"card-header"},[s("span",null,"快捷操作")],-1)])),default:e(()=>[s("div",Et,[t(h,{to:"/quotes/create"},{default:e(()=>[t(b,{type:"primary",size:"large",class:"action-button"},{default:e(()=>[t(l,null,{default:e(()=>[t(v(st))]),_:1}),a[10]||(a[10]=i(" 创建新报价 ",-1))]),_:1,__:[10]})]),_:1}),t(h,{to:"/products"},{default:e(()=>[t(b,{type:"success",size:"large",class:"action-button"},{default:e(()=>[t(l,null,{default:e(()=>[t(v(N))]),_:1}),a[11]||(a[11]=i(" 管理产品 ",-1))]),_:1,__:[11]})]),_:1}),t(h,{to:"/ai-analysis-enhanced"},{default:e(()=>[t(b,{type:"info",size:"large",class:"action-button"},{default:e(()=>[t(l,null,{default:e(()=>[t(v(lt))]),_:1}),a[12]||(a[12]=i(" AI智能分析 ",-1))]),_:1,__:[12]})]),_:1}),t(h,{to:"/quotes"},{default:e(()=>[t(b,{type:"warning",size:"large",class:"action-button"},{default:e(()=>[t(l,null,{default:e(()=>[t(v(V))]),_:1}),a[13]||(a[13]=i(" 查看所有报价 ",-1))]),_:1,__:[13]})]),_:1})])]),_:1})]),_:1})]),_:1})])}}}),Jt=J(Qt,[["__scopeId","data-v-0c5f3432"]]);export{Jt as default};
