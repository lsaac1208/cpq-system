var G=Object.defineProperty;var J=Object.getOwnPropertySymbols;var ee=Object.prototype.hasOwnProperty,se=Object.prototype.propertyIsEnumerable;var Z=(g,u,n)=>u in g?G(g,u,{enumerable:!0,configurable:!0,writable:!0,value:n}):g[u]=n,I=(g,u)=>{for(var n in u||(u={}))ee.call(u,n)&&Z(g,n,u[n]);if(J)for(var n of J(u))se.call(u,n)&&Z(g,n,u[n]);return g};var p=(g,u)=>G(g,"name",{value:u,configurable:!0});var U=(g,u,n)=>new Promise((y,t)=>{var o=b=>{try{v(n.next(b))}catch(w){t(w)}},c=b=>{try{v(n.throw(b))}catch(w){t(w)}},v=b=>b.done?y(b.value):Promise.resolve(b.value).then(o,c);v((n=n.apply(g,u)).next())});import{c as A}from"./settings-Dj-ToOIB.js";import{x as D,X as V,c as B,w as $,y as i,A as e,V as T,J as h,K as _,aj as x,O as f,M,z as r,aH as te,P as Q,a6 as X,u as oe,ae as P,r as F,j as ae,Q as E,D as K,H as le,L as ne}from"./vendor-vue-XfLkFKXI.js";import{_ as R}from"./index-CoBZUWE1.js";import"./vendor-pdf-BeW0Xq92.js";import"./vendor-ui-CE-ZhXxH.js";import"./vendor-utils-B8vW8fJV.js";const re={class:"company-info-form"},ie={class:"form-grid"},de={class:"form-group"},ue={key:0,class:"form-error"},me={class:"form-group"},pe={key:0,class:"form-error"},ce={class:"form-group"},_e={key:0,class:"form-error"},fe={class:"form-group"},be={key:0,class:"form-error"},ge={class:"form-group"},ye={key:0,class:"form-error"},ve={class:"form-group"},he={key:0,class:"form-error"},ke={class:"form-group full-width"},we={key:0,class:"form-error"},$e={class:"form-actions"},xe=["disabled"],Se=["disabled"],qe={key:0,class:"loading-spinner"},Ce=D({__name:"CompanyInfoForm",props:{companyInfo:{},loading:{type:Boolean,default:!1}},emits:["update"],setup(g,{emit:u}){const n=g,y=u,t=V({name:"",address:"",phone:"",email:"",website:"",logo_url:"",tax_number:""}),o=V({}),c=B(()=>t.name.trim().length>0&&Object.keys(o).length===0),v=p(()=>{n.companyInfo&&Object.assign(t,{name:n.companyInfo.name||"",address:n.companyInfo.address||"",phone:n.companyInfo.phone||"",email:n.companyInfo.email||"",website:n.companyInfo.website||"",logo_url:n.companyInfo.logo_url||"",tax_number:n.companyInfo.tax_number||""})},"initializeForm"),b=p((a,s)=>{switch(a){case"name":s.trim()?s.length>200?o[a]="公司名称不能超过200个字符":delete o[a]:o[a]="公司名称不能为空";break;case"email":s&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s)?o[a]="请输入有效的邮箱地址":delete o[a];break;case"website":case"logo_url":s&&!/^https?:\/\/.+\..+/.test(s)?o[a]="请输入有效的URL地址":delete o[a];break;case"phone":s&&s.length>50?o[a]="电话号码不能超过50个字符":delete o[a];break;case"tax_number":s&&s.length>100?o[a]="税号不能超过100个字符":delete o[a];break;default:delete o[a]}},"validateField");$(()=>t.name,a=>b("name",a)),$(()=>t.email,a=>b("email",a)),$(()=>t.website,a=>b("website",a)),$(()=>t.logo_url,a=>b("logo_url",a)),$(()=>t.phone,a=>b("phone",a)),$(()=>t.tax_number,a=>b("tax_number",a)),$(()=>n.companyInfo,()=>{v()},{immediate:!0,deep:!0});const w=p(()=>{Object.keys(t).forEach(a=>{b(a,t[a])}),c.value&&y("update",I({},t))},"handleSubmit"),S=p(()=>{v(),Object.keys(o).forEach(a=>{delete o[a]})},"handleReset");return(a,s)=>(r(),i("div",re,[s[14]||(s[14]=e("h3",{class:"form-title"},"公司信息",-1)),s[15]||(s[15]=e("p",{class:"form-description"}," 配置公司基本信息，这些信息将显示在报价单和其他文档中。 ",-1)),e("form",{onSubmit:T(w,["prevent"]),class:"form"},[e("div",ie,[e("div",de,[s[7]||(s[7]=e("label",{for:"company-name",class:"form-label required"}," 公司名称 ",-1)),h(e("input",{id:"company-name","onUpdate:modelValue":s[0]||(s[0]=l=>t.name=l),type:"text",required:"",class:"form-input",placeholder:"请输入公司名称"},null,512),[[x,t.name]]),o.name?(r(),i("div",ue,f(o.name),1)):_("",!0)]),e("div",me,[s[8]||(s[8]=e("label",{for:"company-email",class:"form-label"}," 公司邮箱 ",-1)),h(e("input",{id:"company-email","onUpdate:modelValue":s[1]||(s[1]=l=>t.email=l),type:"email",class:"form-input",placeholder:"请输入公司邮箱"},null,512),[[x,t.email]]),o.email?(r(),i("div",pe,f(o.email),1)):_("",!0)]),e("div",ce,[s[9]||(s[9]=e("label",{for:"company-phone",class:"form-label"}," 联系电话 ",-1)),h(e("input",{id:"company-phone","onUpdate:modelValue":s[2]||(s[2]=l=>t.phone=l),type:"tel",class:"form-input",placeholder:"请输入联系电话"},null,512),[[x,t.phone]]),o.phone?(r(),i("div",_e,f(o.phone),1)):_("",!0)]),e("div",fe,[s[10]||(s[10]=e("label",{for:"company-website",class:"form-label"}," 公司网站 ",-1)),h(e("input",{id:"company-website","onUpdate:modelValue":s[3]||(s[3]=l=>t.website=l),type:"url",class:"form-input",placeholder:"https://www.example.com"},null,512),[[x,t.website]]),o.website?(r(),i("div",be,f(o.website),1)):_("",!0)]),e("div",ge,[s[11]||(s[11]=e("label",{for:"tax-number",class:"form-label"}," 税号 ",-1)),h(e("input",{id:"tax-number","onUpdate:modelValue":s[4]||(s[4]=l=>t.tax_number=l),type:"text",class:"form-input",placeholder:"请输入税号"},null,512),[[x,t.tax_number]]),o.tax_number?(r(),i("div",ye,f(o.tax_number),1)):_("",!0)]),e("div",ve,[s[12]||(s[12]=e("label",{for:"logo-url",class:"form-label"}," 公司Logo URL ",-1)),h(e("input",{id:"logo-url","onUpdate:modelValue":s[5]||(s[5]=l=>t.logo_url=l),type:"url",class:"form-input",placeholder:"https://www.example.com/logo.png"},null,512),[[x,t.logo_url]]),o.logo_url?(r(),i("div",he,f(o.logo_url),1)):_("",!0)])]),e("div",ke,[s[13]||(s[13]=e("label",{for:"company-address",class:"form-label"}," 公司地址 ",-1)),h(e("textarea",{id:"company-address","onUpdate:modelValue":s[6]||(s[6]=l=>t.address=l),rows:"3",class:"form-textarea",placeholder:"请输入完整的公司地址"},null,512),[[x,t.address]]),o.address?(r(),i("div",we,f(o.address),1)):_("",!0)]),e("div",$e,[e("button",{type:"button",onClick:S,disabled:a.loading,class:"reset-button"}," 重置 ",8,xe),e("button",{type:"submit",disabled:a.loading||!c.value,class:"submit-button"},[a.loading?(r(),i("span",qe)):_("",!0),M(" "+f(a.loading?"保存中...":"保存更改"),1)],8,Se)])],32)]))}}),Ue=R(Ce,[["__scopeId","data-v-6328706b"]]),Ve=[{code:"USD",name:"US Dollar",symbol:"$"},{code:"EUR",name:"Euro",symbol:"€"},{code:"GBP",name:"British Pound",symbol:"£"},{code:"JPY",name:"Japanese Yen",symbol:"¥"},{code:"CNY",name:"Chinese Yuan",symbol:"¥"},{code:"CAD",name:"Canadian Dollar",symbol:"C$"},{code:"AUD",name:"Australian Dollar",symbol:"A$"}],Fe={class:"system-config-form"},Me={class:"form-grid"},je={class:"form-group"},Oe=["value"],Ie={key:0,class:"form-error"},Be={class:"form-group"},De={key:0,class:"form-error"},Re={class:"form-group"},Ee={key:0,class:"form-error"},Pe={class:"form-actions"},Te=["disabled"],Ae=["disabled"],He={key:0,class:"loading-spinner"},Le=D({__name:"SystemConfigForm",props:{systemConfig:{},loading:{type:Boolean,default:!1}},emits:["update"],setup(g,{emit:u}){const n=g,y=u,t=Ve,o=V({default_currency:"USD",default_tax_rate:0,quote_validity_days:30}),c=V({}),v=B(()=>o.default_currency&&o.quote_validity_days>0&&Object.keys(c).length===0),b=p(()=>{n.systemConfig&&Object.assign(o,{default_currency:n.systemConfig.default_currency||"USD",default_tax_rate:n.systemConfig.default_tax_rate||0,quote_validity_days:n.systemConfig.quote_validity_days||30})},"initializeForm"),w=p((s,l)=>{switch(s){case"default_currency":l?delete c[s]:c[s]="请选择默认货币";break;case"default_tax_rate":l<0||l>100?c[s]="税率必须在0-100之间":delete c[s];break;case"quote_validity_days":!l||l<1||l>365?c[s]="有效期必须在1-365天之间":delete c[s];break;default:delete c[s]}},"validateField");$(()=>o.default_currency,s=>w("default_currency",s)),$(()=>o.default_tax_rate,s=>w("default_tax_rate",s)),$(()=>o.quote_validity_days,s=>w("quote_validity_days",s)),$(()=>n.systemConfig,()=>{b()},{immediate:!0,deep:!0});const S=p(()=>{Object.keys(o).forEach(s=>{w(s,o[s])}),v.value&&y("update",I({},o))},"handleSubmit"),a=p(()=>{b(),Object.keys(c).forEach(s=>{delete c[s]})},"handleReset");return(s,l)=>(r(),i("div",Fe,[l[6]||(l[6]=e("h3",{class:"form-title"},"系统配置",-1)),l[7]||(l[7]=e("p",{class:"form-description"}," 配置系统的基本参数，包括默认货币、税率等。 ",-1)),e("form",{onSubmit:T(S,["prevent"]),class:"form"},[e("div",Me,[e("div",je,[l[3]||(l[3]=e("label",{for:"default-currency",class:"form-label required"}," 默认货币 ",-1)),h(e("select",{id:"default-currency","onUpdate:modelValue":l[0]||(l[0]=m=>o.default_currency=m),required:"",class:"form-select"},[(r(!0),i(Q,null,X(oe(t),m=>(r(),i("option",{key:m.code,value:m.code},f(m.code)+" - "+f(m.name)+" ("+f(m.symbol)+") ",9,Oe))),128))],512),[[te,o.default_currency]]),c.default_currency?(r(),i("div",Ie,f(c.default_currency),1)):_("",!0)]),e("div",Be,[l[4]||(l[4]=e("label",{for:"default-tax-rate",class:"form-label"}," 默认税率 (%) ",-1)),h(e("input",{id:"default-tax-rate","onUpdate:modelValue":l[1]||(l[1]=m=>o.default_tax_rate=m),type:"number",min:"0",max:"100",step:"0.01",class:"form-input",placeholder:"0.00"},null,512),[[x,o.default_tax_rate,void 0,{number:!0}]]),c.default_tax_rate?(r(),i("div",De,f(c.default_tax_rate),1)):_("",!0)]),e("div",Re,[l[5]||(l[5]=e("label",{for:"quote-validity-days",class:"form-label required"}," 报价单有效期 (天) ",-1)),h(e("input",{id:"quote-validity-days","onUpdate:modelValue":l[2]||(l[2]=m=>o.quote_validity_days=m),type:"number",min:"1",max:"365",required:"",class:"form-input",placeholder:"30"},null,512),[[x,o.quote_validity_days,void 0,{number:!0}]]),c.quote_validity_days?(r(),i("div",Ee,f(c.quote_validity_days),1)):_("",!0)])]),e("div",Pe,[e("button",{type:"button",onClick:a,disabled:s.loading,class:"reset-button"}," 重置 ",8,Te),e("button",{type:"submit",disabled:s.loading||!v.value,class:"submit-button"},[s.loading?(r(),i("span",He)):_("",!0),M(" "+f(s.loading?"保存中...":"保存更改"),1)],8,Ae)])],32)]))}}),ze=R(Le,[["__scopeId","data-v-049249cb"]]),Ne={class:"pdf-settings-form"},Ye={class:"form-grid"},Je={class:"form-group"},Ze={class:"color-input-wrapper"},Ge={key:0,class:"form-error"},Ke={class:"form-group"},Qe={class:"checkbox-wrapper"},Xe={class:"form-group full-width"},We={key:0,class:"form-error"},es={class:"form-actions"},ss=["disabled"],ts=["disabled"],os={key:0,class:"loading-spinner"},as=D({__name:"PDFSettingsForm",props:{pdfSettings:{},loading:{type:Boolean,default:!1}},emits:["update"],setup(g,{emit:u}){const n=g,y=u,t=V({header_color:"#2563eb",footer_text:"",show_logo:!0}),o=V({}),c=B(()=>t.header_color&&Object.keys(o).length===0),v=p(()=>{var a;n.pdfSettings&&Object.assign(t,{header_color:n.pdfSettings.header_color||"#2563eb",footer_text:n.pdfSettings.footer_text||"",show_logo:(a=n.pdfSettings.show_logo)!=null?a:!0})},"initializeForm"),b=p((a,s)=>{switch(a){case"header_color":s?/^#[0-9A-Fa-f]{6}$/.test(s)?delete o[a]:o[a]="请输入有效的颜色代码":o[a]="请选择标题颜色";break;default:delete o[a]}},"validateField");$(()=>t.header_color,a=>b("header_color",a)),$(()=>n.pdfSettings,()=>{v()},{immediate:!0,deep:!0});const w=p(()=>{b("header_color",t.header_color),c.value&&y("update",I({},t))},"handleSubmit"),S=p(()=>{v(),Object.keys(o).forEach(a=>{delete o[a]})},"handleReset");return(a,s)=>(r(),i("div",Ne,[s[8]||(s[8]=e("h3",{class:"form-title"},"PDF设置",-1)),s[9]||(s[9]=e("p",{class:"form-description"}," 配置PDF文档的样式和显示选项。 ",-1)),e("form",{onSubmit:T(w,["prevent"]),class:"form"},[e("div",Ye,[e("div",Je,[s[4]||(s[4]=e("label",{for:"header-color",class:"form-label required"}," 标题颜色 ",-1)),e("div",Ze,[h(e("input",{id:"header-color","onUpdate:modelValue":s[0]||(s[0]=l=>t.header_color=l),type:"color",required:"",class:"form-color-input"},null,512),[[x,t.header_color]]),h(e("input",{"onUpdate:modelValue":s[1]||(s[1]=l=>t.header_color=l),type:"text",class:"form-input color-text-input",placeholder:"#2563eb"},null,512),[[x,t.header_color]])]),o.header_color?(r(),i("div",Ge,f(o.header_color),1)):_("",!0)]),e("div",Ke,[s[6]||(s[6]=e("label",{class:"form-label"}," 显示Logo ",-1)),e("div",Qe,[h(e("input",{id:"show-logo","onUpdate:modelValue":s[2]||(s[2]=l=>t.show_logo=l),type:"checkbox",class:"form-checkbox"},null,512),[[P,t.show_logo]]),s[5]||(s[5]=e("label",{for:"show-logo",class:"checkbox-label"}," 在PDF中显示公司Logo ",-1))])])]),e("div",Xe,[s[7]||(s[7]=e("label",{for:"footer-text",class:"form-label"}," 页脚文本 ",-1)),h(e("textarea",{id:"footer-text","onUpdate:modelValue":s[3]||(s[3]=l=>t.footer_text=l),rows:"3",class:"form-textarea",placeholder:"请输入页脚文本（可选）"},null,512),[[x,t.footer_text]]),o.footer_text?(r(),i("div",We,f(o.footer_text),1)):_("",!0)]),e("div",es,[e("button",{type:"button",onClick:S,disabled:a.loading,class:"reset-button"}," 重置 ",8,ss),e("button",{type:"submit",disabled:a.loading||!c.value,class:"submit-button"},[a.loading?(r(),i("span",os)):_("",!0),M(" "+f(a.loading?"保存中...":"保存更改"),1)],8,ts)])],32)]))}}),ls=R(as,[["__scopeId","data-v-a5c73096"]]),ns={class:"email-settings-form"},rs={class:"form-group full-width"},is={class:"checkbox-wrapper"},ds={key:0,class:"smtp-config"},us={class:"form-grid"},ms={class:"form-group"},ps={key:0,class:"form-error"},cs={class:"form-group"},_s={key:0,class:"form-error"},fs={class:"form-group"},bs={key:0,class:"form-error"},gs={class:"form-group"},ys={key:0,class:"form-error"},vs={class:"form-group"},hs={class:"checkbox-wrapper"},ks={class:"form-actions"},ws=["disabled"],$s={key:0,class:"loading-spinner"},xs={class:"action-group"},Ss=["disabled"],qs=["disabled"],Cs={key:0,class:"loading-spinner"},Us=D({__name:"EmailSettingsForm",props:{emailSettings:{},loading:{type:Boolean,default:!1}},emits:["update","test"],setup(g,{emit:u}){const n=g,y=u,t=V({smtp_enabled:!1,smtp_host:"",smtp_port:587,smtp_username:"",smtp_password:"",smtp_use_tls:!0}),o=V({}),c=F(!1),v=B(()=>t.smtp_enabled?t.smtp_host&&t.smtp_port&&Object.keys(o).length===0:!0),b=B(()=>t.smtp_enabled&&t.smtp_host&&t.smtp_port),w=p(()=>{var m,d;n.emailSettings&&Object.assign(t,{smtp_enabled:(m=n.emailSettings.smtp_enabled)!=null?m:!1,smtp_host:n.emailSettings.smtp_host||"",smtp_port:n.emailSettings.smtp_port||587,smtp_username:n.emailSettings.smtp_username||"",smtp_password:n.emailSettings.smtp_password||"",smtp_use_tls:(d=n.emailSettings.smtp_use_tls)!=null?d:!0})},"initializeForm"),S=p((m,d)=>{if(!t.smtp_enabled){delete o[m];return}switch(m){case"smtp_host":d?delete o[m]:o[m]="请输入SMTP服务器地址";break;case"smtp_port":!d||d<1||d>65535?o[m]="端口必须在1-65535之间":delete o[m];break;default:delete o[m]}},"validateField");$(()=>t.smtp_enabled,()=>{t.smtp_enabled||Object.keys(o).forEach(m=>{delete o[m]})}),$(()=>t.smtp_host,m=>S("smtp_host",m)),$(()=>t.smtp_port,m=>S("smtp_port",m)),$(()=>n.emailSettings,()=>{w()},{immediate:!0,deep:!0});const a=p(()=>{t.smtp_enabled&&(S("smtp_host",t.smtp_host),S("smtp_port",t.smtp_port)),v.value&&y("update",I({},t))},"handleSubmit"),s=p(()=>U(this,null,function*(){c.value=!0;try{y("test")}finally{setTimeout(()=>{c.value=!1},1e3)}}),"handleTest"),l=p(()=>{w(),Object.keys(o).forEach(m=>{delete o[m]})},"handleReset");return(m,d)=>(r(),i("div",ns,[d[12]||(d[12]=e("h3",{class:"form-title"},"邮件设置",-1)),d[13]||(d[13]=e("p",{class:"form-description"}," 配置SMTP邮件服务器，用于发送报价单和系统通知。 ",-1)),e("form",{onSubmit:T(a,["prevent"]),class:"form"},[e("div",rs,[e("div",is,[h(e("input",{id:"smtp-enabled","onUpdate:modelValue":d[0]||(d[0]=C=>t.smtp_enabled=C),type:"checkbox",class:"form-checkbox"},null,512),[[P,t.smtp_enabled]]),d[6]||(d[6]=e("label",{for:"smtp-enabled",class:"checkbox-label"}," 启用邮件功能 ",-1))])]),t.smtp_enabled?(r(),i("div",ds,[e("div",us,[e("div",ms,[d[7]||(d[7]=e("label",{for:"smtp-host",class:"form-label required"}," SMTP服务器 ",-1)),h(e("input",{id:"smtp-host","onUpdate:modelValue":d[1]||(d[1]=C=>t.smtp_host=C),type:"text",required:"",class:"form-input",placeholder:"smtp.gmail.com"},null,512),[[x,t.smtp_host]]),o.smtp_host?(r(),i("div",ps,f(o.smtp_host),1)):_("",!0)]),e("div",cs,[d[8]||(d[8]=e("label",{for:"smtp-port",class:"form-label required"}," 端口 ",-1)),h(e("input",{id:"smtp-port","onUpdate:modelValue":d[2]||(d[2]=C=>t.smtp_port=C),type:"number",min:"1",max:"65535",required:"",class:"form-input",placeholder:"587"},null,512),[[x,t.smtp_port,void 0,{number:!0}]]),o.smtp_port?(r(),i("div",_s,f(o.smtp_port),1)):_("",!0)]),e("div",fs,[d[9]||(d[9]=e("label",{for:"smtp-username",class:"form-label"}," 用户名 ",-1)),h(e("input",{id:"smtp-username","onUpdate:modelValue":d[3]||(d[3]=C=>t.smtp_username=C),type:"text",class:"form-input",placeholder:"your-email@gmail.com"},null,512),[[x,t.smtp_username]]),o.smtp_username?(r(),i("div",bs,f(o.smtp_username),1)):_("",!0)]),e("div",gs,[d[10]||(d[10]=e("label",{for:"smtp-password",class:"form-label"}," 密码 ",-1)),h(e("input",{id:"smtp-password","onUpdate:modelValue":d[4]||(d[4]=C=>t.smtp_password=C),type:"password",class:"form-input",placeholder:"应用专用密码"},null,512),[[x,t.smtp_password]]),o.smtp_password?(r(),i("div",ys,f(o.smtp_password),1)):_("",!0)])]),e("div",vs,[e("div",hs,[h(e("input",{id:"smtp-use-tls","onUpdate:modelValue":d[5]||(d[5]=C=>t.smtp_use_tls=C),type:"checkbox",class:"form-checkbox"},null,512),[[P,t.smtp_use_tls]]),d[11]||(d[11]=e("label",{for:"smtp-use-tls",class:"checkbox-label"}," 使用TLS加密连接 ",-1))])])])):_("",!0),e("div",ks,[t.smtp_enabled?(r(),i("button",{key:0,type:"button",onClick:s,disabled:m.loading||!b.value,class:"test-button"},[c.value?(r(),i("span",$s)):_("",!0),M(" "+f(c.value?"测试中...":"测试连接"),1)],8,ws)):_("",!0),e("div",xs,[e("button",{type:"button",onClick:l,disabled:m.loading,class:"reset-button"}," 重置 ",8,Ss),e("button",{type:"submit",disabled:m.loading||!v.value,class:"submit-button"},[m.loading?(r(),i("span",Cs)):_("",!0),M(" "+f(m.loading?"保存中...":"保存更改"),1)],8,qs)])])],32)]))}}),Vs=R(Us,[["__scopeId","data-v-77f20d5b"]]),Fs={class:"business-rules-form"},Ms={class:"rules-grid"},js={class:"rule-group"},Os={class:"rule-header"},Is={class:"checkbox-wrapper"},Bs={class:"rule-group"},Ds={class:"rule-header"},Rs={class:"checkbox-wrapper"},Es={class:"rule-group"},Ps={class:"discount-input-wrapper"},Ts={key:0,class:"form-error"},As={class:"form-actions"},Hs=["disabled"],Ls=["disabled"],zs={key:0,class:"loading-spinner"},Ns=D({__name:"BusinessRulesForm",props:{businessRules:{},loading:{type:Boolean,default:!1}},emits:["update"],setup(g,{emit:u}){const n=g,y=u,t=V({auto_quote_numbering:!0,require_customer_approval:!1,max_discount_percentage:20}),o=V({}),c=B(()=>t.max_discount_percentage>=0&&t.max_discount_percentage<=100&&Object.keys(o).length===0),v=p(()=>{var a,s,l;n.businessRules&&Object.assign(t,{auto_quote_numbering:(a=n.businessRules.auto_quote_numbering)!=null?a:!0,require_customer_approval:(s=n.businessRules.require_customer_approval)!=null?s:!1,max_discount_percentage:(l=n.businessRules.max_discount_percentage)!=null?l:20})},"initializeForm"),b=p((a,s)=>{switch(a){case"max_discount_percentage":s<0||s>100?o[a]="折扣百分比必须在0-100之间":delete o[a];break;default:delete o[a]}},"validateField");$(()=>t.max_discount_percentage,a=>b("max_discount_percentage",a)),$(()=>n.businessRules,()=>{v()},{immediate:!0,deep:!0});const w=p(()=>{b("max_discount_percentage",t.max_discount_percentage),c.value&&y("update",I({},t))},"handleSubmit"),S=p(()=>{v(),Object.keys(o).forEach(a=>{delete o[a]})},"handleReset");return(a,s)=>(r(),i("div",Fs,[s[11]||(s[11]=e("h3",{class:"form-title"},"业务规则",-1)),s[12]||(s[12]=e("p",{class:"form-description"}," 配置系统的业务逻辑和规则，影响报价流程和用户权限。 ",-1)),e("form",{onSubmit:T(w,["prevent"]),class:"form"},[e("div",Ms,[e("div",js,[e("div",Os,[e("div",Is,[h(e("input",{id:"auto-quote-numbering","onUpdate:modelValue":s[0]||(s[0]=l=>t.auto_quote_numbering=l),type:"checkbox",class:"form-checkbox"},null,512),[[P,t.auto_quote_numbering]]),s[3]||(s[3]=e("label",{for:"auto-quote-numbering",class:"rule-title"}," 自动生成报价单号 ",-1))])]),s[4]||(s[4]=e("p",{class:"rule-description"}," 启用后，系统将自动为新的报价单分配唯一编号。 ",-1))]),e("div",Bs,[e("div",Ds,[e("div",Rs,[h(e("input",{id:"require-customer-approval","onUpdate:modelValue":s[1]||(s[1]=l=>t.require_customer_approval=l),type:"checkbox",class:"form-checkbox"},null,512),[[P,t.require_customer_approval]]),s[5]||(s[5]=e("label",{for:"require-customer-approval",class:"rule-title"}," 需要客户确认 ",-1))])]),s[6]||(s[6]=e("p",{class:"rule-description"}," 启用后，报价单需要客户确认后才能生效。 ",-1))]),e("div",Es,[s[8]||(s[8]=e("div",{class:"rule-header"},[e("label",{for:"max-discount",class:"rule-title"}," 最大折扣百分比 ")],-1)),e("div",Ps,[h(e("input",{id:"max-discount","onUpdate:modelValue":s[2]||(s[2]=l=>t.max_discount_percentage=l),type:"number",min:"0",max:"100",step:"0.01",required:"",class:"form-input discount-input",placeholder:"20.00"},null,512),[[x,t.max_discount_percentage,void 0,{number:!0}]]),s[7]||(s[7]=e("span",{class:"discount-unit"},"%",-1))]),s[9]||(s[9]=e("p",{class:"rule-description"}," 设置用户可以应用的最大折扣百分比。 ",-1)),o.max_discount_percentage?(r(),i("div",Ts,f(o.max_discount_percentage),1)):_("",!0)])]),s[10]||(s[10]=e("div",{class:"additional-rules"},[e("h4",{class:"section-title"},"高级设置"),e("div",{class:"info-box"},[e("p",null,"更多业务规则和权限控制功能正在开发中...")])],-1)),e("div",As,[e("button",{type:"button",onClick:S,disabled:a.loading,class:"reset-button"}," 重置 ",8,Hs),e("button",{type:"submit",disabled:a.loading||!c.value,class:"submit-button"},[a.loading?(r(),i("span",zs)):_("",!0),M(" "+f(a.loading?"保存中...":"保存更改"),1)],8,Ls)])],32)]))}}),Ys=R(Ns,[["__scopeId","data-v-c5b81320"]]);function Js(g,u){return r(),i("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.75 21h16.5M4.5 3h15M5.25 3v18m13.5-18v18M9 6.75h1.5m-1.5 3h1.5m-1.5 3h1.5m3-6H15m-1.5 3H15m-1.5 3H15M9 21v-3.375c0-.621.504-1.125 1.125-1.125h3.75c.621 0 1.125.504 1.125 1.125V21"})])}p(Js,"render$4");function Zs(g,u){return r(),i("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4.5 12a7.5 7.5 0 0 0 15 0m-15 0a7.5 7.5 0 1 1 15 0m-15 0H3m16.5 0H21m-1.5 0H12m-8.457 3.077 1.41-.513m14.095-5.13 1.41-.513M5.106 17.785l1.15-.964m11.49-9.642 1.149-.964M7.501 19.795l.75-1.3m7.5-12.99.75-1.3m-6.063 16.658.26-1.477m2.605-14.772.26-1.477m0 17.726-.26-1.477M10.698 4.614l-.26-1.477M16.5 19.794l-.75-1.299M7.5 4.205 12 12m6.894 5.785-1.149-.964M6.256 7.178l-1.15-.964m15.352 8.864-1.41-.513M4.954 9.435l-1.41-.514M12.002 12l-3.75 6.495"})])}p(Zs,"render$3");function Gs(g,u){return r(),i("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"})])}p(Gs,"render$2");function Ks(g,u){return r(),i("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75"})])}p(Ks,"render$1");function Qs(g,u){return r(),i("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12.75 11.25 15 15 9.75m-3-7.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285Z"})])}p(Qs,"render");const Xs={class:"settings-page"},Ws={key:0,class:"loading-container"},et={key:1,class:"error-container"},st={class:"error-message"},tt={key:2,class:"settings-content"},ot={class:"settings-tabs"},at=["onClick"],lt={class:"tab-content"},nt={key:0,class:"tab-panel"},rt={key:1,class:"tab-panel"},it={key:2,class:"tab-panel"},dt={key:3,class:"tab-panel"},ut={key:4,class:"tab-panel"},mt={class:"settings-actions"},pt=["disabled"],ct={class:"action-buttons"},_t=["disabled"],ft=D({__name:"Settings",setup(g){const u=F(null),n=F(!1),y=F(!1),t=F(null),o=F(""),c=F("success"),v=F("company"),b=[{key:"company",label:"公司信息",icon:Js},{key:"system",label:"系统配置",icon:Zs},{key:"pdf",label:"PDF设置",icon:Gs},{key:"email",label:"邮件设置",icon:Ks},{key:"business",label:"业务规则",icon:Qs}],w=p((k=!1)=>U(this,null,function*(){n.value=!0,t.value=null;try{u.value=yield A.getSettings(k)}catch(q){t.value=q.message||"加载设置失败"}finally{n.value=!1}}),"loadSettings"),S=p(k=>U(this,null,function*(){yield d({company_info:k})}),"updateCompanyInfo"),a=p(k=>U(this,null,function*(){yield d({system_config:k})}),"updateSystemConfig"),s=p(k=>U(this,null,function*(){yield d({pdf_settings:k})}),"updatePDFSettings"),l=p(k=>U(this,null,function*(){yield d({email_settings:k})}),"updateEmailSettings"),m=p(k=>U(this,null,function*(){yield d({business_rules:k})}),"updateBusinessRules"),d=p(k=>U(this,null,function*(){y.value=!0;try{u.value=yield A.updateSettings(k),j("设置更新成功","success")}catch(q){j(q.message||"更新设置失败","error")}finally{y.value=!1}}),"updateSettings"),C=p(()=>U(this,null,function*(){y.value=!0;try{const k=yield A.testEmailSettings();j(k.message||"邮件测试成功","success")}catch(k){j(k.message||"邮件测试失败","error")}finally{y.value=!1}}),"testEmailSettings"),W=p(()=>U(this,null,function*(){if(confirm("确定要重置为默认设置吗？此操作不可恢复。")){y.value=!0;try{u.value=yield A.resetSettings(),j("设置已重置为默认值","success")}catch(k){j(k.message||"重置设置失败","error")}finally{y.value=!1}}}),"resetSettings"),j=p((k,q)=>{o.value=k,c.value=q,setTimeout(()=>{o.value=""},5e3)},"showMessage");return ae(()=>{w()}),(k,q)=>{var H,L,z,N,Y;return r(),i("div",Xs,[q[3]||(q[3]=e("div",{class:"settings-header"},[e("h1",{class:"settings-title"},"系统设置"),e("p",{class:"settings-subtitle"},"管理系统配置和公司信息")],-1)),n.value?(r(),i("div",Ws,q[1]||(q[1]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"加载设置中...",-1)]))):t.value?(r(),i("div",et,[e("div",st,[q[2]||(q[2]=e("h3",null,"加载失败",-1)),e("p",null,f(t.value),1),e("button",{onClick:w,class:"retry-button"},"重试")])])):(r(),i("div",tt,[e("div",ot,[(r(),i(Q,null,X(b,O=>e("button",{key:O.key,onClick:p(bt=>v.value=O.key,"onClick"),class:K(["tab-button",{active:v.value===O.key}])},[(r(),le(ne(O.icon),{class:"tab-icon"})),M(" "+f(O.label),1)],10,at)),64))]),e("div",lt,[v.value==="company"?(r(),i("div",nt,[E(Ue,{"company-info":(H=u.value)==null?void 0:H.company_info,loading:y.value,onUpdate:S},null,8,["company-info","loading"])])):_("",!0),v.value==="system"?(r(),i("div",rt,[E(ze,{"system-config":(L=u.value)==null?void 0:L.system_config,loading:y.value,onUpdate:a},null,8,["system-config","loading"])])):_("",!0),v.value==="pdf"?(r(),i("div",it,[E(ls,{"pdf-settings":(z=u.value)==null?void 0:z.pdf_settings,loading:y.value,onUpdate:s},null,8,["pdf-settings","loading"])])):_("",!0),v.value==="email"?(r(),i("div",dt,[E(Vs,{"email-settings":(N=u.value)==null?void 0:N.email_settings,loading:y.value,onUpdate:l,onTest:C},null,8,["email-settings","loading"])])):_("",!0),v.value==="business"?(r(),i("div",ut,[E(Ys,{"business-rules":(Y=u.value)==null?void 0:Y.business_rules,loading:y.value,onUpdate:m},null,8,["business-rules","loading"])])):_("",!0)]),e("div",mt,[e("button",{onClick:W,disabled:y.value,class:"reset-button"}," 重置为默认值 ",8,pt),e("div",ct,[e("button",{onClick:q[0]||(q[0]=O=>w(!0)),disabled:y.value,class:"refresh-button"}," 刷新 ",8,_t)])])])),o.value?(r(),i("div",{key:3,class:K(["message",c.value])},f(o.value),3)):_("",!0)])}}}),xt=R(ft,[["__scopeId","data-v-ab63fd68"]]);export{xt as default};
