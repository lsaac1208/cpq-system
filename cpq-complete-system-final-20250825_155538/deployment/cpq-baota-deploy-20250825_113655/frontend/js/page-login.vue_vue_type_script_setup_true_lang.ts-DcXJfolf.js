import{y as e,z as s,i as a,aT as l,b0 as r,a as o}from"./element-plus-DR0qywX_.js";import{z as n,r as i,Z as u,A as t,C as d,S as p,K as m,X as c,u as g,P as f,an as v,a6 as h,az as w,B as _}from"./vue-BMWQU0Ry.js";import{u as y}from"./api-BHu6TLr6.js";import{s as x}from"./utils-BjNHK8wL.js";const z={class:"login-container"},V={class:"login-card"},b={class:"login-footer"},j=n({__name:"Login",setup(n){const j=w(),k=y(),P=i(),q=u({username:"",password:""}),C={username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码至少需要6个字符",trigger:"blur"}]},K=()=>{return e=this,s=function*(){var e,s;if(P.value)try{yield P.value.validate();const e=yield k.login(q);x.success(e.data.message||"登录成功"),j.push("/")}catch(a){x.error((null==(s=null==(e=a.response)?void 0:e.data)?void 0:s.error)||"登录失败")}},new Promise((a,l)=>{var r=e=>{try{n(s.next(e))}catch(a){l(a)}},o=e=>{try{n(s.throw(e))}catch(a){l(a)}},n=e=>e.done?a(e.value):Promise.resolve(e.value).then(r,o);n((s=s.apply(e,null)).next())});var e,s};return(n,i)=>{const u=a,w=s,y=o,x=v("router-link");return _(),t("div",z,[d("div",V,[i[5]||(i[5]=d("div",{class:"login-header"},[d("h2",null,"CPQ系统"),d("p",null,"电力设备制造商配置定价报价系统")],-1)),p(g(e),{ref_key:"loginFormRef",ref:P,model:q,rules:C,onSubmit:c(K,["prevent"])},{default:m(()=>[p(w,{prop:"username"},{default:m(()=>[p(u,{modelValue:q.username,"onUpdate:modelValue":i[0]||(i[0]=e=>q.username=e),placeholder:"用户名",size:"large","prefix-icon":g(l)},null,8,["modelValue","prefix-icon"])]),_:1}),p(w,{prop:"password"},{default:m(()=>[p(u,{modelValue:q.password,"onUpdate:modelValue":i[1]||(i[1]=e=>q.password=e),type:"password",placeholder:"密码",size:"large","prefix-icon":g(r),"show-password":"",onKeyup:h(K,["enter"])},null,8,["modelValue","prefix-icon"])]),_:1}),p(w,null,{default:m(()=>[p(y,{type:"primary",size:"large",style:{width:"100%"},loading:g(k).loading,onClick:K},{default:m(()=>i[2]||(i[2]=[f(" 登录 ",-1)])),_:1,__:[2]},8,["loading"])]),_:1})]),_:1},8,["model"]),d("div",b,[d("p",null,[i[4]||(i[4]=f(" 还没有账户？ ",-1)),p(x,{to:"/register",class:"link"},{default:m(()=>i[3]||(i[3]=[f("立即注册",-1)])),_:1,__:[3]})])]),i[6]||(i[6]=d("div",{class:"demo-info"},[d("h4",null,"演示账户"),d("p",null,[d("strong",null,"管理员:"),f(" admin / password123")]),d("p",null,[d("strong",null,"销售员:"),f(" sales / password123")]),d("p",null,[d("strong",null,"工程师:"),f(" engineer / password123")])],-1))])])}}});export{j as _};
